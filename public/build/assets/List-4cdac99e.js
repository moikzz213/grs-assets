import{r as i,a as se,u as oe,G as ne,H as ie,I as ue,c as m,w as l,m as de,n as z,o as r,d as t,v as w,b as a,j as g,ad as Y,e as f,k as q,f as Q,s as y,J as L,x as ce,y as c,a5 as re,z as x,p as W,q as pe,t as E,K as ve,L as me,as as fe,at as ge,F as _e,M as he,N as ye,i as xe,E as be,C as ke,au as Ve,A as Ce,B as we}from"./app-108afeff.js";import{_ as Ae}from"./AppPageHeader-34f681b8.js";import{_ as Se}from"./AppSnackBar-7892a438.js";import{_ as Ne}from"./_plugin-vue_export-helper-c27b6911.js";const p=A=>(Ce("data-v-12c5db8c"),A=A(),we(),A),$e={class:"mb-3"},Te=p(()=>a("div",{class:"mt-2 mr-2"},"Show",-1)),Be={class:"v-col-12"},Pe=p(()=>a("br",null,null,-1)),ze=p(()=>a("small",null,"(enabled)",-1)),Ee={class:"text-right text-capitalize"},Re={class:"d-flex align-center justify-end"},De=p(()=>a("br",null,null,-1)),Ie=p(()=>a("small",null,"Applies both Request and Transfer Assets",-1)),qe=p(()=>a("br",null,null,-1)),Le=p(()=>a("small",null,"Previous approved request will not change.",-1)),Oe={class:"v-col-12 v-col-md-12 mx-auto pt-0 my-0"},Ue={class:"v-col-12 v-col-md-3 mx-auto"},Fe=p(()=>a("small",{class:"text-center"},"Add SN. No for specific transfer approval (SN-300005)",-1)),je={class:"v-col-12 v-col-md-6 mx-auto"},Me={class:"v-col-12 v-col-md-6 mx-auto d-flex"},Ge=p(()=>a("br",null,null,-1)),Je=p(()=>a("small",null,"Do not forget to remove the old approver and add the new approver from the Setup.",-1)),Ke={__name:"List",setup(A){const S=i([]),b=i({}),u=se(),R=i(0),X=i(0),Z=i([10,20,50,100]),D=i(10),N=oe(),$=ne(),ee=()=>{h()},v=i($.params&&$.params.page?$.params.page:1),T=i([]),O=i(""),U=i(0),d=i({loading:!1,data:[]}),k=i([]),V=i([]),B=i(""),_=i($.params.type),P=s=>{d.value.loading=!0,T.value[0]=s,U.value%2?T.value[1]="DESC":T.value[1]="ASC",U.value++,O.value=JSON.stringify(T.value),h()},I=s=>{d.value.loading=!0,d.value.data=[],_.value=s,N.push({path:"/approval-setup/"+s}),s!="change-approval"?h():F.value||j()},F=i(!1),j=async()=>{await z(u.token).get("/api/user/fetch/signatories").then(s=>{S.value=s.data,console.log("signatoryItems.value",S.value),F.value=!0}).catch(s=>{d.value.loading=!1,console.log(s)})},h=async()=>{d.value.loading=!0;let s="";_.value=="transfer-asset"?s="transfer":s="request",await z(u.token).get("/api/approval-setups/all/"+s+"?page="+v.value+"&show="+D.value+"&sort="+O.value).then(e=>{R.value=e.data.last_page?e.data.last_page:e.data.length,v.value=e.data.current_page?e.data.current_page:v.value,X.value=e.data.total?e.data.total:e.data.length,d.value.data=e.data.data?e.data.data:e.data,d.value.loading=!1}).catch(e=>{d.value.loading=!1,console.log(e)})};ie(v,(s,e)=>{v.value&&s!=e&&(N.push({name:"PaginatedApprovals",params:{page:v.value}}).catch(o=>{}),h(v.value))});const ae=()=>{N.push({name:"NewApproval"}).catch(s=>{console.log(s)})},te=s=>{N.push({name:"EditApproval",params:{id:s}}).catch(e=>{console.log(e)})},C=i(!1),M=async(s,e)=>{b.value={status:!0,type:"info",text:"Please wait..."},C.value=!0;let o={id:s,status:e,profile_id:u.user.profile.id};await z(u.token).post("/api/approval-setups/status-change/data",o).then(n=>{setTimeout(()=>{b.value={status:!0,type:"success",text:n.data.message},h(),C.value=!1},600)}).catch(n=>{d.value.loading=!1,console.log(n)})},le=()=>{b.value={status:!0,type:"info",text:"Please wait..."};let s={old:V.value,new:k.value,serial:B.value};z(u.token).post("/api/approval-setups/change-signatory",s).then(e=>{V.value=[],k.value=[],B.value="",setTimeout(()=>{b.value={status:!0,type:"success",text:e.data.message}},600)}).catch(e=>{console.log(e)})};return ue(()=>{h(),_.value=="change-approval"&&j()}),(s,e)=>(r(),m(de,null,{default:l(()=>[t(Ae,{title:"Global Approval Setup"}),t(y,{class:"mb-3"},{default:l(()=>[t(w,{class:"v-col-12 mt-1 col-sm-12 py-0"},{default:l(()=>[a("div",$e,[t(g,{class:Y(`${_.value=="request-asset"?"tab-active":""}  v-col-12 v-col-md-3 mx-2`),onClick:e[0]||(e[0]=o=>I("request-asset"))},{default:l(()=>[f("Request Asset Approvals")]),_:1},8,["class"]),t(g,{class:Y(`${_.value=="transfer-asset"?"tab-active":""}   v-col-12 v-col-md-3 mx-2`),onClick:e[1]||(e[1]=o=>I("transfer-asset"))},{default:l(()=>[f("Transfer Asset Approvals")]),_:1},8,["class"]),t(g,{class:"v-col-12 v-col-md-3 mx-2",color:"primary",onClick:e[2]||(e[2]=o=>I("change-approval"))},{default:l(()=>[f("Change / Assign Approvals")]),_:1})]),_.value!=="change-approval"?(r(),m(q,{key:0},{default:l(()=>[t(Q,null,{default:l(()=>[t(y,{class:"mb-3"},{default:l(()=>[t(w,{class:"v-col-6 v-col-md-2 v-col-sm-12 d-flex mt-2 mb-0 pb-0"},{default:l(()=>[Te,t(L,{items:Z.value,modelValue:D.value,"onUpdate:modelValue":[e[3]||(e[3]=o=>D.value=o),ee],variant:"outlined",density:"compact","hide-details":"",label:"Entry"},null,8,["items","modelValue"])]),_:1}),a("div",Be,[t(q,{loading:d.value.loading},{default:l(()=>[t(ce,null,{default:l(()=>{var o;return[a("thead",null,[a("tr",null,[a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[4]||(e[4]=n=>P("title"))}," Title "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[5]||(e[5]=n=>P("title"))},[f(" Attachment "),Pe,ze]),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[6]||(e[6]=n=>P("profile_id"))}," Updated By "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[7]||(e[7]=n=>P("status"))}," Status "),a("th",Ee,[c(u).user.role=="superadmin"||(o=c(u).capabilities)!=null&&o.includes("add")?(r(),m(g,{key:0,size:"small",color:"primary","prepend-icon":c(re),onClick:ae},{default:l(()=>[f("Add New Matrix")]),_:1},8,["prepend-icon"])):x("",!0)])])]),a("tbody",null,[(r(!0),W(_e,null,pe(d.value.data,n=>{var G,J,K,H;return r(),W("tr",{key:n.id},[a("td",null,E(n.title),1),a("td",null,E(n.enable_attachment?"Yes":"No"),1),a("td",null,E((G=n.profile)==null?void 0:G.display_name),1),a("td",null,[t(ve,{class:"text-uppercase",size:"small",color:`${n.status=="active"?"success":"error"}`},{default:l(()=>[f(E(n.status),1)]),_:2},1032,["color"])]),a("td",null,[a("div",Re,[c(u).user.role=="superadmin"||(J=c(u).capabilities)!=null&&J.includes("edit")?(r(),m(g,{key:0,loading:C.value,onClick:()=>te(n.id),icon:c(me),title:"Edit",density:"compact",class:"mx-2"},null,8,["loading","onClick","icon"])):x("",!0),n.status=="active"&&(c(u).user.role=="superadmin"||(K=c(u).capabilities)!=null&&K.includes("delete"))?(r(),m(g,{key:1,density:"compact",loading:C.value,icon:c(fe),onClick:()=>M(n.id,"disabled"),title:"Disable",class:"mx-2 text-error"},null,8,["loading","icon","onClick"])):x("",!0),n.status=="disabled"&&(c(u).user.role=="superadmin"||(H=c(u).capabilities)!=null&&H.includes("delete"))?(r(),m(g,{key:2,loading:C.value,density:"compact",onClick:()=>M(n.id,"active"),icon:c(ge),title:"Enable",class:"mx-2 text-success"},null,8,["loading","onClick","icon"])):x("",!0)])])])}),128))])]}),_:1}),d.value.data.length==0?(r(),m(he,{key:0,class:"pa-3 text-center w-100"},{default:l(()=>[f("No records found")]),_:1})):x("",!0)]),_:1},8,["loading"]),R.value>1?(r(),m(ye,{key:0,modelValue:v.value,"onUpdate:modelValue":e[8]||(e[8]=o=>v.value=o),class:"my-4",length:R.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:d.value.loading},null,8,["modelValue","length","disabled"])):x("",!0)])]),_:1})]),_:1})]),_:1})):(r(),m(q,{key:1},{default:l(()=>[t(Q,null,{default:l(()=>[t(y,null,{default:l(()=>[t(w,{md:"12",class:"text-center my-3"},{default:l(()=>[f("Change all current / pending approvals only. "),De,Ie,qe,Le]),_:1}),a("div",Oe,[t(y,null,{default:l(()=>[a("div",Ue,[t(xe,{modelValue:B.value,"onUpdate:modelValue":e[9]||(e[9]=o=>B.value=o),label:"SN No. (Optional)",variant:"outlined","hide-details":"auto",density:"compact",clearable:""},null,8,["modelValue"]),Fe])]),_:1}),t(y,null,{default:l(()=>[a("div",je,[t(be)])]),_:1})]),a("div",Me,[t(L,{label:"Select Old Approver*",modelValue:V.value,"onUpdate:modelValue":e[10]||(e[10]=o=>V.value=o),"hide-details":"auto",variant:"outlined",density:"compact","item-value":"id","item-title":"display_name",items:S.value,class:"mx-2"},null,8,["modelValue","items"]),t(ke,{class:"my-auto",icon:c(Ve)},null,8,["icon"]),t(L,{label:"Select New Approver*",modelValue:k.value,"onUpdate:modelValue":e[11]||(e[11]=o=>k.value=o),"hide-details":"auto",variant:"outlined",density:"compact","item-value":"id","item-title":"display_name",items:S.value,class:"mx-2"},null,8,["modelValue","items"])]),t(w,{md:"12",class:"text-center pt-0"},{default:l(()=>[Ge,Je]),_:1})]),_:1}),t(y,null,{default:l(()=>[t(w,{md:"12"},{default:l(()=>[t(g,{disabled:k.value.length==0||V.value.length==0,block:"",color:"success",onClick:e[12]||(e[12]=o=>le())},{default:l(()=>[f("Transfer Signatory")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1})]),_:1}),t(Se,{options:b.value},null,8,["options"])]),_:1}))}},Xe=Ne(Ke,[["__scopeId","data-v-12c5db8c"]]);export{Xe as default};
