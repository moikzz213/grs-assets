import{r as s,i as ee,u as ae,L as te,M as le,o as se,j as g,k as u,C as oe,K as V,b as p,l as o,N as B,A as U,D as I,O as ne,P as ie,y as ue,x as re,e as l,Q as de,G as d,z as w,m as $,I as f,c as T,d as ce,t as b,R as pe,S as ve,a8 as ge,am as me,F as fe,U as ye,W as he}from"./app-2c5a49eb.js";import{_ as Ce}from"./AppPageHeader-aab5a62f.js";import{d as xe,e as be}from"./encrypt-4f38213f.js";import{_ as ke}from"./AppSnackBar-abe71aae.js";import{_ as _e}from"./DialogForm-8fbf2177.js";import"./index.esm-7f8f3b3c.js";const Ve=l("div",{class:"mt-2 mr-2"},"Show",-1),we={class:"v-col-12"},Se={class:"text-right text-capitalize"},De={class:"d-flex align-center justify-end"},Ae={__name:"List",setup(Pe){const k=s({status:!1,type:"primary",text:null}),n=ee(),M=ae(),S=te(),r=s({loading:!1,data:[]}),D=s(0),G=s(0),m=s(""),J=s([10,20,50,100]),P=s(10),Q=()=>{v()},z=()=>{localStorage.setItem("category-search",be(m.value)),v()},W=()=>{m.value="",localStorage.setItem("category-search",""),v()},c=s(S.params&&S.params.page?S.params.page:1),_=s([]),O=s(""),j=s(0),y=e=>{r.value.loading=!0,_.value[0]=e,j.value%2?_.value[1]="DESC":_.value[1]="ASC",j.value++,O.value=JSON.stringify(_.value),v()},v=async()=>{r.value.loading=!0,await V(n.token).get("/api/categories/all?page="+c.value+"&show="+P.value+"&search="+m.value+"&sort="+O.value).then(e=>{D.value=e.data.last_page?e.data.last_page:e.data.length,c.value=e.data.current_page?e.data.current_page:c.value,G.value=e.data.total?e.data.total:e.data.length,r.value.data=e.data.data?e.data.data:e.data,r.value.loading=!1}).catch(e=>{r.value.loading=!1,console.log(e)})};le(c,(e,a)=>{c.value&&e!=a&&(M.push({name:"PaginatedCategories",params:{page:c.value}}).catch(i=>{}),v(c.value))});const H=e=>{h.value={},x.value=e},X=async e=>{x.value=!1,e.profile_id=n.user.profile.id,await V(n.token).post("/api/categories/store-update/data",e).then(a=>{k.value={status:!0,type:"success",text:a.data.message},N.value=[{name:"title",label:"Category",required:!0,type:"text"},{name:"code",label:"Code",required:!0,type:"text"}],v().then(()=>{E()})}).catch(a=>{r.value.loading=!1,console.log(a)})},h=s({}),A=s([]),E=async()=>{await V(n.token).get("/api/fetch/categories/non-paginated/data").then(e=>{A.value=e.data,N.value.push({name:"category_id",label:"Parent Category",required:!1,type:"select",data:A.value})}).catch(e=>{console.log(e)})},Y=e=>{h.value=Object.assign({},e),h.value.type="category",x.value=!0},C=s(!1),R=async(e,a)=>{k.value={status:!0,type:"info",text:"Please wait..."},C.value=!0;let i={id:e,status:a,profile_id:n.user.profile.id};await V(n.token).post("/api/categories/status-change/data",i).then(t=>{setTimeout(()=>{k.value={status:!0,type:"success",text:t.data.message},v(),C.value=!1},600)}).catch(t=>{r.value.loading=!1,console.log(t)})},x=s(!1),Z=()=>{h.value="",x.value=!0},N=s([{name:"title",label:"Category",required:!0,type:"text"},{name:"code",label:"Code",required:!0,type:"text"}]);return se(()=>{let e=localStorage.getItem("category-search");e&&(m.value=xe(e)),v().then(()=>{E()})}),(e,a)=>(p(),g(oe,null,{default:u(()=>[o(Ce,{title:"Category List"}),o(I,{class:"mb-3"},{default:u(()=>[o(B,{class:"v-col-12 mt-1 col-sm-12 py-0"},{default:u(()=>[o(U,{class:"px-5"},{default:u(()=>[o(I,null,{default:u(()=>[o(B,{class:"v-col-6 v-col-md-2 v-col-sm-6 d-flex my-2"},{default:u(()=>[Ve,o(ne,{items:J.value,modelValue:P.value,"onUpdate:modelValue":[a[0]||(a[0]=i=>P.value=i),Q],variant:"outlined",density:"compact","hide-details":"",label:"Entry"},null,8,["items","modelValue"])]),_:1}),o(ie),o(B,{class:"v-col-6 v-col-md-3 v-col-sm-6 my-2"},{default:u(()=>[o(ue,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=i=>m.value=i),variant:"outlined",density:"compact",clearable:"",label:"Search",type:"text","hide-details":"","onClick:appendOuter":z,onKeydown:re(z,["enter"]),"onClick:clear":a[2]||(a[2]=i=>W("search"))},null,8,["modelValue","onKeydown"])]),_:1})]),_:1})]),_:1})]),_:1}),l("div",we,[o(U,{loading:r.value.loading},{default:u(()=>[o(de,null,{default:u(()=>{var i;return[l("thead",null,[l("tr",null,[l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[3]||(a[3]=t=>y("title"))}," Category "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[4]||(a[4]=t=>y("code"))}," Code "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[5]||(a[5]=t=>y("title"))}," Parent Category "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[6]||(a[6]=t=>y("profile_id"))}," Updated By "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[7]||(a[7]=t=>y("status"))}," Status "),l("th",Se,[d(n).user.role=="superadmin"||(i=d(n).capabilities)!=null&&i.includes("add")?(p(),g(w,{key:0,size:"small",color:"primary",onClick:Z},{default:u(()=>[$("Add New")]),_:1})):f("",!0)])])]),l("tbody",null,[(p(!0),T(fe,null,ce(r.value.data,t=>{var q,F,K,L;return p(),T("tr",{key:t.id},[l("td",null,b(t.title),1),l("td",null,b(t.code),1),l("td",null,b(t.title),1),l("td",null,b((q=t.profile)==null?void 0:q.display_name),1),l("td",null,[o(pe,{class:"text-uppercase",size:"small",color:`${t.status=="active"?"success":"error"}`},{default:u(()=>[$(b(t.status),1)]),_:2},1032,["color"])]),l("td",null,[l("div",De,[d(n).user.role=="superadmin"||(F=d(n).capabilities)!=null&&F.includes("edit")?(p(),g(w,{key:0,loading:C.value,onClick:()=>Y(t),icon:d(ve),title:"Edit",density:"compact",class:"mx-2"},null,8,["loading","onClick","icon"])):f("",!0),t.status=="active"&&(d(n).user.role=="superadmin"||(K=d(n).capabilities)!=null&&K.includes("delete"))?(p(),g(w,{key:1,density:"compact",loading:C.value,icon:d(ge),onClick:()=>R(t.id,"disabled"),title:"Disable",class:"mx-2 text-error"},null,8,["loading","icon","onClick"])):f("",!0),t.status=="disabled"&&(d(n).user.role=="superadmin"||(L=d(n).capabilities)!=null&&L.includes("delete"))?(p(),g(w,{key:2,loading:C.value,density:"compact",onClick:()=>R(t.id,"active"),icon:d(me),title:"Enable",class:"mx-2 text-success"},null,8,["loading","onClick","icon"])):f("",!0)])])])}),128))])]}),_:1}),r.value.data.length==0?(p(),g(ye,{key:0,class:"pa-3 text-center w-100"},{default:u(()=>[$("No records found")]),_:1})):f("",!0)]),_:1},8,["loading"]),D.value>1?(p(),g(he,{key:0,modelValue:c.value,"onUpdate:modelValue":a[8]||(a[8]=i=>c.value=i),class:"my-4",length:D.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:r.value.loading},null,8,["modelValue","length","disabled"])):f("",!0)])]),_:1}),o(_e,{"free-form":N.value,"add-new-dialog":x.value,title:"Category","data-object":h.value,onCancelled:H,onSave:X},null,8,["free-form","add-new-dialog","data-object"]),o(ke,{options:k.value},null,8,["options"])]),_:1}))}};export{Ae as default};
