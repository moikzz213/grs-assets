import{r as s,a as Z,u as ee,G as te,H as ae,I as le,c as y,w as u,m as se,n as S,o as f,d as o,b as l,k as oe,V as ne,i as ie,h as ue,s as P,J as _,x as de,e as x,p as U,q as re,t as d,K as ce,C as g,B as F,L as pe,M as ve,y as q,F as me,N as fe,O as ge}from"./app-2ad61952.js";import{_ as he}from"./ApppageHeader-016d2d93.js";import{d as ye,e as _e}from"./encrypt-c9d9960c.js";import{_ as xe}from"./AppSnackBar-50c76836.js";import{u as I}from"./formatDate-b9aad8c5.js";const Ve={class:"v-col-12"},Ce=l("div",{class:"mr-auto"},"Asset Requests",-1),be={class:"v-col-12 v-col-md"},ke={class:"v-col-12 v-col-md"},we={class:"v-col-12 v-col-md"},Se={class:"v-col-12 v-col-md"},qe=l("th",{class:"text-left text-capitalize"},"SN No.",-1),De=l("br",null,null,-1),Re=l("small",null,"(DD/MM/YY)",-1),ze=l("br",null,null,-1),Ne=l("small",null,"(DD/MM/YY)",-1),je=l("th",{class:"text-right text-capitalize"},null,-1),$e={class:"d-flex align-center justify-end"},Ie={__name:"List",setup(Ae){const M=s({status:!1,type:"primary",text:null}),r=Z(),D=ee(),V=te(),i=s({loading:!1,data:[]}),C=s(0),O=s(0),m=s(""),T=s([10,20,50,100]),b=s(10),c=s({}),K=()=>{v()},k=()=>{w.value="",n.value==1?v():n.value=1},R=()=>{localStorage.setItem("request-asset-search",_e(m.value)),v()},Y=()=>{m.value="",localStorage.setItem("request-asset-search",""),v()},n=s(V.params&&V.params.page?V.params.page:1),h=s([]),w=s(""),z=s(0),p=t=>{i.value.loading=!0,h.value[0]=t,z.value%2?h.value[1]="DESC":h.value[1]="ASC",z.value++,w.value=JSON.stringify(h.value),v()},N=s([]),E=async()=>{await S(r.token).get("/api/fetch/companies").then(t=>{N.value=t.data}).catch(t=>{})},j=s([]),J=async()=>{await S(r.token).get("/api/fetch/locations/non-paginated/data").then(t=>{j.value=t.data}).catch(t=>{})},G=s([{id:"pending",title:"Pending"},{id:"awaiting-approval",title:"Awaiting Approval"},{id:"reject",title:"Rejected"},{id:"cancelled",title:"Cancelled"},{id:"complete",title:"Completed"}]),H=t=>t=="reject"?"Rejected":t=="complete"?"Completed":t,v=async()=>{i.value.loading=!0,await S(r.token).get("/api/fetch/request-assets/by-requestor/request?userid="+r.user.profile.id+"&role="+r.user.profile.role+"&page="+n.value+"&show="+b.value+"&search="+m.value+"&sort="+w.value+"&filter="+JSON.stringify(c.value)).then(t=>{console.log("dataobj.value",i.value),C.value=t.data.last_page?t.data.last_page:t.data.length,n.value=t.data.current_page?t.data.current_page:n.value,O.value=t.data.total?t.data.total:t.data.length,i.value.data=t.data.data?t.data.data:t.data,i.value.loading=!1}).catch(t=>{i.value.loading=!1,console.log(t)})};ae(n,(t,a)=>{n.value&&t!=a&&(D.push({name:"PaginatedRequestAsset",params:{page:n.value}}).catch(e=>{}),v(n.value))});const Q=t=>{D.push({name:"EditRequestAsset",params:{id:t}}).catch(a=>{console.log(a)})},W=t=>{console.log("delete",t)},X=(t,a=6)=>{let e="00000"+t;return e.substring(e.length-a)};return le(()=>{let t=localStorage.getItem("request-asset-search");t&&(m.value=ye(t)),v().then(()=>{E().then(()=>{J()})})}),(t,a)=>(f(),y(se,null,{default:u(()=>[o(he,{title:"Asset request page"}),o(P,{class:"mb-3"},{default:u(()=>[l("div",Ve,[o(oe,{loading:i.value.loading},{default:u(()=>[o(ne,{class:"d-flex align-center mb-3 pa-3"},{default:u(()=>[Ce,o(ie,{modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=e=>m.value=e),variant:"outlined",density:"compact",clearable:"",label:"Search (ex. SN-5000035 )",type:"text","hide-details":"",style:{"max-width":"300px"},"onClick:appendOuter":R,onKeydown:ue(R,["enter"]),"onClick:clear":a[1]||(a[1]=e=>Y("search"))},null,8,["modelValue","onKeydown"])]),_:1}),o(P,{class:"px-3"},{default:u(()=>[l("div",be,[o(_,{items:N.value,modelValue:c.value.company_id,"onUpdate:modelValue":[a[2]||(a[2]=e=>c.value.company_id=e),k],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Company"},null,8,["items","modelValue"])]),l("div",ke,[o(_,{items:j.value,modelValue:c.value.location_id,"onUpdate:modelValue":[a[3]||(a[3]=e=>c.value.location_id=e),k],variant:"outlined",density:"compact","hide-details":"",label:"Location","item-value":"id",clearable:"","item-title":"title"},null,8,["items","modelValue"])]),l("div",we,[o(_,{items:G.value,modelValue:c.value.status,"onUpdate:modelValue":[a[4]||(a[4]=e=>c.value.status=e),k],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Status"},null,8,["items","modelValue"])]),l("div",Se,[o(_,{items:T.value,modelValue:b.value,"onUpdate:modelValue":[a[5]||(a[5]=e=>b.value=e),K],variant:"outlined",density:"compact","hide-details":"",label:"Show"},null,8,["items","modelValue"])])]),_:1}),o(de,null,{default:u(()=>[l("thead",null,[l("tr",null,[qe,l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[6]||(a[6]=e=>p("company_id"))}," Company "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[7]||(a[7]=e=>p("transferred_to"))}," Location "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[8]||(a[8]=e=>p("subject"))}," Subject "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[9]||(a[9]=e=>p("profile_id"))}," Requestor "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[10]||(a[10]=e=>p("status"))}," Status "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[11]||(a[11]=e=>p("created_at"))},[x(" D.Requested"),De,Re]),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[12]||(a[12]=e=>p("date_closed"))},[x(" D.Closed"),ze,Ne]),je])]),l("tbody",null,[(f(!0),U(me,null,re(i.value.data,e=>{var $,A,L,B;return f(),U("tr",{key:e.id},[l("td",null,"SN-5"+d(X(e.id)),1),l("td",null,d(($=e.company)==null?void 0:$.title),1),l("td",null,d((A=e.transfer_to)==null?void 0:A.title),1),l("td",null,d(e.subject),1),l("td",null,d((L=e.profile)==null?void 0:L.display_name),1),l("td",null,[o(ce,{class:"text-uppercase",size:"small",color:`${e.status.toLowerCase()=="complete"?"success":"error"}`},{default:u(()=>[x(d(H(e.status)),1)]),_:2},1032,["color"])]),l("td",null,d(g(I)(e.created_at)),1),l("td",null,d(e.date_closed&&e.date_closed!="0000-00-00"?g(I)(e.date_closed):""),1),l("td",null,[l("div",$e,[o(F,{size:"small",onClick:()=>Q(e.id),icon:g(pe),class:"mx-1"},null,8,["onClick","icon"]),g(r).user.role=="superadmin"||(B=g(r).capabilities)!=null&&B.includes("delete")?(f(),y(F,{key:0,size:"small",onClick:()=>W(e.id),icon:g(ve),class:"mx-1"},null,8,["onClick","icon"])):q("",!0)])])])}),128))])]),_:1}),i.value.data.length==0?(f(),y(fe,{key:0,class:"pa-3 text-center w-100"},{default:u(()=>[x("No records found")]),_:1})):q("",!0)]),_:1},8,["loading"]),C.value>1?(f(),y(ge,{key:0,modelValue:n.value,"onUpdate:modelValue":a[13]||(a[13]=e=>n.value=e),class:"my-4",length:C.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:i.value.loading},null,8,["modelValue","length","disabled"])):q("",!0)])]),_:1}),o(xe,{options:M.value},null,8,["options"])]),_:1}))}};export{Ie as default};
