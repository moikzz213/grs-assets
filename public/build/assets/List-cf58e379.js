import{r as s,a as tt,u as et,G as at,H as lt,I as ot,c as L,w as c,m as st,n as A,o as V,d as n,b as l,k as nt,V as rt,i as it,h as ut,s as U,J as _,x as dt,e as b,p as M,q as ct,ad as mt,y as I,t as i,K as ft,C as pt,L as vt,F as gt,M as yt,z as q,N as St}from"./app-95d69f7e.js";import{_ as xt}from"./AppPageHeader-1fb30f55.js";import{d as v,e as g}from"./encrypt-c56ddfeb.js";import{_ as Ct}from"./AppSnackBar-84082ac2.js";import{u as K}from"./formatDate-559e9d83.js";const ht={class:"v-col-12"},Vt=l("div",{class:"mr-auto"},"Asset Transfers",-1),_t={class:"v-col-12 v-col-md"},bt={class:"v-col-12 v-col-md"},wt={class:"v-col-12 v-col-md"},kt={class:"v-col-12 v-col-md-2"},It={class:"v-col-12 v-col-md-2"},$t=l("th",{class:"text-left text-capitalize"},"SN No.",-1),zt=l("br",null,null,-1),Dt=l("small",null,"PENDING",-1),Nt=l("br",null,null,-1),Lt=l("small",null,"(DD/MM/YY)",-1),At=l("br",null,null,-1),Tt=l("small",null,"(DD/MM/YY)",-1),jt=l("th",{class:"text-right text-capitalize last-child-action"},null,-1),Rt={class:"last-child-action"},Pt={class:"d-flex align-center justify-end"},Ot={__name:"List",setup(Bt){const O=s({status:!1,type:"primary",text:null}),f=tt(),T=et(),$=at(),u=s({loading:!1,data:[]}),z=s(0),E=s(0),p=s(""),Y=s([10,20,50,100]),y=s(10),o=s({}),J=()=>{localStorage.setItem("transfer-filter-row",g(y.value)),m()},w=a=>{D.value="",r.value==1?(a=="company"?localStorage.setItem("transfer-filter-company",g(o.value.company_id)):a=="location"?localStorage.setItem("transfer-filter-location",g(o.value.location_id)):a=="from"?localStorage.setItem("transfer-filter-from",g(o.value.from)):a=="status"&&localStorage.setItem("transfer-filter-status",g(o.value.status)),m()):r.value=1},j=()=>{localStorage.setItem("transfer-asset-search",g(p.value)),m()},S=a=>{a=="search"?(p.value="",localStorage.setItem("transfer-asset-search",""),m()):a=="company"?localStorage.setItem("transfer-filter-company",""):a=="location"?localStorage.setItem("transfer-filter-location",""):a=="from"?localStorage.setItem("transfer-filter-from",""):a=="status"&&localStorage.setItem("transfer-filter-status","")},r=s($.params&&$.params.page?$.params.page:1),k=s([]),D=s(""),R=s(0),d=a=>{u.value.loading=!0,k.value[0]=a,R.value%2?k.value[1]="DESC":k.value[1]="ASC",R.value++,D.value=JSON.stringify(k.value),m()},P=s([]),G=async()=>{await A(f.token).get("/api/fetch/companies").then(a=>{P.value=a.data}).catch(a=>{})},N=s([]),H=async()=>{await A(f.token).get("/api/fetch/locations/non-paginated/data").then(a=>{N.value=a.data}).catch(a=>{})},Q=s([{id:"pending",title:"Pending"},{id:"awaiting-approval",title:"Awaiting Approval"},{id:"reject",title:"Rejected"},{id:"cancelled",title:"Cancelled"},{id:"complete",title:"Completed"}]),W=a=>a=="reject"?"Rejected":a=="complete"?"Completed":a,m=async()=>{u.value.loading=!0,await A(f.token).get("/api/fetch/request-assets/by-requestor/transfer?userid="+f.user.profile.id+"&role="+f.user.profile.role+"&page="+r.value+"&show="+y.value+"&search="+p.value+"&sort="+D.value+"&filter="+JSON.stringify(o.value)).then(a=>{z.value=a.data.last_page?a.data.last_page:a.data.length,r.value=a.data.current_page?a.data.current_page:r.value,E.value=a.data.total?a.data.total:a.data.length,u.value.data=a.data.data?a.data.data:a.data,u.value.loading=!1}).catch(a=>{u.value.loading=!1,localStorage.setItem("transfer-filter-company",null),localStorage.setItem("transfer-filter-location",null),localStorage.setItem("transfer-filter-from",null),localStorage.setItem("transfer-filter-status",null),localStorage.setItem("transfer-filter-row",10)})};lt(r,(a,t)=>{r.value&&a!=t&&(T.push({name:"PaginatedTransferAsset",params:{page:r.value}}).catch(e=>{}),m(r.value))});const X=a=>{T.push({name:"EditTransferAsset",params:{id:a}}).catch(t=>{console.log(t)})},Z=(a,t=6)=>{let e="00000"+a;return e.substring(e.length-t)};return ot(()=>{let a=localStorage.getItem("transfer-asset-search"),t=localStorage.getItem("transfer-filter-company"),e=localStorage.getItem("transfer-filter-location"),x=localStorage.getItem("transfer-filter-from"),C=localStorage.getItem("transfer-filter-status"),h=localStorage.getItem("transfer-filter-row");a&&(p.value=v(a)),t&&(o.value.company_id=v(t)),e&&(o.value.location_id=v(e)),x&&(o.value.from=v(x)),C&&(o.value.status=v(C)),h&&(y.value=v(h)),m().then(()=>{G().then(()=>{H()})})}),(a,t)=>(V(),L(st,null,{default:c(()=>[n(xt,{title:"Asset Transfer page"}),n(U,{class:"mb-3"},{default:c(()=>[l("div",ht,[n(nt,{loading:u.value.loading},{default:c(()=>[n(rt,{class:"d-flex align-center mb-3 pa-3"},{default:c(()=>[Vt,n(it,{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=e=>p.value=e),variant:"outlined",density:"compact",clearable:"",label:"Search (ex. SN-3000035 )",type:"text","hide-details":"",style:{"max-width":"300px"},"onClick:appendOuter":j,onKeydown:ut(j,["enter"]),"onClick:clear":t[1]||(t[1]=e=>S("search"))},null,8,["modelValue","onKeydown"])]),_:1}),n(U,{class:"px-3"},{default:c(()=>[l("div",_t,[n(_,{items:P.value,modelValue:o.value.company_id,"onUpdate:modelValue":[t[2]||(t[2]=e=>o.value.company_id=e),t[3]||(t[3]=e=>w("company"))],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Company","onClick:clear":t[4]||(t[4]=e=>S("company"))},null,8,["items","modelValue"])]),l("div",bt,[n(_,{items:N.value,modelValue:o.value.from,"onUpdate:modelValue":[t[5]||(t[5]=e=>o.value.from=e),t[6]||(t[6]=e=>w("from"))],variant:"outlined",density:"compact","hide-details":"",label:"Location From","item-value":"id",clearable:"","item-title":"title","onClick:clear":t[7]||(t[7]=e=>S("from"))},null,8,["items","modelValue"])]),l("div",wt,[n(_,{items:N.value,modelValue:o.value.location_id,"onUpdate:modelValue":[t[8]||(t[8]=e=>o.value.location_id=e),t[9]||(t[9]=e=>w("location"))],variant:"outlined",density:"compact","hide-details":"",label:"Location To","item-value":"id",clearable:"","item-title":"title","onClick:clear":t[10]||(t[10]=e=>S("location"))},null,8,["items","modelValue"])]),l("div",kt,[n(_,{items:Q.value,modelValue:o.value.status,"onUpdate:modelValue":[t[11]||(t[11]=e=>o.value.status=e),t[12]||(t[12]=e=>w("status"))],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"","onClick:clear":t[13]||(t[13]=e=>S("status")),label:"Status"},null,8,["items","modelValue"])]),l("div",It,[n(_,{items:Y.value,modelValue:y.value,"onUpdate:modelValue":[t[14]||(t[14]=e=>y.value=e),J],variant:"outlined",density:"compact","hide-details":"",label:"Show"},null,8,["items","modelValue"])])]),_:1}),n(dt,null,{default:c(()=>[l("thead",null,[l("tr",null,[$t,l("th",{class:"text-left text-capitalize cursor-pointer",onClick:t[15]||(t[15]=e=>d("company_id"))}," Company "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:t[16]||(t[16]=e=>d("transferred_from"))}," From "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:t[17]||(t[17]=e=>d("transferred_to"))}," To "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:t[18]||(t[18]=e=>d("subject"))}," Subject "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:t[19]||(t[19]=e=>d("profile_id"))}," Requestor "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:t[20]||(t[20]=e=>d("reminder_profile_id"))},[b(" Approval"),zt,Dt]),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:t[21]||(t[21]=e=>d("status"))}," Status "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:t[22]||(t[22]=e=>d("created_at"))},[b(" D.Requested"),Nt,Lt]),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:t[23]||(t[23]=e=>d("date_closed"))},[b(" D.Closed"),At,Tt]),jt])]),l("tbody",null,[(V(!0),M(gt,null,ct(u.value.data,e=>{var x,C,h,B,F;return V(),M("tr",{key:e.id,class:mt(`${I(f).user.profile.id==e.reminder_profile_id?"bg-blue-lighten-5":""} `)},[l("td",null,"SN-3"+i(Z(e.id)),1),l("td",null,i((x=e.company)==null?void 0:x.title),1),l("td",null,i((C=e.transfer_from)==null?void 0:C.title),1),l("td",null,i((h=e.transfer_to)==null?void 0:h.title),1),l("td",null,i(e.subject),1),l("td",null,i((B=e.profile)==null?void 0:B.display_name),1),l("td",null,i((F=e.reminder_profile)==null?void 0:F.display_name),1),l("td",null,[n(ft,{class:"text-uppercase",size:"small",color:`${e.status.toLowerCase()=="complete"?"success":e.status.toLowerCase()=="pending"||e.status.toLowerCase()=="awaiting-approval"?"warning":"error"}`},{default:c(()=>[b(i(W(e.status)),1)]),_:2},1032,["color"])]),l("td",null,i(I(K)(e.created_at)),1),l("td",null,i(e.date_closed&&e.date_closed!="0000-00-00"?I(K)(e.date_closed):""),1),l("td",Rt,[l("div",Pt,[n(pt,{size:"small",onClick:()=>X(e.id),icon:I(vt),class:"mx-1"},null,8,["onClick","icon"])])])],2)}),128))])]),_:1}),u.value.data.length==0?(V(),L(yt,{key:0,class:"pa-3 text-center w-100"},{default:c(()=>[b("No records found")]),_:1})):q("",!0)]),_:1},8,["loading"]),z.value>1?(V(),L(St,{key:0,modelValue:r.value,"onUpdate:modelValue":t[24]||(t[24]=e=>r.value=e),class:"my-4",length:z.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:u.value.loading},null,8,["modelValue","length","disabled"])):q("",!0)])]),_:1}),n(Ct,{options:O.value},null,8,["options"])]),_:1}))}};export{Ot as default};
