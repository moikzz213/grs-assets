import{u as L,r,a as B,c as E,w as l,o as N,b as c,d as t,t as v,V as P,e as p,f as S,g as T,h as A,i as g,j as w,k as G,l as K}from"./app-d1935eb8.js";import{G as F,W as I}from"./WhiteLogo-e380c21a.js";import"./_plugin-vue_export-helper-c27b6911.js";const R={class:"mx-auto px-3 text-center",style:{"z-index":"1","max-width":"320px",width:"100%","margin-top":"100px"}},U={class:"text-subtitle-1 text-white"},W={class:"text-error mt-2"},J={__name:"SanctumLogin",setup(j){const m=L(),x=r("Grandiose Assets"),_=r("grs-asset-wvukt"),f=B();f.authIsLoggedIn==!0&&m.push({path:"/dashboard"});const u=r(!1),s=r({login:"",password:"",url:_.value}),i=r(!1),d=r(""),h=async()=>{u.value=!0,y().then(e=>{if(!e)return;let a="/dashboard",n=e.data.user.username,k=e.data.token;axios.get("/api/fetch/log-profile/"+n+"/"+k).then(o=>{if(!o.data.id){i.value=!0,d.value=o.data,u.value=!1;return}let b=o.data.access.map(C=>C);e.data.access=b,e.data.user.role=o.data.role,e.data.user.profile=o.data,f.setCredentials(e.data).then(()=>{window.location=a})}).catch(o=>{console.log("errrr 1",o)})}).catch(e=>{i.value=!0,d.value=e.response.data.message,u.value=!1})},V=()=>{m.push({path:"reset-password"})},y=async()=>{d.value="";let e={username:s.value.login,password:s.value.password,url:s.value.url};const a=await K.post("/api/sanctumlogin",e);return a.data.status==!1?(i.value=!0,d.value=a.data.message,u.value=!1,!1):a};return(e,a)=>(N(),E(F,null,{default:l(()=>[c("div",R,[t(I,{width:"100%"}),c("div",U,v(x.value),1)]),t(G,{class:"mt-8 pa-3 rounded-lg elevation-3",width:"90%","max-width":"450"},{default:l(()=>[t(P,{class:"px-5 pb-0 primary--text"},{default:l(()=>[p("Login")]),_:1}),t(S,{class:"py-4"},{default:l(()=>[t(T,{autocomplete:"off",ref:"form",onKeydown:A(h,["enter"])},{default:l(()=>[t(g,{modelValue:s.value.login,"onUpdate:modelValue":a[0]||(a[0]=n=>s.value.login=n),variant:"outlined",required:"",class:"border-radius",autocomplete:"off",label:"Enter Employee Code"},null,8,["modelValue"]),t(g,{modelValue:s.value.password,"onUpdate:modelValue":a[1]||(a[1]=n=>s.value.password=n),variant:"outlined",required:"",autocomplete:"off",label:"Enter Password",type:"password"},null,8,["modelValue"]),t(w,{onClick:h,width:"100%",color:"primary",height:"55",large:"",loading:u.value},{default:l(()=>[p("Login")]),_:1},8,["loading"]),t(w,{variant:"text",class:"mt-3",block:"",onClick:V},{default:l(()=>[p("Reset Password")]),_:1}),c("div",W,v(i.value==!0?d.value:""),1)]),_:1},8,["onKeydown"])]),_:1})]),_:1})]),_:1}))}};export{J as default};
