import{r as s,a as ae,u as oe,G as se,H as ie,I as ne,c as I,w as m,m as re,n as N,o as g,d as i,b as a,k as ue,V as de,i as ce,h as me,s as M,J as b,x as pe,e as q,p as O,q as ve,af as fe,C as v,t as r,K as ge,B as K,L as ye,M as Ce,y as R,F as xe,N as Se,O as he}from"./app-eb6651a2.js";import{_ as Ve}from"./ApppageHeader-d09ce1d0.js";import{d as y,e as C}from"./encrypt-675dc7c1.js";import{_ as _e}from"./AppSnackBar-2bc96fcb.js";import{u as E}from"./formatDate-b9aad8c5.js";const be={class:"v-col-12"},qe=a("div",{class:"mr-auto"},"Asset Requests",-1),ke={class:"v-col-12 v-col-md"},we={class:"v-col-12 v-col-md"},Ie={class:"v-col-12 v-col-md"},$e={class:"v-col-12 v-col-md-2"},ze={class:"v-col-12 v-col-md-2"},De=a("th",{class:"text-left text-capitalize"},"SN No.",-1),Le=a("br",null,null,-1),Ne=a("small",null,"PENDING",-1),Re=a("br",null,null,-1),Ae=a("small",null,"(DD/MM/YY)",-1),je=a("br",null,null,-1),Be=a("small",null,"(DD/MM/YY)",-1),Pe=a("th",{class:"text-right text-capitalize last-child-action"},null,-1),Ue={class:"last-child-action"},Fe={class:"d-flex align-center justify-end"},Je={__name:"List",setup(Te){const Y=s({status:!1,type:"primary",text:null}),c=ae(),A=oe(),$=se(),u=s({loading:!1,data:[]}),z=s(0),J=s(0),f=s(""),G=s([10,20,50,100]),x=s(10),o=s({}),H=()=>{localStorage.setItem("request-filter-row",C(x.value)),p()},k=l=>{D.value="",n.value==1?(l=="company"?localStorage.setItem("request-filter-company",C(o.value.company_id)):l=="location"?localStorage.setItem("request-filter-location",C(o.value.location_id)):l=="from"?localStorage.setItem("request-filter-from",C(o.value.from)):l=="status"&&localStorage.setItem("request-filter-status",C(o.value.status)),p()):n.value=1},j=()=>{localStorage.setItem("request-asset-search",C(f.value)),p()},S=l=>{l=="search"?(f.value="",localStorage.setItem("request-asset-search",""),p()):l=="company"?localStorage.setItem("request-filter-company",""):l=="location"?localStorage.setItem("request-filter-location",""):l=="from"?localStorage.setItem("request-filter-from",""):l=="status"&&localStorage.setItem("request-filter-status","")},n=s($.params&&$.params.page?$.params.page:1),w=s([]),D=s(""),B=s(0),d=l=>{u.value.loading=!0,w.value[0]=l,B.value%2?w.value[1]="DESC":w.value[1]="ASC",B.value++,D.value=JSON.stringify(w.value),p()},P=s([]),Q=async()=>{await N(c.token).get("/api/fetch/companies").then(l=>{P.value=l.data}).catch(l=>{})},L=s([]),W=async()=>{await N(c.token).get("/api/fetch/locations/non-paginated/data").then(l=>{L.value=l.data}).catch(l=>{})},X=s([{id:"pending",title:"Pending"},{id:"awaiting-approval",title:"Awaiting Approval"},{id:"reject",title:"Rejected"},{id:"cancelled",title:"Cancelled"},{id:"complete",title:"Completed"}]),Z=l=>l=="reject"?"Rejected":l=="complete"?"Completed":l,p=async()=>{u.value.loading=!0,await N(c.token).get("/api/fetch/request-assets/by-requestor/request?userid="+c.user.profile.id+"&role="+c.user.profile.role+"&page="+n.value+"&show="+x.value+"&search="+f.value+"&sort="+D.value+"&filter="+JSON.stringify(o.value)).then(l=>{z.value=l.data.last_page?l.data.last_page:l.data.length,n.value=l.data.current_page?l.data.current_page:n.value,J.value=l.data.total?l.data.total:l.data.length,u.value.data=l.data.data?l.data.data:l.data,u.value.loading=!1}).catch(l=>{u.value.loading=!1,localStorage.setItem("request-filter-company",null),localStorage.setItem("request-filter-location",null),localStorage.setItem("request-filter-from",null),localStorage.setItem("request-filter-status",null),localStorage.setItem("request-filter-row",10)})};ie(n,(l,e)=>{n.value&&l!=e&&(A.push({name:"PaginatedRequestAsset",params:{page:n.value}}).catch(t=>{}),p(n.value))});const ee=l=>{A.push({name:"EditRequestAsset",params:{id:l}}).catch(e=>{console.log(e)})},te=l=>{console.log("delete",l)},le=(l,e=6)=>{let t="00000"+l;return t.substring(t.length-e)};return ne(()=>{let l=localStorage.getItem("request-asset-search"),e=localStorage.getItem("request-filter-company"),t=localStorage.getItem("request-filter-location"),h=localStorage.getItem("request-filter-from"),V=localStorage.getItem("request-filter-status"),_=localStorage.getItem("request-filter-row");l&&(f.value=y(l)),e&&(o.value.company_id=y(e)),t&&(o.value.location_id=y(t)),h&&(o.value.from=y(h)),V&&(o.value.status=y(V)),_&&(x.value=y(_)),p().then(()=>{Q().then(()=>{W()})})}),(l,e)=>(g(),I(re,null,{default:m(()=>[i(Ve,{title:"Asset request page"}),i(M,{class:"mb-3"},{default:m(()=>[a("div",be,[i(ue,{loading:u.value.loading},{default:m(()=>[i(de,{class:"d-flex align-center mb-3 pa-3"},{default:m(()=>[qe,i(ce,{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=t=>f.value=t),variant:"outlined",density:"compact",clearable:"",label:"Search (ex. SN-5000035 )",type:"text","hide-details":"",style:{"max-width":"300px"},"onClick:appendOuter":j,onKeydown:me(j,["enter"]),"onClick:clear":e[1]||(e[1]=t=>S("search"))},null,8,["modelValue","onKeydown"])]),_:1}),i(M,{class:"px-3"},{default:m(()=>[a("div",ke,[i(b,{items:P.value,modelValue:o.value.company_id,"onUpdate:modelValue":[e[2]||(e[2]=t=>o.value.company_id=t),e[3]||(e[3]=t=>k("company"))],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Company","onClick:clear":e[4]||(e[4]=t=>S("company"))},null,8,["items","modelValue"])]),a("div",we,[i(b,{items:L.value,modelValue:o.value.from,"onUpdate:modelValue":[e[5]||(e[5]=t=>o.value.from=t),e[6]||(e[6]=t=>k("from"))],variant:"outlined",density:"compact","hide-details":"",label:"Location From","item-value":"id",clearable:"","item-title":"title","onClick:clear":e[7]||(e[7]=t=>S("from"))},null,8,["items","modelValue"])]),a("div",Ie,[i(b,{items:L.value,modelValue:o.value.location_id,"onUpdate:modelValue":[e[8]||(e[8]=t=>o.value.location_id=t),e[9]||(e[9]=t=>k("location"))],variant:"outlined",density:"compact","hide-details":"",label:"Location To","item-value":"id",clearable:"","item-title":"title","onClick:clear":e[10]||(e[10]=t=>S("location"))},null,8,["items","modelValue"])]),a("div",$e,[i(b,{items:X.value,modelValue:o.value.status,"onUpdate:modelValue":[e[11]||(e[11]=t=>o.value.status=t),e[12]||(e[12]=t=>k("status"))],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Status","onClick:clear":e[13]||(e[13]=t=>S("status"))},null,8,["items","modelValue"])]),a("div",ze,[i(b,{items:G.value,modelValue:x.value,"onUpdate:modelValue":[e[14]||(e[14]=t=>x.value=t),H],variant:"outlined",density:"compact","hide-details":"",label:"Show"},null,8,["items","modelValue"])])]),_:1}),i(pe,null,{default:m(()=>[a("thead",null,[a("tr",null,[De,a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[15]||(e[15]=t=>d("company_id"))}," Company "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[16]||(e[16]=t=>d("transferred_from"))}," Location From "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[17]||(e[17]=t=>d("transferred_to"))}," Location To "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[18]||(e[18]=t=>d("subject"))}," Subject "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[19]||(e[19]=t=>d("profile_id"))}," Requestor "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[20]||(e[20]=t=>d("reminder_profile_id"))},[q(" Approval"),Le,Ne]),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[21]||(e[21]=t=>d("status"))}," Status "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[22]||(e[22]=t=>d("created_at"))},[q(" D.Requested"),Re,Ae]),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[23]||(e[23]=t=>d("date_closed"))},[q(" D.Closed"),je,Be]),Pe])]),a("tbody",null,[(g(!0),O(xe,null,ve(u.value.data,t=>{var h,V,_,U,F,T;return g(),O("tr",{key:t.id,class:fe(`${v(c).user.profile.id==t.reminder_profile_id?"bg-blue-lighten-5":""} `)},[a("td",null,"SN-5"+r(le(t.id)),1),a("td",null,r((h=t.company)==null?void 0:h.title),1),a("td",null,r((V=t.transfer_from)==null?void 0:V.title),1),a("td",null,r((_=t.transfer_to)==null?void 0:_.title),1),a("td",null,r(t.subject),1),a("td",null,r((U=t.profile)==null?void 0:U.display_name),1),a("td",null,r((F=t.reminder_profile)==null?void 0:F.display_name),1),a("td",null,[i(ge,{class:"text-uppercase",size:"small",color:`${t.status.toLowerCase()=="complete"?"success":t.status.toLowerCase()=="pending"||t.status.toLowerCase()=="awaiting-approval"?"warning":"error"}`},{default:m(()=>[q(r(Z(t.status)),1)]),_:2},1032,["color"])]),a("td",null,r(v(E)(t.created_at)),1),a("td",null,r(t.date_closed&&t.date_closed!="0000-00-00"?v(E)(t.date_closed):""),1),a("td",Ue,[a("div",Fe,[i(K,{size:"small",onClick:()=>ee(t.id),icon:v(ye),class:"mx-1"},null,8,["onClick","icon"]),v(c).user.role=="superadmin"||(T=v(c).capabilities)!=null&&T.includes("delete")?(g(),I(K,{key:0,size:"small",onClick:()=>te(t.id),icon:v(Ce),class:"mx-1"},null,8,["onClick","icon"])):R("",!0)])])],2)}),128))])]),_:1}),u.value.data.length==0?(g(),I(Se,{key:0,class:"pa-3 text-center w-100"},{default:m(()=>[q("No records found")]),_:1})):R("",!0)]),_:1},8,["loading"]),z.value>1?(g(),I(he,{key:0,modelValue:n.value,"onUpdate:modelValue":e[24]||(e[24]=t=>n.value=t),class:"my-4",length:z.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:u.value.loading},null,8,["modelValue","length","disabled"])):R("",!0)])]),_:1}),i(_e,{options:Y.value},null,8,["options"])]),_:1}))}};export{Je as default};
