import{r as n,a as ae,u as te,G as le,H as se,I as oe,c as m,w as u,m as ne,n as N,o as r,d as s,v as $,k as I,s as K,J as ie,_ as ue,i as ce,h as de,b as l,x as re,y as i,j as h,e as V,z as f,p as T,q as pe,t as b,K as ve,au as me,L as fe,as as ge,at as ye,F as he,M as xe,N as ke}from"./app-9e123732.js";import{_ as Ce}from"./AppPageHeader-369aed04.js";import{d as be,e as _e}from"./encrypt-1e851722.js";import{_ as we}from"./AppSnackBar-910aa351.js";import{_ as Ve}from"./DialogForm-79e6c24f.js";import"./index.esm-45165534.js";import"./Studio-a91b0946.js";import"./formatDate-559e9d83.js";const Se=l("div",{class:"mt-2 mr-2"},"Show",-1),Le={class:"v-col-12"},De={class:"text-right text-capitalize"},Be={class:"d-flex align-center justify-end"},qe={__name:"List",setup(Ne){const _=n({status:!1,type:"primary",text:null}),o=ae(),S=te(),L=le(),d=n({loading:!1,data:[]}),D=n(0),U=n(0),g=n(""),H=n([10,20,50,100]),B=n(10),J=()=>{v()},z=()=>{localStorage.setItem("location-search",_e(g.value)),v()},M=()=>{g.value="",localStorage.setItem("location-search",""),v()},p=n(L.params&&L.params.page?L.params.page:1),w=n([]),O=n(""),A=n(0),x=e=>{d.value.loading=!0,w.value[0]=e,A.value%2?w.value[1]="DESC":w.value[1]="ASC",A.value++,O.value=JSON.stringify(w.value),v()},v=async()=>{d.value.loading=!0,await N(o.token).get("/api/locations/all?page="+p.value+"&show="+B.value+"&search="+g.value+"&sort="+O.value).then(e=>{D.value=e.data.last_page?e.data.last_page:e.data.length,p.value=e.data.current_page?e.data.current_page:p.value,U.value=e.data.total?e.data.total:e.data.length,d.value.data=e.data.data?e.data.data:e.data,d.value.loading=!1}).catch(e=>{d.value.loading=!1,console.log(e)})},G=e=>{S.push({path:"/locations/"+e.toLowerCase()+"/stamp-signature/request"})},Q=e=>{S.push({path:"/location/view-assets/history/"+e})};se(p,(e,a)=>{p.value&&e!=a&&(S.push({name:"PaginatedLocations",params:{page:p.value}}).catch(c=>{}),v(p.value))});const W=e=>{k.value={},C.value=e},X=async e=>{C.value=!1,e.profile_id=o.user.profile.id,await N(o.token).post("/api/locations/store-update/data",e).then(a=>{_.value={status:!0,type:"success",text:a.data.message},v()}).catch(a=>{d.value.loading=!1,console.log(a)})},k=n({}),Y=n([{name:"title",label:"Location",required:!0,type:"text"},{name:"code",label:"Code",required:!0,type:"text"},{name:"area",label:"Area Location",required:!1,type:"text"}]),Z=e=>{k.value=Object.assign({},e),k.value.type="location",C.value=!0},y=n(!1),P=async(e,a)=>{_.value={status:!0,type:"info",text:"Please wait..."},y.value=!0;let c={id:e,status:a,profile_id:o.user.profile.id};await N(o.token).post("/api/locations/status-change/data",c).then(t=>{setTimeout(()=>{_.value={status:!0,type:"success",text:t.data.message},v(),y.value=!1},600)}).catch(t=>{d.value.loading=!1,console.log(t)})},C=n(!1),ee=()=>{k.value="",C.value=!0};return oe(()=>{let e=localStorage.getItem("location-search");e&&(g.value=be(e)),v()}),(e,a)=>(r(),m(ne,null,{default:u(()=>[s(Ce,{title:"Location List"}),s(K,{class:"mb-3"},{default:u(()=>[s($,{class:"v-col-12 mt-1 col-sm-12 py-0"},{default:u(()=>[s(I,{class:"px-5"},{default:u(()=>[s(K,null,{default:u(()=>[s($,{class:"v-col-6 v-col-md-2 v-col-sm-6 d-flex my-2"},{default:u(()=>[Se,s(ie,{items:H.value,modelValue:B.value,"onUpdate:modelValue":[a[0]||(a[0]=c=>B.value=c),J],variant:"outlined",density:"compact","hide-details":"",label:"Entry"},null,8,["items","modelValue"])]),_:1}),s(ue),s($,{class:"v-col-6 v-col-md-3 v-col-sm-6 my-2"},{default:u(()=>[s(ce,{modelValue:g.value,"onUpdate:modelValue":a[1]||(a[1]=c=>g.value=c),variant:"outlined",density:"compact",clearable:"",label:"Search",type:"text","hide-details":"","onClick:appendOuter":z,onKeydown:de(z,["enter"]),"onClick:clear":a[2]||(a[2]=c=>M("search"))},null,8,["modelValue","onKeydown"])]),_:1})]),_:1})]),_:1})]),_:1}),l("div",Le,[s(I,{loading:d.value.loading},{default:u(()=>[s(re,null,{default:u(()=>{var c;return[l("thead",null,[l("tr",null,[l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[3]||(a[3]=t=>x("title"))}," Location "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[4]||(a[4]=t=>x("code"))}," Code "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[5]||(a[5]=t=>x("area"))}," Area "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[6]||(a[6]=t=>x("profile_id"))}," Updated By "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[7]||(a[7]=t=>x("status"))}," Status "),l("th",De,[i(o).user.role=="superadmin"||(c=i(o).capabilities)!=null&&c.includes("add")?(r(),m(h,{key:0,size:"small",color:"primary",onClick:ee},{default:u(()=>[V("Add New")]),_:1})):f("",!0)])])]),l("tbody",null,[(r(!0),T(he,null,pe(d.value.data,t=>{var j,E,R,q,F;return r(),T("tr",{key:t.id},[l("td",null,b(t.title),1),l("td",null,b(t.code),1),l("td",null,b(t.area),1),l("td",null,b((j=t.profile)==null?void 0:j.display_name),1),l("td",null,[s(ve,{class:"text-uppercase",size:"small",color:`${t.status=="active"?"success":"error"}`},{default:u(()=>[V(b(t.status),1)]),_:2},1032,["color"])]),l("td",null,[l("div",Be,[s(h,{density:"compact",icon:i(me),onClick:()=>Q(t.id),title:"History",class:"mx-2"},null,8,["icon","onClick"]),i(o).user.role=="superadmin"||(E=i(o).capabilities)!=null&&E.includes("edit")?(r(),m(h,{key:0,loading:y.value,onClick:()=>G(t.code),color:"secondary",title:"Stamp & Signature",density:"compact",class:"mx-2"},{default:u(()=>[V("Inbound & Outbound")]),_:2},1032,["loading","onClick"])):f("",!0),i(o).user.role=="superadmin"||(R=i(o).capabilities)!=null&&R.includes("edit")?(r(),m(h,{key:1,loading:y.value,onClick:()=>Z(t),icon:i(fe),title:"Edit",density:"compact",class:"mx-2"},null,8,["loading","onClick","icon"])):f("",!0),t.status=="active"&&(i(o).user.role=="superadmin"||(q=i(o).capabilities)!=null&&q.includes("delete"))?(r(),m(h,{key:2,density:"compact",loading:y.value,icon:i(ge),onClick:()=>P(t.id,"disabled"),title:"Disable",class:"mx-2 text-error"},null,8,["loading","icon","onClick"])):f("",!0),t.status=="disabled"&&(i(o).user.role=="superadmin"||(F=i(o).capabilities)!=null&&F.includes("delete"))?(r(),m(h,{key:3,loading:y.value,density:"compact",onClick:()=>P(t.id,"active"),icon:i(ye),title:"Enable",class:"mx-2 text-success"},null,8,["loading","onClick","icon"])):f("",!0)])])])}),128))])]}),_:1}),d.value.data.length==0?(r(),m(xe,{key:0,class:"pa-3 text-center w-100"},{default:u(()=>[V("No records found")]),_:1})):f("",!0)]),_:1},8,["loading"]),D.value>1?(r(),m(ke,{key:0,modelValue:p.value,"onUpdate:modelValue":a[8]||(a[8]=c=>p.value=c),class:"my-4",length:D.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:d.value.loading},null,8,["modelValue","length","disabled"])):f("",!0)])]),_:1}),s(Ve,{"free-form":Y.value,"add-new-dialog":C.value,title:"Location","data-object":k.value,onCancelled:W,onSave:X,"is-view":!1},null,8,["free-form","add-new-dialog","data-object"]),s(we,{options:_.value},null,8,["options"])]),_:1}))}};export{qe as default};
