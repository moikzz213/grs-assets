import{r as s,o as V,c as A,w as t,d as e,j as b,X as Z,k as D,f as B,J as L,Z as H,_ as ee,e as h,R as ae,a as G,p as K,V as le,b as n,t as j,i as te,y as se,Y as ie,h as oe,z as P,ae as ne,n as $,G as ue,u as de,I as ce,m as re,s as R,a7 as U,al as N,ad as q,E as O,q as pe,F as ve}from"./app-8d9b4998.js";import{_ as me}from"./ApppageHeader-1adb27dc.js";import{_ as fe,a as ge,b as _e}from"./ChangePassword-6a096537.js";import{_ as ye}from"./AppSnackBar-352cc345.js";import"./index.esm-2b149d99.js";const be={__name:"Capability",props:["item"],emits:["saved"],setup(E,{emit:k}){const x=E,u=s(!1),d=s(x.item.capabilities),o=s(x.item.capabilities),y=s(["add","edit","delete"]),S=async()=>{u.value=!1,k("saved",{id:x.item.id,capabilities:d.value})},m=()=>{u.value=!1,d.value=o.value};return(p,f)=>(V(),A(ae,{width:"500",persistent:"",modelValue:u.value,"onUpdate:modelValue":f[1]||(f[1]=c=>u.value=c)},{activator:t(({props:c})=>[e(b,Z(c,{text:"Capability",size:"small",color:"primary"}),null,16)]),default:t(({isActive:c})=>[e(D,{title:"Capabilities"},{default:t(()=>[e(B,null,{default:t(()=>[e(L,{variant:"outlined",density:"compact","hide-details":"",multiple:"","item-title":"name","item-value":"name",label:"- Select -",modelValue:d.value,"onUpdate:modelValue":f[0]||(f[0]=g=>d.value=g),items:y.value},null,8,["modelValue","items"])]),_:1}),e(H,null,{default:t(()=>[e(ee),e(b,{size:"small",text:"cancel",onClick:m}),e(b,{size:"small",color:"secondary",onClick:S},{default:t(()=>[h("Confirm")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},he=n("div",{class:"text-caption"},"TRANSFER ASSET / REQUEST ASSET",-1),Se={class:"text-caption mt-4 text-capitalize"},Ve={class:"d-flex align-center"},xe=n("div",{class:"text-caption mt-2"}," Note: Be sure that the employee has been added in Approval Setup. ",-1),Ce={__name:"ApprovalTransfer",props:["user"],setup(E){const k=E,x=G(),u=s(""),d=s(!1),o=s(!1),y=s(""),S=s({}),m=s(""),p=s(null),f=s([{label:"All",value:"all"},{label:"Change Receiver only",value:"receiver"},{label:"Change Transport only",value:"transport"},{label:"Change Releasing only",value:"releasing"}]),c=()=>{o.value=!0},g=s(!1),w=async()=>{o.value=!1,g.value=!1,d.value=!0,u.value=u.value.trim(),await $(x.token).get("/api/admin/add-new/profile-by/ecode/"+u.value).then(_=>{var v;m.value="text-error",y.value="Employee Not Found.",(v=_==null?void 0:_.data)!=null&&v.id&&(m.value="text-info",S.value=_.data,y.value="Employee: "+_.data.display_name,g.value=!0),d.value=!1}).catch(_=>{d.value=!1})},C=async()=>{var v;d.value=!0,m.value="text-info";let _={from:(v=k.user)==null?void 0:v.id,to:S.value.id,type:p.value};await $(x.token).post("/api/user-transfer/approval",_).then(r=>{r.data.data?(m.value="text-success",y.value="Success: Pending approvals has been transfered to "+S.value.display_name):y.value="Info: No pending approvals for this employee.",o.value=!1,d.value=!1}).catch(r=>{d.value=!1,m.value="text-error",y.value="Error: Transfer has been failed!",o.value=!0})};return(_,v)=>(V(),K("div",null,[e(D,{loading:d.value},{default:t(()=>[e(le,{class:"text-primary text-capitalize mb-3"},{default:t(()=>[h(" APPROVAL TRANSFER "),he,n("div",Se,"FROM: "+j(k.user.display_name),1)]),_:1}),e(B,{class:"pb-6"},{default:t(()=>[e(te,{label:"Search Employee Code",modelValue:u.value,"onUpdate:modelValue":v[0]||(v[0]=r=>u.value=r),"item-value":"id","item-title":"title",variant:"outlined","append-inner-icon":se(ie),"hide-details":"",density:"compact",class:"mb-2","onClick:appendInner":w,onKeydown:oe(w,["enter"])},null,8,["modelValue","append-inner-icon","onKeydown"]),g.value?(V(),A(L,{key:0,label:"Select Approval Type",modelValue:p.value,"onUpdate:modelValue":[v[1]||(v[1]=r=>p.value=r),c],items:f.value,"item-value":"value","item-title":"label",variant:"outlined","hide-details":"",density:"compact",class:"my-4"},null,8,["modelValue","items"])):P("",!0),n("div",{class:ne(`${m.value} my-5`)},j(y.value),3),n("div",Ve,[e(b,{disabled:!o.value,loading:d.value,color:"primary",onClick:C},{default:t(()=>[h(" Transfer approval confirmation")]),_:1},8,["disabled","loading"])]),xe]),_:1})]),_:1},8,["loading"])]))}},ke={class:"v-col-12"},Ae={class:"v-col-12"},we={class:"d-flex flex-wrap"},Te={class:"v-col-12 v-col-md-5"},Re={class:"v-col-12"},$e={class:"v-col-12 v-col-md-4"},Ee={class:"v-col-12 v-col-md-12 d-flex"},Fe={class:"v-col-12 v-col-md-12 py-0 d-flex"},ze={class:"my-auto"},Ue={key:0,class:"v-col-12 v-col-md-3"},Ne=n("div",{class:"v-col-12 v-col-md-12"},[h(" Capabilities "),n("br"),n("small",{class:"text-error"},"Warning: it will override the capabilities of all page."),n("br"),n("small",{class:"text-error"},"Select only here if all pages have same capabilities")],-1),Pe={class:"v-col-12 v-col-md-12 my-auto"},Me={__name:"EditUser",setup(E){var M,J;const k=ue(),x=de(),u=G(),d=s(!0),o=s({loading:!1,data:{}}),y=()=>{x.back()},S=async()=>{d.value=!0,await $(u.token).get("/api/admin/user/single/"+k.params.id).then(a=>{o.value.data=a.data,d.value=!1}).catch(a=>{o.value.loading=!1,d.value=!1})},m=a=>{S().then(()=>{I.value={status:!0,type:"success",text:a}})};ce(()=>{S().then(()=>{w()})});const p=s("profile"),f=async a=>{p.value=a},c=s([]),g=s(!1),w=()=>{$(u.token).get("/api/fetch/pages-slug").then(a=>{var i;c.value=a.data,((i=o.value.data)==null?void 0:i.access.length)>0&&o.value.data.access.map((l,F)=>{c.value.map((z,De)=>{l.slug==z.slug&&(z.isSelected=l.slug,z.capabilities=l.capabilities?JSON.parse(l.capabilities):[],r.value.push(l.slug),C.value=!0)})})}).catch(a=>{})},C=s(!1),_=()=>{c.value.map((a,i)=>(a.capabilities||(a.capabilities=[]),g.value?(a.isSelected=a.slug,r.value.push(a.slug),C.value=!0):(a.isSelected="",r.value=[],C.value=!1),a))},v=s(!1),r=s([]),Q=a=>{a.isSelected?(r.value.splice(r.value.findIndex(l=>l===a.isSelected),1),a.isSelected="",a.capabilities=""):(!a.isSelected||a.isSelected==null||a.isSelected=="")&&(r.value.push(a.slug),a.isSelected=a.slug),C.value=!0,c.value.filter((l,F)=>!l.isSelected).length>0?g.value=!1:g.value=!0},T=s([]),W=s(["add","edit","delete"]),I=s({status:!0,type:"info",text:null}),X=a=>{c.value.map((i,l)=>{i.id==a.id&&(i.capabilities=a.capabilities)})};s((J=(M=u==null?void 0:u.user)==null?void 0:M.profile)==null?void 0:J.id);const Y=()=>{v.value=!0,T.value.length>0&&c.value.map((l,F)=>{l.isSelected?l.capabilities=T.value:l.capabilities=[]});let a=c.value.filter(l=>l.isSelected),i={profileID:k.params.id,data:a,profile_id:u.user.profile.id};$(u.token).post("/api/store-page/settings-capabilities/profile",i).then(l=>{r.value=[],T.value=[],I.value={status:!0,type:"success",text:l.data.message},v.value=!1,S().then(()=>{w()})})};return(a,i)=>(V(),A(re,null,{default:t(()=>[e(me,{title:"Edit User"}),e(R,{class:"mb-3",disabled:d.value},{default:t(()=>[n("div",ke,[e(b,{color:"primary",class:"mr-4",loading:a.loadingAsset,onClick:y},{default:t(()=>[h("Back")]),_:1},8,["loading"])]),n("div",Ae,[n("div",we,[e(b,{color:`${p.value=="profile"?"primary":"white"} `,size:"large",class:"mr-3 my-1",loading:o.value.loading,onClick:i[0]||(i[0]=()=>f("profile"))},{default:t(()=>[h("profile")]),_:1},8,["color","loading"]),e(b,{color:`${p.value=="account"?"primary":"white"} `,size:"large",class:"mr-3 my-1",loading:o.value.loading,onClick:i[1]||(i[1]=()=>f("account"))},{default:t(()=>[h("Account")]),_:1},8,["color","loading"]),e(b,{color:`${p.value=="change_password"?"primary":"white"} `,size:"large",class:"mr-3 my-1",loading:o.value.loading,onClick:i[2]||(i[2]=()=>f("change_password"))},{default:t(()=>[h("Change Password")]),_:1},8,["color","loading"]),e(b,{color:`${p.value=="approval_transfer"?"primary":"white"} `,size:"large",class:"mr-3 my-1",loading:o.value.loading,onClick:i[3]||(i[3]=()=>f("approval_transfer"))},{default:t(()=>[h("APPROVAL TRANSFER")]),_:1},8,["color","loading"])])]),n("div",Te,[e(R,null,{default:t(()=>[n("div",Re,[U(e(fe,{user:o.value.data,onSaved:m},null,8,["user"]),[[N,p.value=="account"]]),U(e(ge,{user:o.value.data,onSaved:m},null,8,["user"]),[[N,p.value=="profile"]]),U(e(_e,{user:o.value.data},null,8,["user"]),[[N,p.value=="change_password"]]),U(e(Ce,{user:o.value.data},null,8,["user"]),[[N,p.value=="approval_transfer"]])])]),_:1})]),n("div",$e,[e(D,null,{default:t(()=>[e(B,null,{default:t(()=>[e(R,null,{default:t(()=>[n("div",Ee,[e(q,{modelValue:g.value,"onUpdate:modelValue":[i[4]||(i[4]=l=>g.value=l),_],"hide-details":"",variant:"outlined",density:"compact",label:" Access / View Pages"},null,8,["modelValue"]),C.value?(V(),A(b,{key:0,class:"ml-5",size:"small",loading:v.value,color:"secondary",onClick:Y},{default:t(()=>[h("Save")]),_:1},8,["loading"])):P("",!0)])]),_:1}),e(O,{class:"mb-3"}),(V(!0),K(ve,null,pe(c.value,(l,F)=>(V(),A(R,{key:l.id},{default:t(()=>[n("div",Fe,[e(q,{"model-value":r.value.includes(l.slug),"hide-details":"",variant:"outlined","onUpdate:modelValue":z=>Q(l,F),label:l.title,density:"compact"},null,8,["model-value","onUpdate:modelValue","label"]),n("div",ze,[l.isSelected?(V(),A(be,{key:0,item:l,onSaved:X},null,8,["item"])):P("",!0)])]),e(O)]),_:2},1024))),128))]),_:1})]),_:1})]),C.value?(V(),K("div",Ue,[e(D,null,{default:t(()=>[e(B,null,{default:t(()=>[e(R,null,{default:t(()=>[Ne,e(O),n("div",Pe,[e(L,{variant:"outlined",density:"compact","hide-details":"",multiple:"",label:"- Select -",modelValue:T.value,"onUpdate:modelValue":i[5]||(i[5]=l=>T.value=l),items:W.value},null,8,["modelValue","items"])])]),_:1})]),_:1})]),_:1})])):P("",!0)]),_:1},8,["disabled"]),e(ye,{options:I.value},null,8,["options"])]),_:1}))}};export{Me as default};
