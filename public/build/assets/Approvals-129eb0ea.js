import{I as be,r as _,c as V,w as n,m as ke,o as d,s as b,b as e,d as l,e as p,j as X,y as x,t as m,E as c,H as P,af as Z,p as y,q as ce,D as k,ah as Ee,k as L,Y as qe,Z as Ce,W as Re,X as ie,ax as we,i as j,as as F,_ as ee,ay as ae,az as le,aA as ne,aB as ue,F as ve,aC as Ae,ae as K,f as Oe,a2 as Te,a3 as pe}from"./app-a19604b7.js";import{u as te}from"./formatDate-b9aad8c5.js";import{_ as Ie}from"./AppSnackBar-8dfc9944.js";const Ue={class:"v-col-3 mt-auto font-weight-bold"},je={class:"d-flex"},Se=e("div",{class:"mr-2"},"FROM:",-1),Be={class:"d-flex"},Ne=e("div",{class:"mr-6 pr-2"},"TO:",-1),Pe={class:"v-col-6 text-center"},De=e("img",{src:"/assets/images/grandiose-logo.jpg",style:{"max-height":"100px"}},null,-1),$e=e("br",null,null,-1),Le={class:"v-col-3 mt-auto font-weight-bold text-right"},Fe=e("br",null,null,-1),ze=e("div",{class:"v-col-12 v-col-md-1 py-1"},"IMAGE",-1),Ke=e("div",{class:"v-col-12 v-col-md-2 py-1"},"ITEM DESCRIPTION",-1),He=e("div",{class:"v-col-12 v-col-md-1 py-1"},"ASSET NO",-1),Me=e("div",{class:"v-col-12 v-col-md-1 py-1"},"QTY",-1),Ye=e("div",{class:"v-col-12 v-col-md-1 py-1"},"WEIGHT",-1),Ge=e("div",{class:"v-col-12 v-col-md-1 py-1"},"ITEM VALUE",-1),Je=e("div",{class:"v-col-12 v-col-md-1 py-1"},"COUNTRY OF ORIGIN",-1),Qe=e("div",{class:"v-col-12 v-col-md-2 py-1"},[p(" REMARKS"),e("br"),p("REASON FOR REQUEST ")],-1),We={class:"v-col-12 v-col-md-2 py-1 d-flex justify-space-between"},Xe={class:"v-col-12 v-col-md-3 py-1 d-flex"},Ze={key:0},ea={style:{height:"680px",width:"100%"},class:"d-flex align-center justify-center"},aa={class:"v-col-12 v-col-md-1 py-1"},la={class:"v-col-12 v-col-md-1 py-1"},ta={class:"v-col-12 v-col-md-1 py-1"},sa={class:"v-col-12 v-col-md-1 py-1"},oa={class:"v-col-12 v-col-md-1 py-1"},da={class:"v-col-12 v-col-md-2 py-1"},ra={key:0,class:"v-col-12 v-col-md-2 py-1 d-flex justify-space-between"},ca={key:1,class:"v-col-12 v-col-md-2 py-1 d-flex justify-space-between"},ia={key:0},na={key:2,class:"v-col-12 v-col-md-2 py-1 d-flex justify-space-between"},ua={key:0},va={key:1},pa=e("div",{class:"v-col-12 text-center font-weight-bold text-info"},[p(" YOU CAN UPDATE SOME DATA AND"),e("br"),p(" PLEASE TICK CHECKBOX IF ASSET IS AVAILABLE BEFORE CLICKING THE APPROVE BUTTON ")],-1),_a={key:0,class:"ml-5 d-flex"},ya=e("div",{class:"px-2 mr-5"},"|",-1),fa={key:1,class:"ml-6"},ma={class:"v-col-12 px-0 my-0"},ha={class:"v-col-12 v-col-md-3 pa-0 mb-4"},ga=e("div",{class:"text-center mx-2 py-4 font-weight-bold",style:{color:"rgb(3, 167, 3)",border:"1px solid #ccc","font-size":"17px"}}," APPROVED ",-1),xa=e("div",{class:"text-center py-1 font-weight-bold"}," Requested By ",-1),Va={class:"text-center py-1"},ba={class:"text-center py-1"},ka={class:"text-center"},Ea={key:0},qa={key:0,class:"d-flex"},Ca=["onClick"],Ra=["onClick"],wa={key:1},Aa=["onClick"],Oa=["onClick"],Ta={class:"text-center py-1"},Ia={class:"text-center py-1"},Ua={class:"text-center"},ja={key:2,class:"v-col-12",style:{border:"1px solid red"}},Sa={class:"v-col-12 text-center"},Ba=e("div",{class:"v-col-12 text-center mt-3 font-weight-bold"}," REASON FOR REJECTION ",-1),Na={class:"v-col-12"},Fa={__name:"Approvals",setup(Pa){const s=be(),se=_(!0),o=_({}),H=_({}),h=_(!1),M=_(!1),Y=_(!1),C=_(!1),B=_([]),D=_(!1),N=_(""),G=_(!1),oe=async()=>{let r={id:s.query.id,profile_id:s.query.pid,order:s.query.o};if(!s.query.id||!s.query.pv){se.value=!1;return}await axios.post("/api/pv/fetch/request-assets/data",r).then(i=>{var g,R,w,f,E;if(o.value=i.data,!o.value.access){se.value=!1;return}((w=(R=(g=o.value)==null?void 0:g.data)==null?void 0:R.request_approvals)==null?void 0:w.length)>0&&(h.value=o.value.data.request_approvals.filter(u=>{var a;return u.profile_id==s.query.pid&&u.orders==s.query.o&&u.status=="awaiting-approval"&&((a=u.profile)==null?void 0:a.role)=="asset-supervisor"})[0],M.value=o.value.data.request_approvals.filter(u=>u.profile_id==s.query.pid&&u.orders==s.query.o&&u.status=="awaiting-approval"&&u.approval_type=="releasing")[0],Y.value=o.value.data.request_approvals.filter(u=>{var a;return u.profile_id==s.query.pid&&u.orders==s.query.o&&u.status=="awaiting-approval"&&((a=u.profile)==null?void 0:a.role)=="commercial-manager"})[0],C.value=o.value.data.request_approvals.filter(u=>u.profile_id==s.query.pid&&u.orders==s.query.o&&u.status=="awaiting-approval"&&u.approval_type=="receiver")[0],W.value=o.value.data.request_approvals[o.value.data.request_approvals.length-1].approval_type,(C.value||h.value)&&(G.value=!0)),B.value=(E=(f=o.value)==null?void 0:f.data)==null?void 0:E.items}).catch(i=>{console.log(i.response.data)})},_e=()=>{window.print()},ye=_(window.location.origin),J=_(!1),Q=_(1),fe=r=>{Q.value=r,J.value=!0},W=_(""),de=_({}),me=r=>{D.value=!0,de.value=r},he=()=>{D.value=!1,N.value=""},z=(r,i=null)=>{if(D.value=!1,(r.status=="awaiting-approval"||r.status=="reject")&&s.query.pid==r.profile_id&&s.query.o==r.orders){H.value={status:!0,type:"info",text:"Please wait..."};let g=[];(h.value||Y.value||C.value||M.value)&&(g=B.value.map((f,E)=>(delete f.created_at,delete f.assets,delete f.updated_at,delete f.attachment,f)));let R={},w="";N.value&&i&&(w=N.value),R={profile_id:s.query.pid,id:s.query.id,order:s.query.o,type:o.value.data.types,assets:g,is_reject:w,requestor_id:o.value.data.profile_id},axios.post("/api/pv/store/request-asset/approve-data",R).then(f=>{let E="success";f.data.success||(E="error"),H.value={status:!0,type:E,text:f.data.message},G.value=!1,setTimeout(()=>{oe()},500)}).catch(f=>{console.log(f.response.data)});return}},ge=r=>{if(r=="approve")return"Approved";if(r=="reviewer")return"Reviewed";if(r=="receiver")return"Received";if(r=="transport")return"Transport Arranged";if(r=="releasing")return"Released";if(r=="verify")return"Verified"},xe=()=>{let r=C.value;B.value.map(i=>{r?i.is_received=$.value:i.is_available=$.value})},Ve=(r,i=6)=>{let g="00000"+r;return g.substring(g.length-i)},re=()=>{let r=!0,i=C.value;B.value.map(g=>{i?g.is_received||(r=!1):g.is_available||(r=!1)}),$.value=r},$=_(!1);return oe(),(r,i)=>(d(),V(ke,{style:{"max-width":"90%"},class:"mt-0 pt-0"},{default:n(()=>{var g,R,w,f,E,u;return[((g=B.value)==null?void 0:g.length)>0?(d(),V(b,{key:0,class:"mt-0 pt-0 no-print mt-2"},{default:n(()=>[e("div",null,[l(X,{color:"primary",size:"small",onClick:_e},{default:n(()=>[p("Print")]),_:1})])]),_:1})):x("",!0),l(b,{class:"mt-0 pt-0"},{default:n(()=>{var a,S,A,O,T,t,I,U,q;return[e("div",Ue,[e("div",je,[Se,e("div",null,m((S=(a=o.value.data)==null?void 0:a.transfer_from)==null?void 0:S.title),1)]),e("div",Be,[Ne,e("div",null,m((O=(A=o.value.data)==null?void 0:A.transfer_to)==null?void 0:O.title),1)])]),e("div",Pe,[De,$e,e("strong",null,m((t=(T=o.value.data)==null?void 0:T.setup)==null?void 0:t.title),1)]),e("div",Le,[p(" SN-"+m(((U=(I=o.value)==null?void 0:I.data)==null?void 0:U.types)=="request"?"5":"3")+m(Ve(1)),1),Fe,p(" "+m(c(te)((q=o.value.data)==null?void 0:q.created_at)),1)])]}),_:1}),l(P,{class:"my-5"}),l(b,null,{default:n(()=>[ze,Ke,He,Me,Ye,Ge,Je,Qe,e("div",We,[p(" REMARKS "),h.value||C.value?(d(),V(Z,{key:0,modelValue:$.value,"onUpdate:modelValue":[i[0]||(i[0]=a=>$.value=a),xe],class:"pa-0 ma-0 v-col-1","hide-details":"",variant:"underlined",density:"compact"},null,8,["modelValue"])):x("",!0)])]),_:1}),(d(!0),y(ve,null,ce(B.value,(a,S)=>(d(),V(b,{class:"mt-1 approval-form-pr",key:a.id},{default:n(()=>{var A,O,T,t,I,U,q;return[e("div",Xe,[(A=a.attachment)!=null&&A.id?(d(),y("div",Ze,[l(L,{onClick:()=>fe(S),maxHeight:"40",variant:"text",class:"ma-2"},{default:n(()=>[l(k,{size:"large",icon:c(Ee),color:"success"},null,8,["icon"])]),_:2},1032,["onClick"]),l(ie,{modelValue:J.value,"onUpdate:modelValue":i[2]||(i[2]=v=>J.value=v),width:"95%","max-width":"900"},{default:n(()=>[l(L,{class:"bg-black"},{default:n(()=>[l(qe,{"hide-delimiter-background":"","show-arrows":"hover",height:"680px",modelValue:Q.value,"onUpdate:modelValue":i[1]||(i[1]=v=>Q.value=v)},{default:n(()=>[l(Ce,{"reverse-transition":"fade",transition:"fade"},{default:n(()=>[e("div",ea,[l(Re,{src:ye.value+"/file/"+a.attachment.path},null,8,["src"])])]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1024)]),_:2},1032,["modelValue"])])):(d(),V(L,{key:1,maxHeight:"40",variant:"text",class:"ma-2"},{default:n(()=>[l(k,{size:"large",icon:c(we)},null,8,["icon"])]),_:1})),l(j,{value:a.item_description,variant:"underlined",density:"compact","hide-details":"",class:"bg-light-gray",readonly:!0},null,8,["value"])]),e("div",aa,[l(j,{modelValue:a.asset_code,"onUpdate:modelValue":v=>a.asset_code=v,variant:"underlined",density:"compact","hide-details":"",readonly:!h.value,class:F(`${h.value?"":"bg-light-gray"}`)},null,8,["modelValue","onUpdate:modelValue","readonly","class"])]),e("div",la,[l(j,{value:a.qty,variant:"underlined",density:"compact","hide-details":"",class:"bg-light-gray",type:"number",readonly:!0},null,8,["value"])]),e("div",ta,[l(j,{modelValue:a.weight,"onUpdate:modelValue":v=>a.weight=v,variant:"underlined",density:"compact","hide-details":"",readonly:!h.value,class:F(`${h.value?"":"bg-light-gray"}`)},null,8,["modelValue","onUpdate:modelValue","readonly","class"])]),e("div",sa,[l(j,{modelValue:a.item_value,"onUpdate:modelValue":v=>a.item_value=v,variant:"underlined",density:"compact","hide-details":"",readonly:!h.value,class:F(`${h.value?"":"bg-light-gray"}`)},null,8,["modelValue","onUpdate:modelValue","readonly","class"])]),e("div",oa,[l(j,{modelValue:a.country_of_origin,"onUpdate:modelValue":v=>a.country_of_origin=v,variant:"underlined",density:"compact","hide-details":"",readonly:!h.value,class:F(`${h.value?"":"bg-light-gray"}`)},null,8,["modelValue","onUpdate:modelValue","readonly","class"])]),e("div",da,[l(j,{value:a.reason_for_request,variant:"underlined",density:"compact","hide-details":"",class:"bg-light-gray",readonly:!0},null,8,["value"])]),h.value||Y.value||M.value?(d(),y("div",ra,[l(ee,{modelValue:a.remarks,"onUpdate:modelValue":v=>a.remarks=v,variant:"underlined",density:"compact","hide-details":"",class:"text-remarks",rows:"2"},null,8,["modelValue","onUpdate:modelValue"]),h.value?(d(),V(Z,{key:0,modelValue:a.is_available,"onUpdate:modelValue":[v=>a.is_available=v,re],class:"pa-0 ma-0 v-col-1","hide-details":"",variant:"underlined",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])):x("",!0)])):C.value?(d(),y("div",ca,[l(ee,{modelValue:a.remarks,"onUpdate:modelValue":v=>a.remarks=v,variant:"underlined",density:"compact","hide-details":"",class:"text-remarks",rows:"2"},null,8,["modelValue","onUpdate:modelValue"]),(T=(O=o.value)==null?void 0:O.data)!=null&&T.is_available?(d(),y("div",ia,[l(k,{class:"mt-3",icon:a.is_available?c(ae):c(le),color:`${a.is_available?"success":"error"}`},null,8,["icon","color"])])):x("",!0),l(Z,{modelValue:a.is_received,"onUpdate:modelValue":[v=>a.is_received=v,re],class:"pa-0 ma-0 v-col-1","hide-details":"",variant:"underlined",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])])):(d(),y("div",na,[l(j,{value:a.remarks,variant:"underlined",density:"compact","hide-details":"",class:"bg-light-gray",readonly:!0},null,8,["value"]),(I=(t=o.value)==null?void 0:t.data)!=null&&I.is_available?(d(),y("div",ua,[l(k,{class:"mt-3",icon:a.is_available?c(ae):c(le),color:`${a.is_available?"success":"error"}`},null,8,["icon","color"])])):x("",!0),((q=(U=o.value)==null?void 0:U.data)==null?void 0:q.status)=="complete"&&W.value=="receiver"?(d(),y("div",va,[l(k,{class:"mt-3",icon:a.is_received?c(ne):c(ue),color:`${a.is_received?"success":"error"}`},null,8,["icon","color"])])):x("",!0)]))]}),_:2},1024))),128)),h.value?(d(),V(b,{key:1,class:"mt-3"},{default:n(()=>[pa]),_:1})):x("",!0),(w=(R=o.value)==null?void 0:R.data)!=null&&w.is_available?(d(),V(b,{key:2,class:"mt-6 mb-2"},{default:n(()=>[l(L,{loading:G.value,variant:"text",class:"v-col-12 text-center pt-2 font-weight-bold pb-0 d-flex justify-center"},{default:n(()=>{var a;return[e("div",null,[l(k,{icon:c(ae),color:"success"},null,8,["icon"]),p(" AVAILABLE "),l(k,{icon:c(le),color:"error",class:"ml-5"},null,8,["icon"]),p(" NOT AVAILABLE ")]),C.value?(d(),y("div",_a,[ya,l(k,{icon:c(Ae)},null,8,["icon"]),p(" TICK RECEIVED ASSETS ")])):x("",!0),((a=o.value.data)==null?void 0:a.status)=="complete"&&W.value=="receiver"?(d(),y("div",fa,[l(k,{icon:c(ne),color:"success"},null,8,["icon"]),p(" RECEIVED "),l(k,{icon:c(ue),color:"error",class:"ml-5"},null,8,["icon"]),p(" NOT RECEIVE ")])):x("",!0)]}),_:1},8,["loading"])]),_:1})):x("",!0),l(b,{class:"mt-3"},{default:n(()=>[e("div",ma,[l(P),l(P)])]),_:1}),((f=o.value.data)==null?void 0:f.request_approvals.length)>0?(d(),V(b,{key:3},{default:n(()=>{var a,S,A,O,T;return[e("div",ha,[ga,xa,e("div",Va,m((S=(a=o.value.data)==null?void 0:a.profile)==null?void 0:S.display_name),1),e("div",ba,m((O=(A=o.value.data)==null?void 0:A.profile)==null?void 0:O.designation),1),e("div",ka,m(c(te)((T=o.value.data)==null?void 0:T.created_at)),1)]),(d(!0),y(ve,null,ce(o.value.data.request_approvals,t=>{var I,U;return d(),y("div",{class:"v-col-12 v-col-md-3 pa-0 mb-4",key:t.id},[t.profile.role=="commercial-manager"&&c(s).query.pid==t.profile_id&&c(s).query.o==t.orders?(d(),y("div",Ea,[t.status=="awaiting-approval"?(d(),y("div",qa,[e("div",{onClick:q=>me(t),class:"cursor-pointer text-center py-5 v-col-6",style:K(`border:1px solid #ccc; ${c(s).query.pid==t.profile_id&&c(s).query.o==t.orders?"background-color: rgb(182, 3, 3);color:#fff;":"background-color: none;"}`)}," REJECT ",12,Ca),e("div",{onClick:q=>z(t,"reject"),class:"cursor-pointer text-center py-5 v-col-6",style:K(`border:1px solid #ccc; ${c(s).query.pid==t.profile_id&&c(s).query.o==t.orders?"background-color: rgb(3, 167, 3);color:#fff;":"background-color: none"}`)}," APPROVE ",12,Ra)])):t.status=="reject"||t.status=="done"||t.status=="pending"?(d(),y("div",wa,[e("div",{onClick:q=>z(t),class:"cursor-pointer text-center mx-2 py-5",style:K(`border:1px solid #ccc; ${t.status=="reject"&&c(s).query.pid==t.profile_id&&c(s).query.o==t.orders?"background-color: rgb(182, 3, 3);color:#fff;":t.status=="done"?"background-color: none;color:rgb(3, 167, 3); font-weight:bold;font-size:17px;padding-top:16px !important;padding-bottom:16px !important;":"background-color: gray; color:#fff;"}`)},m(t.status=="done"?"APPROVED":"CLICK TO APPROVE"),13,Aa)])):x("",!0)])):(d(),y("div",{key:1,onClick:q=>z(t),class:"cursor-pointer text-center mx-2 py-5",style:K(`border:1px solid #ccc; ${t.status=="awaiting-approval"&&c(s).query.pid==t.profile_id&&c(s).query.o==t.orders?"background-color: rgb(182, 3, 3);color:#fff;":t.status=="done"?"background-color: none;color:rgb(3, 167, 3); font-weight:bold;font-size:17px;padding-top:16px !important;padding-bottom:16px !important;":"background-color: gray; color:#fff;"}`)},m(t.status=="done"?"APPROVED":"CLICK TO APPROVE"),13,Oa)),e("div",{class:F(`text-center py-1 font-weight-bold ${t.status=="reject"?"text-error text-uppercase":""}`)},m(t.status=="reject"?"Rejected":ge(t.approval_type))+" By ",3),e("div",Ta,m((I=t.profile)==null?void 0:I.display_name),1),e("div",Ia,m((U=t.profile)==null?void 0:U.designation),1),e("div",Ua,m(t.date_approved?c(te)(t.date_approved):""),1),t.reason_rejected?(d(),y("div",ja,[p(" Reason "),l(P,{class:"my-2"}),p(" "+m(t.reason_rejected),1)])):x("",!0)])}),128))]}),_:1})):x("",!0),((u=(E=o.value)==null?void 0:E.data)==null?void 0:u.status)!=="complete"?(d(),V(b,{key:4,class:"no-print"},{default:n(()=>[e("div",Sa,[l(P),p(" You will receive a notification once you click the button. "),l(P)])]),_:1})):x("",!0),l(ie,{width:"500",modelValue:D.value,"onUpdate:modelValue":i[5]||(i[5]=a=>D.value=a),persistent:""},{default:n(()=>[l(L,null,{default:n(()=>[l(Oe,null,{default:n(()=>[l(b,null,{default:n(()=>[Ba,e("div",Na,[l(ee,{modelValue:N.value,"onUpdate:modelValue":i[3]||(i[3]=a=>N.value=a),label:"STATE YOUR REASON HERE",variant:"outlined"},null,8,["modelValue"])])]),_:1})]),_:1}),l(Te,null,{default:n(()=>[l(pe),l(X,{onClick:he},{default:n(()=>[p("Cancel")]),_:1}),l(X,{color:"success",disabled:!N.value,onClick:i[4]||(i[4]=a=>z(de.value,"reject"))},{default:n(()=>[p("Confirm")]),_:1},8,["disabled"]),l(pe)]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Ie,{options:H.value},null,8,["options"])]}),_:1}))}};export{Fa as default};
