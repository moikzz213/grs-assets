import{L as ue,r as g,j as U,k as u,C as ve,b as r,l as s,e as a,t as p,m as v,G as c,D as k,J as S,ab as M,I as b,c as _,d as X,y as V,a0 as B,at as z,au as G,E as w,av as Z,aw as ee,F as ae,ax as pe,A as le,n as L,q as _e,$ as ye,a3 as fe,P as se,z as te,_ as me}from"./app-e956ae53.js";import{u as Y}from"./formatDate-e2fbee14.js";import{_ as he}from"./AppSnackBar-99cf2772.js";const ge={class:"v-col-3 mt-auto font-weight-bold"},be={class:"d-flex"},Ve=a("div",{class:"mr-2"},"FROM:",-1),xe={class:"d-flex"},ke=a("div",{class:"mr-6"},"TO:Â ",-1),Ee={class:"v-col-6 text-center"},Re=a("img",{src:"/assets/images/grandiose-logo.jpg",style:{"max-height":"100px"}},null,-1),Ce=a("br",null,null,-1),qe={class:"v-col-3 mt-auto font-weight-bold text-right"},Ae=a("br",null,null,-1),Oe=a("div",{class:"v-col-12 v-col-md-1 py-1"},"IMAGE",-1),Te=a("div",{class:"v-col-12 v-col-md-2 py-1"},"ITEM DESCRIPTION",-1),we=a("div",{class:"v-col-12 v-col-md-1 py-1"},"ASSET NO",-1),Ue=a("div",{class:"v-col-12 v-col-md-1 py-1"},"QTY",-1),je=a("div",{class:"v-col-12 v-col-md-1 py-1"},"WEIGHT",-1),Ie=a("div",{class:"v-col-12 v-col-md-1 py-1"},"ITEM VALUE",-1),Se=a("div",{class:"v-col-12 v-col-md-1 py-1"},"COUNTRY OF ORIGIN",-1),Ne=a("div",{class:"v-col-12 v-col-md-2 py-1"},[v(" REMARKS"),a("br"),v("REASON FOR REQUEST ")],-1),Pe={class:"v-col-12 v-col-md-2 py-1 d-flex justify-space-between"},$e=a("div",{class:"v-col-12 v-col-md-1 py-1"},null,-1),Be={class:"v-col-12 v-col-md-2 py-1"},De={class:"v-col-12 v-col-md-1 py-1"},Le={class:"v-col-12 v-col-md-1 py-1"},Fe={class:"v-col-12 v-col-md-1 py-1"},Ke={class:"v-col-12 v-col-md-1 py-1"},Me={class:"v-col-12 v-col-md-1 py-1"},ze={class:"v-col-12 v-col-md-2 py-1"},Ge={key:0,class:"v-col-12 v-col-md-2 py-1 d-flex justify-space-between"},Ye={key:1,class:"v-col-12 v-col-md-2 py-1 d-flex justify-space-between"},He={key:0},Je={key:2,class:"v-col-12 v-col-md-2 py-1 d-flex justify-space-between"},Qe={key:0},We={key:1},Xe=a("div",{class:"v-col-12 text-center font-weight-bold text-info"},[v(" YOU CAN UPDATE SOME DATA AND"),a("br"),v(" PLEASE TICK CHECKBOX IF ASSET IS AVAILABLE BEFORE CLICKING THE APPROVE BUTTON ")],-1),Ze={key:0,class:"ml-5 d-flex"},ea=a("div",{class:"px-2 mr-5"},"|",-1),aa={key:1,class:"ml-6"},la={class:"v-col-12 px-0 my-0"},sa={class:"v-col-12 v-col-md-3 pa-0 mb-4"},ta=a("div",{class:"text-center mx-2 py-4 font-weight-bold",style:{color:"rgb(3, 167, 3)",border:"1px solid #ccc","font-size":"17px"}}," APPROVED ",-1),oa=a("div",{class:"text-center py-1 font-weight-bold"}," Requested By ",-1),da={class:"text-center py-1"},ca={class:"text-center py-1"},ra={class:"text-center"},ia={key:0},na={key:0,class:"d-flex"},ua=["onClick"],va=["onClick"],pa={key:1},_a=["onClick"],ya=["onClick"],fa={class:"text-center py-1"},ma={class:"text-center py-1"},ha={class:"text-center"},ga={key:2,class:"v-col-12",style:{border:"1px solid red"}},ba={class:"v-col-12 text-center"},Va=a("div",{class:"v-col-12 text-center mt-3 font-weight-bold"}," REASON FOR REJECTION ",-1),xa={class:"v-col-12"},qa={__name:"Approvals",setup(ka){const t=ue(),H=g(!0),o=g({}),F=g({}),f=g(!1),oe=g(!1),E=g(!1),N=g([]),P=g(!1),j=g(""),K=g(!1),J=async()=>{let d={id:t.query.id,profile_id:t.query.pid,order:t.query.o};if(!t.query.id||!t.query.pv){H.value=!1;return}await axios.post("/api/public/fetch/request-assets/data",d).then(i=>{var m,R,C,y,x;if(o.value=i.data,!o.value.access){H.value=!1;return}((C=(R=(m=o.value)==null?void 0:m.data)==null?void 0:R.request_approvals)==null?void 0:C.length)>0&&(f.value=o.value.data.request_approvals.filter(e=>{var h;return e.profile_id==t.query.pid&&e.orders==t.query.o&&e.status=="awaiting-approval"&&((h=e.profile)==null?void 0:h.role)=="asset-supervisor"})[0],oe.value=o.value.data.request_approvals.filter(e=>{var h;return e.profile_id==t.query.pid&&e.orders==t.query.o&&e.status=="awaiting-approval"&&((h=e.profile)==null?void 0:h.role)=="commercial-manager"})[0],E.value=o.value.data.request_approvals.filter(e=>e.profile_id==t.query.pid&&e.orders==t.query.o&&e.status=="awaiting-approval"&&e.approval_type=="receiver")[0],(E.value||f.value)&&(K.value=!0)),N.value=(x=(y=o.value)==null?void 0:y.data)==null?void 0:x.items,console.log("dataObj.value",o.value)}).catch(i=>{console.log(i.response.data)})},Q=g({}),de=d=>{P.value=!0,Q.value=d},ce=()=>{P.value=!1,j.value=""},D=(d,i=null)=>{if(P.value=!1,(d.status=="awaiting-approval"||d.status=="reject")&&t.query.pid==d.profile_id&&t.query.o==d.orders){F.value={status:!0,type:"info",text:"Please wait..."};let m=[];(f.value||E.value)&&(m=N.value.map((y,x)=>(delete y.created_at,delete y.assets,delete y.updated_at,y)));let R={},C="";j.value&&i&&(C=j.value),R={profile_id:t.query.pid,id:t.query.id,order:t.query.o,type:o.value.data.types,assets:m,is_reject:C,requestor_id:o.value.data.profile_id},axios.post("/api/public/store/request-asset/approve-data",R).then(y=>{let x="success";y.data.success||(x="error"),F.value={status:!0,type:x,text:y.data.message},K.value=!1,setTimeout(()=>{J()},500)}).catch(y=>{console.log(y.response.data)});return}},re=d=>{if(d=="approve")return"Approved";if(d=="reject")return"Rejected";if(d=="verify")return"Verified";if(d=="confirm")return"Confirmed";if(d=="reviewer")return"Reviewed";if(d=="receiver")return"Received"},ie=()=>{let d=E.value;N.value.map(i=>{d?i.is_received=$.value:i.is_available=$.value})},ne=(d,i=6)=>{let m="00000"+d;return m.substring(m.length-i)},W=()=>{let d=!0,i=E.value;N.value.map(m=>{i?m.is_received||(d=!1):m.is_available||(d=!1)}),$.value=d},$=g(!1);return J(),(d,i)=>(r(),U(ve,{style:{"max-width":"1200px"},class:"mt-0 pt-0"},{default:u(()=>{var m,R,C,y,x;return[s(k,{class:"mt-0 pt-0"},{default:u(()=>{var e,h,q,A,O,l,T,n,I;return[a("div",ge,[a("div",be,[Ve,a("div",null,p((h=(e=o.value.data)==null?void 0:e.transfer_from)==null?void 0:h.title),1)]),a("div",xe,[ke,a("div",null,p((A=(q=o.value.data)==null?void 0:q.transfer_to)==null?void 0:A.title),1)])]),a("div",Ee,[Re,Ce,a("strong",null,p((l=(O=o.value.data)==null?void 0:O.setup)==null?void 0:l.title),1)]),a("div",qe,[v(" SN-"+p(((n=(T=o.value)==null?void 0:T.data)==null?void 0:n.types)=="request"?"5":"3")+p(ne(1)),1),Ae,v(" "+p(c(Y)((I=o.value.data)==null?void 0:I.created_at)),1)])]}),_:1}),s(S,{class:"my-5"}),s(k,null,{default:u(()=>[Oe,Te,we,Ue,je,Ie,Se,Ne,a("div",Pe,[v(" REMARKS "),f.value||E.value?(r(),U(M,{key:0,modelValue:$.value,"onUpdate:modelValue":[i[0]||(i[0]=e=>$.value=e),ie],class:"pa-0 ma-0 v-col-1","hide-details":"",variant:"underlined",density:"compact"},null,8,["modelValue"])):b("",!0)])]),_:1}),(r(!0),_(ae,null,X(N.value,e=>(r(),U(k,{class:"mt-1",key:e.id},{default:u(()=>{var h,q,A,O,l,T;return[$e,a("div",Be,[s(V,{value:e.item_description,variant:"underlined",density:"compact","hide-details":"",class:"bg-light-gray",readonly:!0},null,8,["value"])]),a("div",De,[s(V,{modelValue:e.asset_code,"onUpdate:modelValue":n=>e.asset_code=n,variant:"underlined",density:"compact","hide-details":"",readonly:!f.value,class:B(`${f.value?"":"bg-light-gray"}`)},null,8,["modelValue","onUpdate:modelValue","readonly","class"])]),a("div",Le,[s(V,{value:e.qty,variant:"underlined",density:"compact","hide-details":"",class:"bg-light-gray",type:"number",readonly:!0},null,8,["value"])]),a("div",Fe,[s(V,{modelValue:e.weight,"onUpdate:modelValue":n=>e.weight=n,variant:"underlined",density:"compact","hide-details":"",readonly:!f.value,class:B(`${f.value?"":"bg-light-gray"}`)},null,8,["modelValue","onUpdate:modelValue","readonly","class"])]),a("div",Ke,[s(V,{modelValue:e.item_value,"onUpdate:modelValue":n=>e.item_value=n,variant:"underlined",density:"compact","hide-details":"",readonly:!f.value,class:B(`${f.value?"":"bg-light-gray"}`)},null,8,["modelValue","onUpdate:modelValue","readonly","class"])]),a("div",Me,[s(V,{modelValue:e.country_of_origin,"onUpdate:modelValue":n=>e.country_of_origin=n,variant:"underlined",density:"compact","hide-details":"",readonly:!f.value,class:B(`${f.value?"":"bg-light-gray"}`)},null,8,["modelValue","onUpdate:modelValue","readonly","class"])]),a("div",ze,[s(V,{value:e.reason_for_request,variant:"underlined",density:"compact","hide-details":"",class:"bg-light-gray",readonly:!0},null,8,["value"])]),f.value?(r(),_("div",Ge,[s(V,{modelValue:e.remarks,"onUpdate:modelValue":n=>e.remarks=n,variant:"underlined",density:"compact","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),s(M,{modelValue:e.is_available,"onUpdate:modelValue":[n=>e.is_available=n,W],class:"pa-0 ma-0 v-col-1","hide-details":"",variant:"underlined",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])])):E.value?(r(),_("div",Ye,[s(V,{modelValue:e.remarks,"onUpdate:modelValue":n=>e.remarks=n,variant:"underlined",density:"compact","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),(q=(h=o.value)==null?void 0:h.data)!=null&&q.is_available?(r(),_("div",He,[s(w,{class:"mt-3",icon:e.is_available?c(z):c(G),color:`${e.is_available?"success":"error"}`},null,8,["icon","color"])])):b("",!0),s(M,{modelValue:e.is_received,"onUpdate:modelValue":[n=>e.is_received=n,W],class:"pa-0 ma-0 v-col-1","hide-details":"",variant:"underlined",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])])):(r(),_("div",Je,[s(V,{value:e.remarks,variant:"underlined",density:"compact","hide-details":"",class:"bg-light-gray",readonly:!0},null,8,["value"]),(O=(A=o.value)==null?void 0:A.data)!=null&&O.is_available?(r(),_("div",Qe,[s(w,{class:"mt-3",icon:e.is_available?c(z):c(G),color:`${e.is_available?"success":"error"}`},null,8,["icon","color"])])):b("",!0),((T=(l=o.value)==null?void 0:l.data)==null?void 0:T.status)=="complete"?(r(),_("div",We,[s(w,{class:"mt-3",icon:e.is_received?c(Z):c(ee),color:`${e.is_received?"success":"error"}`},null,8,["icon","color"])])):b("",!0)]))]}),_:2},1024))),128)),f.value?(r(),U(k,{key:0,class:"mt-3"},{default:u(()=>[Xe]),_:1})):b("",!0),(R=(m=o.value)==null?void 0:m.data)!=null&&R.is_available?(r(),U(k,{key:1,class:"mt-6 mb-2"},{default:u(()=>[s(le,{loading:K.value,variant:"text",class:"v-col-12 text-center pt-2 font-weight-bold pb-0 d-flex justify-center"},{default:u(()=>{var e;return[a("div",null,[s(w,{icon:c(z),color:"success"},null,8,["icon"]),v(" AVAILABLE "),s(w,{icon:c(G),color:"error",class:"ml-5"},null,8,["icon"]),v(" NOT AVAILABLE ")]),E.value?(r(),_("div",Ze,[ea,s(w,{icon:c(pe)},null,8,["icon"]),v(" TICK RECEIVED ASSETS ")])):b("",!0),((e=o.value.data)==null?void 0:e.status)=="complete"?(r(),_("div",aa,[s(w,{icon:c(Z),color:"success"},null,8,["icon"]),v(" RECEIVED "),s(w,{icon:c(ee),color:"error",class:"ml-5"},null,8,["icon"]),v(" NOT RECEIVE ")])):b("",!0)]}),_:1},8,["loading"])]),_:1})):b("",!0),s(k,{class:"mt-3"},{default:u(()=>[a("div",la,[s(S),s(S)])]),_:1}),((C=o.value.data)==null?void 0:C.request_approvals.length)>0?(r(),U(k,{key:2},{default:u(()=>{var e,h,q,A,O;return[a("div",sa,[ta,oa,a("div",da,p((h=(e=o.value.data)==null?void 0:e.profile)==null?void 0:h.display_name),1),a("div",ca,p((A=(q=o.value.data)==null?void 0:q.profile)==null?void 0:A.designation),1),a("div",ra,p(c(Y)((O=o.value.data)==null?void 0:O.created_at)),1)]),(r(!0),_(ae,null,X(o.value.data.request_approvals,l=>{var T,n;return r(),_("div",{class:"v-col-12 v-col-md-3 pa-0 mb-4",key:l.id},[l.profile.role=="commercial-manager"&&c(t).query.pid==l.profile_id&&c(t).query.o==l.orders?(r(),_("div",ia,[l.status=="awaiting-approval"?(r(),_("div",na,[a("div",{onClick:I=>de(l),class:"cursor-pointer text-center py-5 v-col-6",style:L(`border:1px solid #ccc; ${c(t).query.pid==l.profile_id&&c(t).query.o==l.orders?"background-color: rgb(182, 3, 3);color:#fff;":"background-color: none;"}`)}," REJECT ",12,ua),a("div",{onClick:I=>D(l,"reject"),class:"cursor-pointer text-center py-5 v-col-6",style:L(`border:1px solid #ccc; ${c(t).query.pid==l.profile_id&&c(t).query.o==l.orders?"background-color: rgb(3, 167, 3);color:#fff;":"background-color: none"}`)}," APPROVE ",12,va)])):l.status=="reject"||l.status=="done"||l.status=="pending"?(r(),_("div",pa,[a("div",{onClick:I=>D(l),class:"cursor-pointer text-center mx-2 py-5",style:L(`border:1px solid #ccc; ${l.status=="reject"&&c(t).query.pid==l.profile_id&&c(t).query.o==l.orders?"background-color: rgb(182, 3, 3);color:#fff;":l.status=="done"?"background-color: none;color:rgb(3, 167, 3); font-weight:bold;font-size:17px;padding-top:16px !important;padding-bottom:16px !important;":"background-color: gray; color:#fff;"}`)},p(l.status=="done"?"APPROVED":"CLICK TO APPROVE"),13,_a)])):b("",!0)])):(r(),_("div",{key:1,onClick:I=>D(l),class:"cursor-pointer text-center mx-2 py-5",style:L(`border:1px solid #ccc; ${l.status=="awaiting-approval"&&c(t).query.pid==l.profile_id&&c(t).query.o==l.orders?"background-color: rgb(182, 3, 3);color:#fff;":l.status=="done"?"background-color: none;color:rgb(3, 167, 3); font-weight:bold;font-size:17px;padding-top:16px !important;padding-bottom:16px !important;":"background-color: gray; color:#fff;"}`)},p(l.status=="done"?"APPROVED":"CLICK TO APPROVE"),13,ya)),a("div",{class:B(`text-center py-1 font-weight-bold ${l.status=="reject"?"text-error text-uppercase":""}`)},p(l.status=="reject"?"Rejected":re(l.approval_type))+" By ",3),a("div",fa,p((T=l.profile)==null?void 0:T.display_name),1),a("div",ma,p((n=l.profile)==null?void 0:n.designation),1),a("div",ha,p(l.date_approved?c(Y)(l.date_approved):""),1),l.reason_rejected?(r(),_("div",ga,[v(" Reason "),s(S,{class:"my-2"}),v(" "+p(l.reason_rejected),1)])):b("",!0)])}),128))]}),_:1})):b("",!0),((x=(y=o.value)==null?void 0:y.data)==null?void 0:x.status)!=="complete"?(r(),U(k,{key:3},{default:u(()=>[a("div",ba,[s(S),v(" You will receive a notification once you click the button. "),s(S)])]),_:1})):b("",!0),s(me,{width:"500",modelValue:P.value,"onUpdate:modelValue":i[3]||(i[3]=e=>P.value=e),persistent:""},{default:u(()=>[s(le,null,{default:u(()=>[s(_e,null,{default:u(()=>[s(k,null,{default:u(()=>[Va,a("div",xa,[s(ye,{modelValue:j.value,"onUpdate:modelValue":i[1]||(i[1]=e=>j.value=e),label:"STATE YOUR REASON HERE",variant:"outlined"},null,8,["modelValue"])])]),_:1})]),_:1}),s(fe,null,{default:u(()=>[s(se),s(te,{onClick:ce},{default:u(()=>[v("Cancel")]),_:1}),s(te,{color:"success",disabled:!j.value,onClick:i[2]||(i[2]=e=>D(Q.value))},{default:u(()=>[v("Confirm")]),_:1},8,["disabled"]),s(se)]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(he,{options:F.value},null,8,["options"])]}),_:1}))}};export{qa as default};
