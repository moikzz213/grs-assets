import{r as u,a as se,u as oe,G as ne,H as ue,I as ie,c as v,w as l,m as de,n as P,o as r,d as a,v as w,b as t,j as m,ae as Q,e as f,k as I,f as W,s as h,J as q,x as ce,C as c,a6 as re,y as x,p as X,q as pe,t as L,K as ve,L as me,at as fe,au as ge,F as _e,M as ye,N as he,i as xe,E as be,B as ke,av as Ve,z as Ce,A as we}from"./app-d1a0eddb.js";import{_ as Ae}from"./ApppageHeader-bfe04de0.js";import{_ as Se}from"./AppSnackBar-3b6fdee1.js";import{_ as Ne}from"./_plugin-vue_export-helper-c27b6911.js";const g=A=>(Ce("data-v-464d2f0e"),A=A(),we(),A),Te={class:"mb-3"},$e=g(()=>t("div",{class:"mt-2 mr-2"},"Show",-1)),Be={class:"v-col-12"},Pe={class:"text-right text-capitalize"},Ee={class:"d-flex align-center justify-end"},Re=g(()=>t("br",null,null,-1)),ze=g(()=>t("small",null,"Applies both Request and Transfer Assets",-1)),De=g(()=>t("br",null,null,-1)),Ie=g(()=>t("small",null,"Previous approved request will not change.",-1)),qe={class:"v-col-12 v-col-md-12 mx-auto pt-0 my-0"},Le={class:"v-col-12 v-col-md-3 mx-auto"},Oe=g(()=>t("small",{class:"text-center"},"Add SN. No for specific transfer approval",-1)),Ue={class:"v-col-12 v-col-md-6 mx-auto"},Fe={class:"v-col-12 v-col-md-6 mx-auto d-flex"},je=g(()=>t("br",null,null,-1)),Me=g(()=>t("small",null,"Do not forget to remove the old approver and add the new approver from the Setup.",-1)),Ge={__name:"List",setup(A){const S=u([]),b=u({}),i=se(),E=u(0),Y=u(0),Z=u([10,20,50,100]),R=u(10),N=oe(),T=ne(),ee=()=>{y()},p=u(T.params&&T.params.page?T.params.page:1),$=u([]),O=u(""),U=u(0),d=u({loading:!1,data:[]}),k=u([]),V=u([]),B=u(""),_=u(T.params.type),z=s=>{d.value.loading=!0,$.value[0]=s,U.value%2?$.value[1]="DESC":$.value[1]="ASC",U.value++,O.value=JSON.stringify($.value),y()},D=s=>{d.value.loading=!0,d.value.data=[],_.value=s,N.push({path:"/approval-setup/"+s}),s!="change-approval"?y():F.value||j()},F=u(!1),j=async()=>{await P(i.token).get("/api/user/fetch/signatories").then(s=>{S.value=s.data,console.log("signatoryItems.value",S.value),F.value=!0}).catch(s=>{d.value.loading=!1,console.log(s)})},y=async()=>{d.value.loading=!0;let s="";_.value=="transfer-asset"?s="transfer":s="request",await P(i.token).get("/api/approval-setups/all/"+s+"?page="+p.value+"&show="+R.value+"&sort="+O.value).then(e=>{E.value=e.data.last_page?e.data.last_page:e.data.length,p.value=e.data.current_page?e.data.current_page:p.value,Y.value=e.data.total?e.data.total:e.data.length,d.value.data=e.data.data?e.data.data:e.data,d.value.loading=!1}).catch(e=>{d.value.loading=!1,console.log(e)})};ue(p,(s,e)=>{p.value&&s!=e&&(N.push({name:"PaginatedApprovals",params:{page:p.value}}).catch(o=>{}),y(p.value))});const ae=()=>{N.push({name:"NewApproval"}).catch(s=>{console.log(s)})},te=s=>{N.push({name:"EditApproval",params:{id:s}}).catch(e=>{console.log(e)})},C=u(!1),M=async(s,e)=>{b.value={status:!0,type:"info",text:"Please wait..."},C.value=!0;let o={id:s,status:e,profile_id:i.user.profile.id};await P(i.token).post("/api/approval-setups/status-change/data",o).then(n=>{setTimeout(()=>{b.value={status:!0,type:"success",text:n.data.message},y(),C.value=!1},600)}).catch(n=>{d.value.loading=!1,console.log(n)})},le=()=>{b.value={status:!0,type:"info",text:"Please wait..."};let s={old:V.value,new:k.value,serial:B.value};P(i.token).post("/api/approval-setups/change-signatory",s).then(e=>{V.value=[],k.value=[],B.value="",setTimeout(()=>{b.value={status:!0,type:"success",text:e.data.message}},600)}).catch(e=>{console.log(e)})};return ie(()=>{y(),_.value=="change-approval"&&j()}),(s,e)=>(r(),v(de,null,{default:l(()=>[a(Ae,{title:"Global Approval Setup"}),a(h,{class:"mb-3"},{default:l(()=>[a(w,{class:"v-col-12 mt-1 col-sm-12 py-0"},{default:l(()=>[t("div",Te,[a(m,{class:Q(`${_.value=="request-asset"?"tab-active":""}  v-col-12 v-col-md-3 mx-2`),onClick:e[0]||(e[0]=o=>D("request-asset"))},{default:l(()=>[f("Request Asset Approvals")]),_:1},8,["class"]),a(m,{class:Q(`${_.value=="transfer-asset"?"tab-active":""}   v-col-12 v-col-md-3 mx-2`),onClick:e[1]||(e[1]=o=>D("transfer-asset"))},{default:l(()=>[f("Transfer Asset Approvals")]),_:1},8,["class"]),a(m,{class:"v-col-12 v-col-md-3 mx-2",color:"primary",onClick:e[2]||(e[2]=o=>D("change-approval"))},{default:l(()=>[f("Change / Assign Approvals")]),_:1})]),_.value!=="change-approval"?(r(),v(I,{key:0},{default:l(()=>[a(W,null,{default:l(()=>[a(h,{class:"mb-3"},{default:l(()=>[a(w,{class:"v-col-6 v-col-md-2 v-col-sm-12 d-flex mt-2 mb-0 pb-0"},{default:l(()=>[$e,a(q,{items:Z.value,modelValue:R.value,"onUpdate:modelValue":[e[3]||(e[3]=o=>R.value=o),ee],variant:"outlined",density:"compact","hide-details":"",label:"Entry"},null,8,["items","modelValue"])]),_:1}),t("div",Be,[a(I,{loading:d.value.loading},{default:l(()=>[a(ce,null,{default:l(()=>{var o;return[t("thead",null,[t("tr",null,[t("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[4]||(e[4]=n=>z("title"))}," Title "),t("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[5]||(e[5]=n=>z("profile_id"))}," Updated By "),t("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[6]||(e[6]=n=>z("status"))}," Status "),t("th",Pe,[c(i).user.role=="superadmin"||(o=c(i).capabilities)!=null&&o.includes("add")?(r(),v(m,{key:0,size:"small",color:"primary","prepend-icon":c(re),onClick:ae},{default:l(()=>[f("Add New Matrix")]),_:1},8,["prepend-icon"])):x("",!0)])])]),t("tbody",null,[(r(!0),X(_e,null,pe(d.value.data,n=>{var G,J,K,H;return r(),X("tr",{key:n.id},[t("td",null,L(n.title),1),t("td",null,L((G=n.profile)==null?void 0:G.display_name),1),t("td",null,[a(ve,{class:"text-uppercase",size:"small",color:`${n.status=="active"?"success":"error"}`},{default:l(()=>[f(L(n.status),1)]),_:2},1032,["color"])]),t("td",null,[t("div",Ee,[c(i).user.role=="superadmin"||(J=c(i).capabilities)!=null&&J.includes("edit")?(r(),v(m,{key:0,loading:C.value,onClick:()=>te(n.id),icon:c(me),title:"Edit",density:"compact",class:"mx-2"},null,8,["loading","onClick","icon"])):x("",!0),n.status=="active"&&(c(i).user.role=="superadmin"||(K=c(i).capabilities)!=null&&K.includes("delete"))?(r(),v(m,{key:1,density:"compact",loading:C.value,icon:c(fe),onClick:()=>M(n.id,"disabled"),title:"Disable",class:"mx-2 text-error"},null,8,["loading","icon","onClick"])):x("",!0),n.status=="disabled"&&(c(i).user.role=="superadmin"||(H=c(i).capabilities)!=null&&H.includes("delete"))?(r(),v(m,{key:2,loading:C.value,density:"compact",onClick:()=>M(n.id,"active"),icon:c(ge),title:"Enable",class:"mx-2 text-success"},null,8,["loading","onClick","icon"])):x("",!0)])])])}),128))])]}),_:1}),d.value.data.length==0?(r(),v(ye,{key:0,class:"pa-3 text-center w-100"},{default:l(()=>[f("No records found")]),_:1})):x("",!0)]),_:1},8,["loading"]),E.value>1?(r(),v(he,{key:0,modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=o=>p.value=o),class:"my-4",length:E.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:d.value.loading},null,8,["modelValue","length","disabled"])):x("",!0)])]),_:1})]),_:1})]),_:1})):(r(),v(I,{key:1},{default:l(()=>[a(W,null,{default:l(()=>[a(h,null,{default:l(()=>[a(w,{md:"12",class:"text-center my-3"},{default:l(()=>[f("Change all current / pending approvals only. "),Re,ze,De,Ie]),_:1}),t("div",qe,[a(h,null,{default:l(()=>[t("div",Le,[a(xe,{modelValue:B.value,"onUpdate:modelValue":e[8]||(e[8]=o=>B.value=o),label:"SN No. (Optional)",variant:"outlined","hide-details":"auto",density:"compact",clearable:""},null,8,["modelValue"]),Oe])]),_:1}),a(h,null,{default:l(()=>[t("div",Ue,[a(be)])]),_:1})]),t("div",Fe,[a(q,{label:"Select Old Approver*",modelValue:V.value,"onUpdate:modelValue":e[9]||(e[9]=o=>V.value=o),"hide-details":"auto",variant:"outlined",density:"compact","item-value":"id","item-title":"display_name",items:S.value,class:"mx-2"},null,8,["modelValue","items"]),a(ke,{class:"my-auto",icon:c(Ve)},null,8,["icon"]),a(q,{label:"Select New Approver*",modelValue:k.value,"onUpdate:modelValue":e[10]||(e[10]=o=>k.value=o),"hide-details":"auto",variant:"outlined",density:"compact","item-value":"id","item-title":"display_name",items:S.value,class:"mx-2"},null,8,["modelValue","items"])]),a(w,{md:"12",class:"text-center pt-0"},{default:l(()=>[je,Me]),_:1})]),_:1}),a(h,null,{default:l(()=>[a(w,{md:"12"},{default:l(()=>[a(m,{disabled:k.value.length==0||V.value.length==0,block:"",color:"success",onClick:e[11]||(e[11]=o=>le())},{default:l(()=>[f("Transfer Signatory")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1})]),_:1}),a(Se,{options:b.value},null,8,["options"])]),_:1}))}},We=Ne(Ge,[["__scopeId","data-v-464d2f0e"]]);export{We as default};
