import{r as v,O as B,X as I,b as n,j as y,k as u,l as o,z as g,a4 as z,m as k,t as C,a6 as E,c as V,F as $,d as N,a7 as F,a8 as M,J as P,K as f,a9 as R,aa as q,ab as J,i as K,V as X,e as S,ac as G,I as L,M as H,q as Q,E as D,y as A,A as W,C as Y}from"./app-2bfa4af2.js";import{_ as Z}from"./AppPageHeader-ec450be5.js";import{_ as tt}from"./AppSnackBar-faf10b8c.js";import{u as et}from"./status-74307af0.js";const at={__name:"AppStatusDropDown",props:{loading:{type:Boolean,default:!1},list:{type:Array,default:[]},currentState:{type:Object,default:null}},emits:["update"],setup(b,{emit:e}){const c=b,a=v([]),d=v("");a.value=c.list,B(()=>c.list,i=>{a.value=[...a.value,...i.list]}),d.value=c.currentState.status,B(()=>c.currentState,i=>{d.value=i.status});const t=v(!1);B(()=>c.loading,i=>{t.value=i});const l=I(()=>a.value.filter(i=>i.title==d.value)[0]),x=i=>{d.value!=i.title&&(d.value=i.title,e("update",{state:l.value.title,model_id:c.currentState.id}))};return(i,m)=>(n(),y(q,null,{activator:u(({props:p})=>[o(g,z({loading:t.value,block:"",color:l.value.color},p),{default:u(()=>[k(C(l.value.title),1)]),_:2},1040,["loading","color"])]),default:u(()=>[o(E,null,{default:u(()=>[(n(!0),V($,null,N(a.value,(p,T)=>(n(),y(F,{key:T,value:T,onClick:()=>x(p)},{default:u(()=>[o(M,{class:"text-capitalize"},{default:u(()=>[o(P,{icon:f(R),color:p.color},null,8,["icon","color"]),k(" "+C(p.title),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1}))}},lt={class:"v-col-12 v-col-md-8"},st={class:"d-flex align-center"},ut={class:"text-capitalize"},ot={class:"v-col"},nt={key:0,class:"v-col"},it={class:"v-col px-3 d-flex align-center justify-center",style:{width:"100%","max-width":"150px","min-width":"150px"}},rt={__name:"StatusType",props:{type:{type:String,default:""}},setup(b){const e=b,{mobile:c}=J(),a=K(),d=v({}),t=et(),l=v(t.statusListByType);t.list.length<1&&t.getStatuses(a.token).then(()=>{t.filterStatusByType(e.type).then(()=>{l.value=t.statusListByType})}),B(()=>e.type,r=>{console.log("newVal",r),t.filterStatusByType(e.type).then(()=>{l.value=t.statusListByType})});const x=()=>{l.value.push({title:null,type:null,status:"active",type:e.type,notification_interval:e.type=="urgency"?1:null})},i=r=>{l.value=l.value.filter(function(_,s){return s!==r})},m=v(!1),p=v([]),T=v([{title:"active",color:"success"},{title:"disabled",color:"error"}]),O=r=>{p.value.push(r.model_id);let _={id:r.model_id,type:e.type,status:r.state};t.updateStatus(_,a.token).then(s=>{t.getStatuses(a.token).then(()=>{t.filterStatusByType(e.type).then(()=>{l.value=t.statusListByType,p.value=[],d.value={status:!0,type:"success",text:"Status has been saved"}})})}).catch(s=>{p.value=[],d.value={status:!0,type:"error",text:"Error while updating status"}})},U=I(()=>{let r=!0;return l.value.map(_=>{(!_.title||_.title.length==0)&&(r=!1)}),r}),j=()=>{m.value=!0;let r={list:l.value};t.saveStatusList(r,a.token).then(()=>{t.getStatuses(a.token).then(()=>{t.filterStatusByType(e.type).then(()=>{l.value=t.statusListByType,m.value=!1,d.value={status:!0,type:"success",text:"Status list has been saved"}})})}).catch(_=>{m.value=!1,d.value={status:!0,type:"error",text:"Error while saving status list"}})};return(r,_)=>(n(),V("div",lt,[o(W,null,{default:u(()=>[o(X,null,{default:u(()=>{var s,h;return[S("div",st,[f(a).user.role=="superadmin"||(s=f(a).capabilities)!=null&&s.includes("add")?(n(),y(g,{key:0,icon:f(G),onClick:x,size:"x-small",color:"white",class:"mr-3"},null,8,["icon"])):L("",!0),S("div",ut,C(e.type.replace("-"," "))+" List",1),f(a).user.role=="superadmin"||(h=f(a).capabilities)!=null&&h.includes("edit")?(n(),y(g,{key:1,disabled:!U.value,loading:m.value,onClick:j,color:"primary",class:"ml-auto"},{default:u(()=>[k("Save")]),_:1},8,["disabled","loading"])):L("",!0)])]}),_:1}),o(H),o(Q,null,{default:u(()=>[(n(!0),V($,null,N(l.value,(s,h)=>(n(),y(D,{key:h},{default:u(()=>[S("div",ot,[o(A,{"hide-details":"auto",modelValue:s.title,"onUpdate:modelValue":w=>s.title=w,label:`${e.type.charAt(0).toUpperCase()+e.type.slice(1)} Title`,variant:"outlined",density:"compact",disabled:s.id<10},null,8,["modelValue","onUpdate:modelValue","label","disabled"])]),e.type=="urgency"?(n(),V("div",nt,[o(A,{"hide-details":"auto",modelValue:s.notification_interval,"onUpdate:modelValue":w=>s.notification_interval=w,label:`${f(c)?"Notif. (days)":"Notification Interval (days)"} `,variant:"outlined",density:"compact",disabled:s.id<10},null,8,["modelValue","onUpdate:modelValue","label","disabled"])])):L("",!0),S("div",it,[s.id?(n(),y(at,{key:0,onUpdate:O,list:T.value,"current-state":s,loading:p.value.includes(s.id)==!0},null,8,["list","current-state","loading"])):(n(),y(g,{key:1,block:"",color:"error",onClick:()=>i(h)},{default:u(()=>[k(" remove ")]),_:2},1032,["onClick"]))])]),_:2},1024))),128))]),_:1})]),_:1}),o(tt,{options:d.value},null,8,["options"])]))}},ct={class:"v-col py-0"},_t={__name:"Others",setup(b){const e=v(["asset","condition-type","incident-type","incident","maintenance","urgency"]),c=v("asset");return(a,d)=>(n(),y(Y,null,{default:u(()=>[o(Z,{title:"Others - Status Setup"}),o(D,{class:"mt-5"},{default:u(()=>[S("div",ct,[(n(!0),V($,null,N(e.value,(t,l)=>(n(),y(g,{class:"mr-3 mb-3",key:l,color:`${c.value==t?"primary":"white"}`,onClick:x=>c.value=t},{default:u(()=>[k(C(t.replace("-"," ")),1)]),_:2},1032,["color","onClick"]))),128))])]),_:1}),o(D,{class:"mb-3"},{default:u(()=>[o(rt,{type:c.value},null,8,["type"])]),_:1})]),_:1}))}};export{_t as default};
