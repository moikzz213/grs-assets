import{r as o,i as ae,u as le,N as se,O as oe,o as ne,j as _,k as n,C as ie,D as z,b as f,l as s,G as D,z as de,m as y,A as N,q as ue,E as T,e as l,P as x,Q as re,y as ce,x as pe,H as me,c as I,d as ve,t as u,R as fe,K as g,J as O,S as ge,T as ye,I as j,F as he,U as _e,W as xe}from"./app-d45ea034.js";import{_ as Ve}from"./ApppageHeader-8e0f3b7f.js";import{d as Ce,e as be}from"./encrypt-fde381ec.js";import{_ as ke}from"./AppSnackBar-b1e4c329.js";import{u as q}from"./formatDate-d9866ad4.js";const Se=l("div",{class:"my-auto"},"Filter",-1),we={class:"v-col-md-2 py-1"},ze={class:"v-col-md-2 py-1"},De={class:"v-col-md-2 py-1"},Ne=l("div",{class:"mt-2 mr-2"},"Show",-1),Te={class:"v-col-12"},je=l("th",{class:"text-left text-capitalize"},"SN No.",-1),Ae=l("br",null,null,-1),Re=l("small",null,"(DD/MM/YY)",-1),$e=l("br",null,null,-1),Be=l("small",null,"(DD/MM/YY)",-1),Le=l("th",{class:"text-right text-capitalize"},null,-1),Pe={class:"d-flex align-center justify-end"},Ke={__name:"List",setup(Ue){const E=o({status:!1,type:"primary",text:null}),r=ae(),V=le(),C=se(),d=o({loading:!1,data:[]}),b=o(0),K=o(0),v=o(""),M=o([10,20,50,100]),k=o(10),c=o({}),Y=()=>{m()},S=()=>{w.value="",i.value==1?m():i.value=1},A=()=>{localStorage.setItem("transfer-asset-search",be(v.value)),m()},J=()=>{v.value="",localStorage.setItem("transfer-asset-search",""),m()},i=o(C.params&&C.params.page?C.params.page:1),h=o([]),w=o(""),R=o(0),p=e=>{d.value.loading=!0,h.value[0]=e,R.value%2?h.value[1]="DESC":h.value[1]="ASC",R.value++,w.value=JSON.stringify(h.value),m()},$=o([]),G=async()=>{await z(r.token).get("/api/fetch/companies").then(e=>{$.value=e.data}).catch(e=>{})},B=o([]),H=async()=>{await z(r.token).get("/api/fetch/locations/non-paginated/data").then(e=>{B.value=e.data}).catch(e=>{})},Q=o([{id:"pending",title:"Pending"},{id:"awaiting-approval",title:"Awaiting Approval"},{id:"reject",title:"Rejected"},{id:"cancelled",title:"Cancelled"},{id:"complete",title:"Completed"}]),W=e=>e=="reject"?"Rejected":e=="complete"?"Completed":e,m=async()=>{d.value.loading=!0,await z(r.token).get("/api/fetch/request-assets/by-requestor/transfer?userid="+r.user.profile.id+"&role="+r.user.profile.role+"&page="+i.value+"&show="+k.value+"&search="+v.value+"&sort="+w.value+"&filter="+JSON.stringify(c.value)).then(e=>{b.value=e.data.last_page?e.data.last_page:e.data.length,i.value=e.data.current_page?e.data.current_page:i.value,K.value=e.data.total?e.data.total:e.data.length,d.value.data=e.data.data?e.data.data:e.data,d.value.loading=!1}).catch(e=>{d.value.loading=!1,console.log(e)})};oe(i,(e,a)=>{i.value&&e!=a&&(V.push({name:"PaginatedTransferAsset",params:{page:i.value}}).catch(t=>{}),m(i.value))});const X=e=>{V.push({name:"EditTransferAsset",params:{id:e}}).catch(a=>{console.log(a)})},Z=e=>{console.log("delete",e)},ee=()=>{V.push({name:"NewTransferAsset"}).catch(e=>{console.log(e)})},te=(e,a=6)=>{let t="00000"+e;return t.substring(t.length-a)};return ne(()=>{let e=localStorage.getItem("transfer-asset-search");e&&(v.value=Ce(e)),m().then(()=>{G().then(()=>{H()})})}),(e,a)=>(f(),_(ie,null,{default:n(()=>[s(Ve,{title:"Asset Transfer page"}),s(T,{class:"mb-3"},{default:n(()=>[s(D,{class:"v-col-12 mt-1 col-sm-12 py-0"},{default:n(()=>[s(de,{size:"small",color:"primary",onClick:ee},{default:n(()=>[y("Transfer new asset")]),_:1}),s(N,{class:"px-5 mb-1"},{default:n(()=>[s(ue,null,{default:n(()=>[s(T,null,{default:n(()=>[Se,l("div",we,[s(x,{items:$.value,modelValue:c.value.company_id,"onUpdate:modelValue":[a[0]||(a[0]=t=>c.value.company_id=t),S],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Company"},null,8,["items","modelValue"])]),l("div",ze,[s(x,{items:B.value,modelValue:c.value.location_id,"onUpdate:modelValue":[a[1]||(a[1]=t=>c.value.location_id=t),S],variant:"outlined",density:"compact","hide-details":"",label:"Location","item-value":"id",clearable:"","item-title":"title"},null,8,["items","modelValue"])]),l("div",De,[s(x,{items:Q.value,modelValue:c.value.status,"onUpdate:modelValue":[a[2]||(a[2]=t=>c.value.status=t),S],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Status"},null,8,["items","modelValue"])])]),_:1})]),_:1})]),_:1}),s(N,{class:"px-5"},{default:n(()=>[s(T,null,{default:n(()=>[s(D,{class:"v-col-6 v-col-md-2 v-col-sm-6 d-flex my-2"},{default:n(()=>[Ne,s(x,{items:M.value,modelValue:k.value,"onUpdate:modelValue":[a[3]||(a[3]=t=>k.value=t),Y],variant:"outlined",density:"compact","hide-details":"",label:"Entry"},null,8,["items","modelValue"])]),_:1}),s(re),s(D,{class:"v-col-6 v-col-md-3 v-col-sm-6 my-2"},{default:n(()=>[s(ce,{modelValue:v.value,"onUpdate:modelValue":a[4]||(a[4]=t=>v.value=t),variant:"outlined",density:"compact",clearable:"",label:"Search (ex. SN-3000035 )",type:"text","hide-details":"","onClick:appendOuter":A,onKeydown:pe(A,["enter"]),"onClick:clear":a[5]||(a[5]=t=>J("search"))},null,8,["modelValue","onKeydown"])]),_:1})]),_:1})]),_:1})]),_:1}),l("div",Te,[s(N,{loading:d.value.loading},{default:n(()=>[s(me,null,{default:n(()=>[l("thead",null,[l("tr",null,[je,l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[6]||(a[6]=t=>p("company_id"))}," Company "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[7]||(a[7]=t=>p("transferred_to"))}," Location "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[8]||(a[8]=t=>p("subject"))}," Subject "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[9]||(a[9]=t=>p("profile_id"))}," Requestor "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[10]||(a[10]=t=>p("status"))}," Status "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[11]||(a[11]=t=>p("created_at"))},[y(" D.Requested"),Ae,Re]),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[12]||(a[12]=t=>p("date_closed"))},[y(" D.Closed"),$e,Be]),Le])]),l("tbody",null,[(f(!0),I(he,null,ve(d.value.data,t=>{var L,P,U,F;return f(),I("tr",{key:t.id},[l("td",null,"SN-3"+u(te(t.id)),1),l("td",null,u((L=t.company)==null?void 0:L.title),1),l("td",null,u((P=t.transfer_to)==null?void 0:P.title),1),l("td",null,u(t.subject),1),l("td",null,u((U=t.profile)==null?void 0:U.display_name),1),l("td",null,[s(fe,{class:"text-uppercase",size:"small",color:`${t.status.toLowerCase()=="complete"?"success":"error"}`},{default:n(()=>[y(u(W(t.status)),1)]),_:2},1032,["color"])]),l("td",null,u(g(q)(t.created_at)),1),l("td",null,u(t.date_closed&&t.date_closed!="0000-00-00"?g(q)(t.date_closed):""),1),l("td",null,[l("div",Pe,[s(O,{size:"small",onClick:()=>X(t.id),icon:g(ge),class:"mx-1"},null,8,["onClick","icon"]),g(r).user.role=="superadmin"||(F=g(r).capabilities)!=null&&F.includes("delete")?(f(),_(O,{key:0,size:"small",onClick:()=>Z(t.id),icon:g(ye),class:"mx-1"},null,8,["onClick","icon"])):j("",!0)])])])}),128))])]),_:1}),d.value.data.length==0?(f(),_(_e,{key:0,class:"pa-3 text-center w-100"},{default:n(()=>[y("No records found")]),_:1})):j("",!0)]),_:1},8,["loading"]),b.value>1?(f(),_(xe,{key:0,modelValue:i.value,"onUpdate:modelValue":a[13]||(a[13]=t=>i.value=t),class:"my-4",length:b.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:d.value.loading},null,8,["modelValue","length","disabled"])):j("",!0)])]),_:1}),s(ke,{options:E.value},null,8,["options"])]),_:1}))}};export{Ke as default};
