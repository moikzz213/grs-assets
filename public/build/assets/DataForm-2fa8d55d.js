import{a as H,r as n,u as J,G as W,I as X,c as v,w as s,m as Z,n as $,o as u,d as e,v as z,b as o,j as f,ae as B,e as _,k as b,f as tt,s as i,E as et,p as x,q as I,y as U,P as E,Q as w,F as N,M as j,R as at,A as st,B as lt}from"./app-1ed96eee.js";import{_ as ot}from"./ApppageHeader-4eeeaa67.js";import{_ as nt}from"./AppSnackBar-6b4e7a85.js";import{_ as M}from"./Studio-c950aff3.js";import{_ as it}from"./_plugin-vue_export-helper-c27b6911.js";import"./formatDate-559e9d83.js";const q=h=>(st("data-v-b8bf833a"),h=h(),lt(),h),ct={class:"mb-3"},ut=q(()=>o("h3",null,"Stamp & Signature",-1)),rt={class:"v-col-6 pt-0"},dt={class:"v-col-12 pt-5 pb-2 d-flex"},pt=q(()=>o("h3",{class:"ml-5 mt-2"},"UPLOAD COMPANY STAMP",-1)),mt={class:"v-col-12 pt-0 pb-5"},vt={class:"v-col-6 pt-0"},ft={class:"v-col-12 pt-5 pb-2 d-flex"},_t=q(()=>o("h3",{class:"ml-5 mt-2"},"UPLOAD SIGNATURE",-1)),ht={class:"v-col-12 pt-0 pb-5"},yt={class:"v-col-3"},gt={style:{height:"680px",width:"100%"},class:"d-flex align-center justify-center"},bt={__name:"DataForm",emits:["saved"],setup(h,{emit:xt}){const k=H(),C=n(window.location.origin),r=n([]),d=n([]),y=n({}),G=n({}),K=J(),g=W(),c=n(g.params.type),A=n("location-"+c.value),p=n([]),D=t=>{c.value=t,A.value="location-"+c.value,r.value=[],d.value=[],T(),K.push({path:"/locations/"+g.params.location.toLowerCase()+"/stamp-signature/"+t})},F=n(!1),Q=()=>{F.value=!0,y.value={status:!0,type:"info",text:"Please wait..."};let l={stamp:p.value.filter(m=>m!==null).map(m=>m.id),profile_id:k.user.profile.id,location:g.params.location},V="/api/stamp-signature/add-update";$(k.token).post(V,l).then(m=>{y.value={status:!0,type:"success",text:"Data has been saved."},F.value=!1}).catch(m=>{y.value={status:!0,type:"error",text:"Error: Failed to save data."},G.value.loading=!1})},R=t=>{let a=null;t&&t.length>0&&(t[0].type=="location-request-stamp"||t[0].type=="location-transfer-stamp")?r.value=t:t&&t.length>0&&(t[0].type=="location-request-signature"||t[0].type=="location-transfer-signature")&&(d.value=t),a=p.value.filter(l=>l.type!==t[0].type),p.value=[...a,...t]},S=n(!1),L=n(""),O=t=>{L.value=t,S.value=!0},P=t=>{r.value=r.value.filter(a=>a.id!==t),d.value=d.value.filter(a=>a.id!==t),p.value=p.value.filter(a=>a.id!==t)},Y=()=>{var t;((t=p.value)==null?void 0:t.length)>0&&p.value.map(a=>{a.type=="location-request-stamp"&&c.value=="request"?r.value=[a]:a.type=="location-request-signature"&&c.value=="request"?d.value=[a]:a.type=="location-transfer-stamp"&&c.value=="transfer"?r.value=[a]:a.type=="location-transfer-signature"&&c.value=="transfer"&&(d.value=[a])})},T=async()=>{await $(k.token).get("/api/location/"+g.params.location+"/stamp-signature").then(t=>{p.value=Object.assign([],t.data.attachment),Y()}).catch(t=>{})};return X(()=>{T()}),(t,a)=>(u(),v(Z,null,{default:s(()=>[e(ot,{title:"Stamp & Signature for Inbound-Outbound Request"}),e(i,{class:"mb-3 mt-3"},{default:s(()=>[e(z,{class:"v-col-12 mt-1 col-sm-12 py-0"},{default:s(()=>[o("div",ct,[e(f,{class:B(`${c.value=="request"?"tab-active":""}  v-col-12 v-col-md-3 mx-2`),onClick:a[0]||(a[0]=l=>D("request"))},{default:s(()=>[_("Request Asset")]),_:1},8,["class"]),e(f,{class:B(`${c.value=="transfer"?"tab-active":""}   v-col-12 v-col-md-3 mx-2`),onClick:a[1]||(a[1]=l=>D("transfer"))},{default:s(()=>[_("Transfer Asset")]),_:1},8,["class"])]),e(b,null,{default:s(()=>[e(tt,null,{default:s(()=>[e(i,null,{default:s(()=>[e(z,{class:"v-col-12 col-sm-12 pt-0 text-center my-5"},{default:s(()=>[ut]),_:1})]),_:1}),e(et),e(i,{class:"mb-3 mt-3"},{default:s(()=>[o("div",rt,[e(i,null,{default:s(()=>[o("div",dt,[e(M,{options:{multiSelect:!1,type:A.value+"-stamp"},onSelect:R},null,8,["options"]),pt])]),_:1}),r.value.length>0?(u(),v(i,{key:0,class:"px-1"},{default:s(()=>[(u(!0),x(N,null,I(r.value,(l,V)=>(u(),x("div",{key:l.id,class:"v-col-12 v-col-md-4 pa-2 mb-5",style:{position:"relative"}},[e(f,{style:{position:"absolute",top:"0",right:"0","z-index":"1"},icon:U(E),size:"26px",color:"error",onClick:()=>P(l.id)},null,8,["icon","onClick"]),e(b,{onClick:()=>O(l.path)},{default:s(()=>[e(w,{src:C.value+"/file/"+l.path,cover:"","aspect-ratio":"1"},null,8,["src"])]),_:2},1032,["onClick"])]))),128))]),_:1})):(u(),v(i,{key:1},{default:s(()=>[o("div",mt,[e(j,{color:"grey-lighten-4",class:"pa-6 text-center"},{default:s(()=>[_(" Attachment is empty at the moment. ")]),_:1})])]),_:1}))]),o("div",vt,[e(i,null,{default:s(()=>[o("div",ft,[e(M,{options:{multiSelect:!1,type:A.value+"-signature"},onSelect:R},null,8,["options"]),_t])]),_:1}),d.value.length>0?(u(),v(i,{key:0,class:"px-1"},{default:s(()=>[(u(!0),x(N,null,I(d.value,(l,V)=>(u(),x("div",{key:l.id,class:"v-col-12 v-col-md-4 pa-2 mb-5",style:{position:"relative"}},[e(f,{style:{position:"absolute",top:"0",right:"0","z-index":"1"},icon:U(E),size:"26px",color:"error",onClick:()=>P(l.id)},null,8,["icon","onClick"]),e(b,{onClick:()=>O(l.path)},{default:s(()=>[e(w,{src:C.value+"/file/"+l.path,cover:"","aspect-ratio":"1"},null,8,["src"])]),_:2},1032,["onClick"])]))),128))]),_:1})):(u(),v(i,{key:1},{default:s(()=>[o("div",ht,[e(j,{color:"grey-lighten-4",class:"pa-6 text-center"},{default:s(()=>[_(" Attachment is empty at the moment. ")]),_:1})])]),_:1}))])]),_:1}),e(i,{class:"d-flex"},{default:s(()=>[o("div",yt,[e(f,{width:"100%",color:"primary",onClick:Q},{default:s(()=>[_("Submit")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(at,{modelValue:S.value,"onUpdate:modelValue":a[2]||(a[2]=l=>S.value=l),width:"95%","max-width":"900"},{default:s(()=>[e(b,{class:"bg-black"},{default:s(()=>[o("div",gt,[e(w,{src:C.value+"/file/"+L.value},null,8,["src"])])]),_:1})]),_:1},8,["modelValue"]),e(nt,{options:y.value},null,8,["options"])]),_:1}))}},qt=it(bt,[["__scopeId","data-v-b8bf833a"]]);export{qt as default};
