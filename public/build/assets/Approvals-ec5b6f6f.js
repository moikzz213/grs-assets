import{N as me,r as f,j,k as n,C as he,b as i,l,e as a,t as _,m as p,K as r,E as C,M as N,ag as G,I as b,c as v,d as le,J as V,as as ge,A as D,$ as be,a0 as Ve,Z as xe,_ as se,at as ke,y as x,a2 as L,au as J,av as Q,aw as te,ax as oe,F as de,ay as Ee,n as K,q as Ce,a1 as Re,a5 as qe,Q as re,z as ce}from"./app-2bfa4af2.js";import{u as W}from"./formatDate-e2fbee14.js";import{_ as Ae}from"./AppSnackBar-faf10b8c.js";const we={class:"v-col-3 mt-auto font-weight-bold"},Oe={class:"d-flex"},Te=a("div",{class:"mr-2"},"FROM:",-1),Ie={class:"d-flex"},Ue=a("div",{class:"mr-6"},"TO:Â ",-1),je={class:"v-col-6 text-center"},Se=a("img",{src:"/assets/images/grandiose-logo.jpg",style:{"max-height":"100px"}},null,-1),Ne=a("br",null,null,-1),$e={class:"v-col-3 mt-auto font-weight-bold text-right"},Be=a("br",null,null,-1),Pe=a("div",{class:"v-col-12 v-col-md-1 py-1"},"IMAGE",-1),De=a("div",{class:"v-col-12 v-col-md-2 py-1"},"ITEM DESCRIPTION",-1),Le=a("div",{class:"v-col-12 v-col-md-1 py-1"},"ASSET NO",-1),Fe=a("div",{class:"v-col-12 v-col-md-1 py-1"},"QTY",-1),Ke=a("div",{class:"v-col-12 v-col-md-1 py-1"},"WEIGHT",-1),ze=a("div",{class:"v-col-12 v-col-md-1 py-1"},"ITEM VALUE",-1),Me=a("div",{class:"v-col-12 v-col-md-1 py-1"},"COUNTRY OF ORIGIN",-1),He=a("div",{class:"v-col-12 v-col-md-2 py-1"},[p(" REMARKS"),a("br"),p("REASON FOR REQUEST ")],-1),Ye={class:"v-col-12 v-col-md-2 py-1 d-flex justify-space-between"},Ge={class:"v-col-12 v-col-md-3 py-1 d-flex"},Je={key:0},Qe={style:{height:"680px",width:"100%"},class:"d-flex align-center justify-center"},We={class:"v-col-12 v-col-md-1 py-1"},Xe={class:"v-col-12 v-col-md-1 py-1"},Ze={class:"v-col-12 v-col-md-1 py-1"},ea={class:"v-col-12 v-col-md-1 py-1"},aa={class:"v-col-12 v-col-md-1 py-1"},la={class:"v-col-12 v-col-md-2 py-1"},sa={key:0,class:"v-col-12 v-col-md-2 py-1 d-flex justify-space-between"},ta={key:1,class:"v-col-12 v-col-md-2 py-1 d-flex justify-space-between"},oa={key:0},da={key:2,class:"v-col-12 v-col-md-2 py-1 d-flex justify-space-between"},ra={key:0},ca={key:1},ia=a("div",{class:"v-col-12 text-center font-weight-bold text-info"},[p(" YOU CAN UPDATE SOME DATA AND"),a("br"),p(" PLEASE TICK CHECKBOX IF ASSET IS AVAILABLE BEFORE CLICKING THE APPROVE BUTTON ")],-1),na={key:0,class:"ml-5 d-flex"},ua=a("div",{class:"px-2 mr-5"},"|",-1),va={key:1,class:"ml-6"},pa={class:"v-col-12 px-0 my-0"},_a={class:"v-col-12 v-col-md-3 pa-0 mb-4"},ya=a("div",{class:"text-center mx-2 py-4 font-weight-bold",style:{color:"rgb(3, 167, 3)",border:"1px solid #ccc","font-size":"17px"}}," APPROVED ",-1),fa=a("div",{class:"text-center py-1 font-weight-bold"}," Requested By ",-1),ma={class:"text-center py-1"},ha={class:"text-center py-1"},ga={class:"text-center"},ba={key:0},Va={key:0,class:"d-flex"},xa=["onClick"],ka=["onClick"],Ea={key:1},Ca=["onClick"],Ra=["onClick"],qa={class:"text-center py-1"},Aa={class:"text-center py-1"},wa={class:"text-center"},Oa={key:2,class:"v-col-12",style:{border:"1px solid red"}},Ta={class:"v-col-12 text-center"},Ia=a("div",{class:"v-col-12 text-center mt-3 font-weight-bold"}," REASON FOR REJECTION ",-1),Ua={class:"v-col-12"},Ba={__name:"Approvals",setup(ja){const t=me(),X=f(!0),o=f({}),z=f({}),m=f(!1),ie=f(!1),R=f(!1),$=f([]),B=f(!1),S=f(""),M=f(!1),Z=async()=>{let d={id:t.query.id,profile_id:t.query.pid,order:t.query.o};if(!t.query.id||!t.query.pv){X.value=!1;return}await axios.post("/api/public/fetch/request-assets/data",d).then(c=>{var h,q,A,y,k;if(o.value=c.data,!o.value.access){X.value=!1;return}((A=(q=(h=o.value)==null?void 0:h.data)==null?void 0:q.request_approvals)==null?void 0:A.length)>0&&(m.value=o.value.data.request_approvals.filter(e=>{var g;return e.profile_id==t.query.pid&&e.orders==t.query.o&&e.status=="awaiting-approval"&&((g=e.profile)==null?void 0:g.role)=="asset-supervisor"})[0],ie.value=o.value.data.request_approvals.filter(e=>{var g;return e.profile_id==t.query.pid&&e.orders==t.query.o&&e.status=="awaiting-approval"&&((g=e.profile)==null?void 0:g.role)=="commercial-manager"})[0],R.value=o.value.data.request_approvals.filter(e=>e.profile_id==t.query.pid&&e.orders==t.query.o&&e.status=="awaiting-approval"&&e.approval_type=="receiver")[0],(R.value||m.value)&&(M.value=!0)),$.value=(k=(y=o.value)==null?void 0:y.data)==null?void 0:k.items,console.log("dataObj.value",o.value)}).catch(c=>{console.log(c.response.data)})},ne=f(window.location.origin),H=f(!1),Y=f(1),ue=d=>{Y.value=d,H.value=!0},ee=f({}),ve=d=>{B.value=!0,ee.value=d},pe=()=>{B.value=!1,S.value=""},F=(d,c=null)=>{if(B.value=!1,(d.status=="awaiting-approval"||d.status=="reject")&&t.query.pid==d.profile_id&&t.query.o==d.orders){z.value={status:!0,type:"info",text:"Please wait..."};let h=[];(m.value||R.value)&&(h=$.value.map((y,k)=>(delete y.created_at,delete y.assets,delete y.updated_at,y)));let q={},A="";S.value&&c&&(A=S.value),q={profile_id:t.query.pid,id:t.query.id,order:t.query.o,type:o.value.data.types,assets:h,is_reject:A,requestor_id:o.value.data.profile_id},axios.post("/api/public/store/request-asset/approve-data",q).then(y=>{let k="success";y.data.success||(k="error"),z.value={status:!0,type:k,text:y.data.message},M.value=!1,setTimeout(()=>{Z()},500)}).catch(y=>{console.log(y.response.data)});return}},_e=d=>{if(d=="approve")return"Approved";if(d=="reject")return"Rejected";if(d=="verify")return"Verified";if(d=="confirm")return"Confirmed";if(d=="reviewer")return"Reviewed";if(d=="receiver")return"Received"},ye=()=>{let d=R.value;$.value.map(c=>{d?c.is_received=P.value:c.is_available=P.value})},fe=(d,c=6)=>{let h="00000"+d;return h.substring(h.length-c)},ae=()=>{let d=!0,c=R.value;$.value.map(h=>{c?h.is_received||(d=!1):h.is_available||(d=!1)}),P.value=d},P=f(!1);return Z(),(d,c)=>(i(),j(he,{style:{"max-width":"1200px"},class:"mt-0 pt-0"},{default:n(()=>{var h,q,A,y,k;return[l(C,{class:"mt-0 pt-0"},{default:n(()=>{var e,g,w,O,T,s,I,U,E;return[a("div",we,[a("div",Oe,[Te,a("div",null,_((g=(e=o.value.data)==null?void 0:e.transfer_from)==null?void 0:g.title),1)]),a("div",Ie,[Ue,a("div",null,_((O=(w=o.value.data)==null?void 0:w.transfer_to)==null?void 0:O.title),1)])]),a("div",je,[Se,Ne,a("strong",null,_((s=(T=o.value.data)==null?void 0:T.setup)==null?void 0:s.title),1)]),a("div",$e,[p(" SN-"+_(((U=(I=o.value)==null?void 0:I.data)==null?void 0:U.types)=="request"?"5":"3")+_(fe(1)),1),Be,p(" "+_(r(W)((E=o.value.data)==null?void 0:E.created_at)),1)])]}),_:1}),l(N,{class:"my-5"}),l(C,null,{default:n(()=>[Pe,De,Le,Fe,Ke,ze,Me,He,a("div",Ye,[p(" REMARKS "),m.value||R.value?(i(),j(G,{key:0,modelValue:P.value,"onUpdate:modelValue":[c[0]||(c[0]=e=>P.value=e),ye],class:"pa-0 ma-0 v-col-1","hide-details":"",variant:"underlined",density:"compact"},null,8,["modelValue"])):b("",!0)])]),_:1}),(i(!0),v(de,null,le($.value,(e,g)=>(i(),j(C,{class:"mt-1",key:e.id},{default:n(()=>{var w,O,T,s,I,U,E;return[a("div",Ge,[(w=e.attachment)!=null&&w.id?(i(),v("div",Je,[l(D,{onClick:()=>ue(g),maxHeight:"40",variant:"text",class:"ma-2"},{default:n(()=>[l(V,{size:"large",icon:r(ge),color:"success"},null,8,["icon"])]),_:2},1032,["onClick"]),l(se,{modelValue:H.value,"onUpdate:modelValue":c[2]||(c[2]=u=>H.value=u),width:"95%","max-width":"900"},{default:n(()=>[l(D,{class:"bg-black"},{default:n(()=>[l(be,{"hide-delimiter-background":"","show-arrows":"hover",height:"680px",modelValue:Y.value,"onUpdate:modelValue":c[1]||(c[1]=u=>Y.value=u)},{default:n(()=>[l(Ve,{"reverse-transition":"fade",transition:"fade"},{default:n(()=>[a("div",Qe,[l(xe,{src:ne.value+"/file/"+e.attachment.path},null,8,["src"])])]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1024)]),_:2},1032,["modelValue"])])):(i(),j(D,{key:1,maxHeight:"40",variant:"text",class:"ma-2"},{default:n(()=>[l(V,{size:"large",icon:r(ke)},null,8,["icon"])]),_:1})),l(x,{value:e.item_description,variant:"underlined",density:"compact","hide-details":"",class:"bg-light-gray",readonly:!0},null,8,["value"])]),a("div",We,[l(x,{modelValue:e.asset_code,"onUpdate:modelValue":u=>e.asset_code=u,variant:"underlined",density:"compact","hide-details":"",readonly:!m.value,class:L(`${m.value?"":"bg-light-gray"}`)},null,8,["modelValue","onUpdate:modelValue","readonly","class"])]),a("div",Xe,[l(x,{value:e.qty,variant:"underlined",density:"compact","hide-details":"",class:"bg-light-gray",type:"number",readonly:!0},null,8,["value"])]),a("div",Ze,[l(x,{modelValue:e.weight,"onUpdate:modelValue":u=>e.weight=u,variant:"underlined",density:"compact","hide-details":"",readonly:!m.value,class:L(`${m.value?"":"bg-light-gray"}`)},null,8,["modelValue","onUpdate:modelValue","readonly","class"])]),a("div",ea,[l(x,{modelValue:e.item_value,"onUpdate:modelValue":u=>e.item_value=u,variant:"underlined",density:"compact","hide-details":"",readonly:!m.value,class:L(`${m.value?"":"bg-light-gray"}`)},null,8,["modelValue","onUpdate:modelValue","readonly","class"])]),a("div",aa,[l(x,{modelValue:e.country_of_origin,"onUpdate:modelValue":u=>e.country_of_origin=u,variant:"underlined",density:"compact","hide-details":"",readonly:!m.value,class:L(`${m.value?"":"bg-light-gray"}`)},null,8,["modelValue","onUpdate:modelValue","readonly","class"])]),a("div",la,[l(x,{value:e.reason_for_request,variant:"underlined",density:"compact","hide-details":"",class:"bg-light-gray",readonly:!0},null,8,["value"])]),m.value?(i(),v("div",sa,[l(x,{modelValue:e.remarks,"onUpdate:modelValue":u=>e.remarks=u,variant:"underlined",density:"compact","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),l(G,{modelValue:e.is_available,"onUpdate:modelValue":[u=>e.is_available=u,ae],class:"pa-0 ma-0 v-col-1","hide-details":"",variant:"underlined",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])])):R.value?(i(),v("div",ta,[l(x,{modelValue:e.remarks,"onUpdate:modelValue":u=>e.remarks=u,variant:"underlined",density:"compact","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),(T=(O=o.value)==null?void 0:O.data)!=null&&T.is_available?(i(),v("div",oa,[l(V,{class:"mt-3",icon:e.is_available?r(J):r(Q),color:`${e.is_available?"success":"error"}`},null,8,["icon","color"])])):b("",!0),l(G,{modelValue:e.is_received,"onUpdate:modelValue":[u=>e.is_received=u,ae],class:"pa-0 ma-0 v-col-1","hide-details":"",variant:"underlined",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])])):(i(),v("div",da,[l(x,{value:e.remarks,variant:"underlined",density:"compact","hide-details":"",class:"bg-light-gray",readonly:!0},null,8,["value"]),(I=(s=o.value)==null?void 0:s.data)!=null&&I.is_available?(i(),v("div",ra,[l(V,{class:"mt-3",icon:e.is_available?r(J):r(Q),color:`${e.is_available?"success":"error"}`},null,8,["icon","color"])])):b("",!0),((E=(U=o.value)==null?void 0:U.data)==null?void 0:E.status)=="complete"?(i(),v("div",ca,[l(V,{class:"mt-3",icon:e.is_received?r(te):r(oe),color:`${e.is_received?"success":"error"}`},null,8,["icon","color"])])):b("",!0)]))]}),_:2},1024))),128)),m.value?(i(),j(C,{key:0,class:"mt-3"},{default:n(()=>[ia]),_:1})):b("",!0),(q=(h=o.value)==null?void 0:h.data)!=null&&q.is_available?(i(),j(C,{key:1,class:"mt-6 mb-2"},{default:n(()=>[l(D,{loading:M.value,variant:"text",class:"v-col-12 text-center pt-2 font-weight-bold pb-0 d-flex justify-center"},{default:n(()=>{var e;return[a("div",null,[l(V,{icon:r(J),color:"success"},null,8,["icon"]),p(" AVAILABLE "),l(V,{icon:r(Q),color:"error",class:"ml-5"},null,8,["icon"]),p(" NOT AVAILABLE ")]),R.value?(i(),v("div",na,[ua,l(V,{icon:r(Ee)},null,8,["icon"]),p(" TICK RECEIVED ASSETS ")])):b("",!0),((e=o.value.data)==null?void 0:e.status)=="complete"?(i(),v("div",va,[l(V,{icon:r(te),color:"success"},null,8,["icon"]),p(" RECEIVED "),l(V,{icon:r(oe),color:"error",class:"ml-5"},null,8,["icon"]),p(" NOT RECEIVE ")])):b("",!0)]}),_:1},8,["loading"])]),_:1})):b("",!0),l(C,{class:"mt-3"},{default:n(()=>[a("div",pa,[l(N),l(N)])]),_:1}),((A=o.value.data)==null?void 0:A.request_approvals.length)>0?(i(),j(C,{key:2},{default:n(()=>{var e,g,w,O,T;return[a("div",_a,[ya,fa,a("div",ma,_((g=(e=o.value.data)==null?void 0:e.profile)==null?void 0:g.display_name),1),a("div",ha,_((O=(w=o.value.data)==null?void 0:w.profile)==null?void 0:O.designation),1),a("div",ga,_(r(W)((T=o.value.data)==null?void 0:T.created_at)),1)]),(i(!0),v(de,null,le(o.value.data.request_approvals,s=>{var I,U;return i(),v("div",{class:"v-col-12 v-col-md-3 pa-0 mb-4",key:s.id},[s.profile.role=="commercial-manager"&&r(t).query.pid==s.profile_id&&r(t).query.o==s.orders?(i(),v("div",ba,[s.status=="awaiting-approval"?(i(),v("div",Va,[a("div",{onClick:E=>ve(s),class:"cursor-pointer text-center py-5 v-col-6",style:K(`border:1px solid #ccc; ${r(t).query.pid==s.profile_id&&r(t).query.o==s.orders?"background-color: rgb(182, 3, 3);color:#fff;":"background-color: none;"}`)}," REJECT ",12,xa),a("div",{onClick:E=>F(s,"reject"),class:"cursor-pointer text-center py-5 v-col-6",style:K(`border:1px solid #ccc; ${r(t).query.pid==s.profile_id&&r(t).query.o==s.orders?"background-color: rgb(3, 167, 3);color:#fff;":"background-color: none"}`)}," APPROVE ",12,ka)])):s.status=="reject"||s.status=="done"||s.status=="pending"?(i(),v("div",Ea,[a("div",{onClick:E=>F(s),class:"cursor-pointer text-center mx-2 py-5",style:K(`border:1px solid #ccc; ${s.status=="reject"&&r(t).query.pid==s.profile_id&&r(t).query.o==s.orders?"background-color: rgb(182, 3, 3);color:#fff;":s.status=="done"?"background-color: none;color:rgb(3, 167, 3); font-weight:bold;font-size:17px;padding-top:16px !important;padding-bottom:16px !important;":"background-color: gray; color:#fff;"}`)},_(s.status=="done"?"APPROVED":"CLICK TO APPROVE"),13,Ca)])):b("",!0)])):(i(),v("div",{key:1,onClick:E=>F(s),class:"cursor-pointer text-center mx-2 py-5",style:K(`border:1px solid #ccc; ${s.status=="awaiting-approval"&&r(t).query.pid==s.profile_id&&r(t).query.o==s.orders?"background-color: rgb(182, 3, 3);color:#fff;":s.status=="done"?"background-color: none;color:rgb(3, 167, 3); font-weight:bold;font-size:17px;padding-top:16px !important;padding-bottom:16px !important;":"background-color: gray; color:#fff;"}`)},_(s.status=="done"?"APPROVED":"CLICK TO APPROVE"),13,Ra)),a("div",{class:L(`text-center py-1 font-weight-bold ${s.status=="reject"?"text-error text-uppercase":""}`)},_(s.status=="reject"?"Rejected":_e(s.approval_type))+" By ",3),a("div",qa,_((I=s.profile)==null?void 0:I.display_name),1),a("div",Aa,_((U=s.profile)==null?void 0:U.designation),1),a("div",wa,_(s.date_approved?r(W)(s.date_approved):""),1),s.reason_rejected?(i(),v("div",Oa,[p(" Reason "),l(N,{class:"my-2"}),p(" "+_(s.reason_rejected),1)])):b("",!0)])}),128))]}),_:1})):b("",!0),((k=(y=o.value)==null?void 0:y.data)==null?void 0:k.status)!=="complete"?(i(),j(C,{key:3},{default:n(()=>[a("div",Ta,[l(N),p(" You will receive a notification once you click the button. "),l(N)])]),_:1})):b("",!0),l(se,{width:"500",modelValue:B.value,"onUpdate:modelValue":c[5]||(c[5]=e=>B.value=e),persistent:""},{default:n(()=>[l(D,null,{default:n(()=>[l(Ce,null,{default:n(()=>[l(C,null,{default:n(()=>[Ia,a("div",Ua,[l(Re,{modelValue:S.value,"onUpdate:modelValue":c[3]||(c[3]=e=>S.value=e),label:"STATE YOUR REASON HERE",variant:"outlined"},null,8,["modelValue"])])]),_:1})]),_:1}),l(qe,null,{default:n(()=>[l(re),l(ce,{onClick:pe},{default:n(()=>[p("Cancel")]),_:1}),l(ce,{color:"success",disabled:!S.value,onClick:c[4]||(c[4]=e=>F(ee.value))},{default:n(()=>[p("Confirm")]),_:1},8,["disabled"]),l(re)]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Ae,{options:z.value},null,8,["options"])]}),_:1}))}};export{Ba as default};
