import{ag as j,i as z,r as f,M as U,b as r,c as C,l as n,G as w,e as b,k as o,m as v,z as _,X as E,j as F,F as R,d as N,Y as q,n as M,D,U as P,K as I,a3 as A,ah as H,A as K,V as L,af as X,q as G,a1 as $,I as V,Z as Y}from"./app-2c5a49eb.js";import{v as Z}from"./vue-filepond.esm-70028a9b.js";import{p as J,a as Q,b as W,c as ee,d as le,e as te,f as se}from"./filepond-plugin-image-edit-64c42389.js";const ae={class:"pa-3 d-flex flex-column",style:{"min-height":"400px"}},oe={class:"mt-auto d-flex justify-end"},ie={__name:"FilePondUploader",props:{options:{type:Object,default:null}},emits:["uploaded"],setup(k,{emit:h}){const l=k;j(d=>({f8b2ffe0:e.value.height,"065b8486":e.value.width}));const g=z(),s=f(null),e=f({max_files:l.options.max_files?l.options.max_files:4,allow_multiple:l.options.allow_multiple?l.options.allow_multiple:!0,height:l.options.height?l.options.height:"150px",width:l.options.width?l.options.width:"100%",max_file_size:l.options.max_file_size?l.options.max_file_size:"20MB",accepted_file_types:l.options.accepted_file_types?l.options.accepted_file_types:"image/jpeg, image/png",type:l.options.type?l.options.type:"asset"});U(()=>l.options,d=>{e.value={...e.value,...d},console.log("uploadOptions.value",e.value)}),console.log("uploadOptions",e.value);const y=f([]),i=Z(se,te,le,ee,W,Q,J),m={process:(d,t,re,B,fe,O,T,me,ge)=>{console.log("process file",t);const x=new FormData;x.append(d,t,t.name),x.append("profile_id",g.user.profile.id),x.append("file_id",t.id),x.append("type",e.value.type);const p=new XMLHttpRequest;return p.open("POST","/api/system/file/upload"),p.setRequestHeader("X-CSRF-TOKEN",document.getElementsByTagName("meta")["csrf-token"].content),p.setRequestHeader("Authorization",`Bearer ${g.token}`),p.upload.onprogress=S=>{B(S.lengthComputable,S.loaded,S.total)},p.onload=function(){p.status>=200&&p.status<300?(h("uploaded"),console.log("request.responseText",p.responseText),console.log("selectedFiles",y.value)):O("Process Error")},p.send(x),{abort:()=>{p.abort(),T()}}},revert:null,restore:null,load:null,fetch:null},u=()=>{console.log("FilePond has initialized")},c=(d,t)=>{console.log("file",d),console.log(" status",t)},a=d=>{s.value.processFiles(),console.log("files",d)};return console.log("uploadOptions.height",e.value.height),(d,t)=>(r(),C("div",ae,[n(w(i),{name:"filepond",ref_key:"pond",ref:s,instantUpload:"false",credits:"","allow-multiple":e.value.allow_multiple,maxFiles:e.value.max_files,maxFileSize:e.value.max_file_size,"accepted-file-types":e.value.accepted_file_types,server:m,files:y.value,onInit:u,onError:c,allowProcess:"false"},null,8,["allow-multiple","maxFiles","maxFileSize","accepted-file-types","files"]),b("div",oe,[n(_,{color:"primary",onClick:a},{default:o(()=>[v("Upload")]),_:1})])]))}},ne={class:"pa-3 d-flex flex-column",style:{"min-height":"400px"}},de={class:"mb-3"},ue={class:"mt-auto d-flex justify-end"},pe={__name:"MediaFiles",props:{multiSelect:{type:Boolean,default:!1}},emits:["selected"],setup(k,{emit:h}){const l=z(),g=window.location.origin,s=f([]),e=f(!1);(async()=>{e.value=!0,await I(l.token).get("/api/system/file/all").then(a=>{e.value=!1,s.value=a.data.data,console.log("files.value",s.value)}).catch(a=>{console.log("getFiles",a),e.value=!1})})();const i=f([]),m=a=>{i.value.find(t=>t.id==a.id)?i.value=i.value.filter(t=>t.id!==a.id):i.value.push(a),console.log("selectedFile.value",i.value)},u=E(()=>i.value.map(a=>a.id)),c=()=>{h("selected",i.value)};return(a,d)=>(r(),C("div",ne,[b("div",de,[s.value.length>0?(r(),F(D,{key:0,class:"ma-0"},{default:o(()=>[(r(!0),C(R,null,N(s.value,t=>(r(),C("div",{key:t.id,class:"v-col-6 v-col-md-2 pa-1"},[n(q,{cover:"","aspect-ratio":1,class:"cursor-pointer","lazy-src":w(g)+"/assets/images/placeholder-image.png",src:w(g)+"/file/"+t.path,onClick:()=>m(t),style:M(`border: 4px solid ${u.value.includes(t.id)==!0?"#ffed00":"transparent"}`)},null,8,["lazy-src","src","onClick","style"])]))),128))]),_:1})):(r(),F(P,{key:1,class:"w-100 d-flex align-center justify-center","min-height":"150",color:"grey-lighten-3"},{default:o(()=>[v(" No media files at the moment ")]),_:1}))]),b("div",ue,[n(_,{disabled:!(i.value.length>0),color:"primary",onClick:c},{default:o(()=>[v("Select")]),_:1},8,["disabled"])])]))}},ce={class:"d-flex align-center flex-wrap"},ye={__name:"Studio",props:{options:{type:Object,default:null}},emits:["select"],setup(k,{emit:h}){const l=k,g=f({height:"150px",width:"100%",type:l.options.type?l.options.type:"asset"}),s=f({dialog:!1,multiSelect:!1});U(()=>l.options,m=>{s.value={...s.value,...m},console.log("watch studio settings",s.value)});const e=f("studio"),y=m=>{h("select",m),s.value.dialog=!1},i=()=>{e.value="studio"};return(m,u)=>(r(),F(Y,{modelValue:s.value.dialog,"onUpdate:modelValue":u[2]||(u[2]=c=>s.value.dialog=c),persistent:"",width:"1000",style:{"min-height":"400px"}},{activator:o(({props:c})=>[n(_,A(c,{class:"mb-3","append-icon":w(H)}),{default:o(()=>[v("Upload")]),_:2},1040,["append-icon"])]),default:o(({isActive:c})=>[n(K,null,{default:o(()=>[n(L,{class:"d-flex justify-space-between align-center"},{default:o(()=>[v(" Media Files "),n(_,{icon:w(X),variant:"flat",size:"small",onClick:a=>c.value=!1},null,8,["icon","onClick"])]),_:2},1024),n(G,null,{default:o(()=>[b("div",ce,[n(_,{class:$(`${e.value=="uploader"?"bg-grey-lighten-4":"bg-primary"} rounded-0`),variant:"flat",onClick:u[0]||(u[0]=a=>e.value="uploader"),style:{"border-top-left-radius":"4px !important"}},{default:o(()=>[v(" Uploader ")]),_:1},8,["class"]),n(_,{class:$(`${e.value=="studio"?"bg-grey-lighten-4":"bg-primary"} rounded-0`),variant:"flat",onClick:u[1]||(u[1]=a=>e.value="studio"),style:{"border-top-right-radius":"4px !important"}},{default:o(()=>[v(" Media Files ")]),_:1},8,["class"])]),b("div",null,[n(P,{class:"bg-grey-lighten-4"},{default:o(()=>[e.value=="studio"?(r(),F(pe,{key:0,"multi-select":s.value.multiSelect,onSelected:y},null,8,["multi-select"])):V("",!0),e.value=="uploader"?(r(),F(ie,{key:1,onUploaded:i,options:g.value},null,8,["options"])):V("",!0)]),_:1})])]),_:1})]),_:2},1024)]),_:1},8,["modelValue"]))}};export{ye as _};
