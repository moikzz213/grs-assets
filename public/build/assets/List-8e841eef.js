import{r as s,a as ee,u as te,G as le,H as ae,I as oe,c as N,w as c,m as se,n as R,o as V,d as i,b as a,k as ie,V as ne,i as re,h as ue,s as U,J as _,x as de,e as b,p as T,q as ce,ad as me,y as k,t as r,K as pe,C as ve,L as fe,F as ge,M as ye,z as M,N as Se}from"./app-c29f30ab.js";import{_ as xe}from"./AppPageHeader-431bbe58.js";import{d as f,e as g}from"./encrypt-2166df7a.js";import{_ as Ce}from"./AppSnackBar-cc7aa73e.js";import{u as K}from"./formatDate-559e9d83.js";const he={class:"v-col-12"},Ve=a("div",{class:"mr-auto"},"Asset Requests",-1),_e={class:"v-col-12 v-col-md"},be={class:"v-col-12 v-col-md"},qe={class:"v-col-12 v-col-md"},we={class:"v-col-12 v-col-md-2"},ke={class:"v-col-12 v-col-md-2"},Ie=a("th",{class:"text-left text-capitalize"},"SN No.",-1),$e=a("br",null,null,-1),ze=a("small",null,"PENDING",-1),De=a("br",null,null,-1),Ne=a("small",null,"(DD/MM/YY)",-1),Re=a("br",null,null,-1),Le=a("small",null,"(DD/MM/YY)",-1),Ae=a("th",{class:"text-right text-capitalize last-child-action"},null,-1),je={class:"last-child-action"},Pe={class:"d-flex align-center justify-end"},Oe={__name:"List",setup(Be){const O=s({status:!1,type:"primary",text:null}),p=ee(),L=te(),I=le(),u=s({loading:!1,data:[]}),$=s(0),E=s(0),v=s(""),Y=s([10,20,50,100]),y=s(10),o=s({}),J=()=>{localStorage.setItem("request-filter-row",g(y.value)),m()},q=l=>{z.value="",n.value==1?(l=="company"?localStorage.setItem("request-filter-company",g(o.value.company_id)):l=="location"?localStorage.setItem("request-filter-location",g(o.value.location_id)):l=="from"?localStorage.setItem("request-filter-from",g(o.value.from)):l=="status"&&localStorage.setItem("request-filter-status",g(o.value.status)),m()):n.value=1},A=()=>{localStorage.setItem("request-asset-search",g(v.value)),m()},S=l=>{l=="search"?(v.value="",localStorage.setItem("request-asset-search",""),m()):l=="company"?localStorage.setItem("request-filter-company",""):l=="location"?localStorage.setItem("request-filter-location",""):l=="from"?localStorage.setItem("request-filter-from",""):l=="status"&&localStorage.setItem("request-filter-status","")},n=s(I.params&&I.params.page?I.params.page:1),w=s([]),z=s(""),j=s(0),d=l=>{u.value.loading=!0,w.value[0]=l,j.value%2?w.value[1]="DESC":w.value[1]="ASC",j.value++,z.value=JSON.stringify(w.value),m()},P=s([]),G=async()=>{await R(p.token).get("/api/fetch/companies").then(l=>{P.value=l.data}).catch(l=>{})},D=s([]),H=async()=>{await R(p.token).get("/api/fetch/locations/non-paginated/data").then(l=>{D.value=l.data}).catch(l=>{})},Q=s([{id:"pending",title:"Pending"},{id:"awaiting-approval",title:"Awaiting Approval"},{id:"reject",title:"Rejected"},{id:"cancelled",title:"Cancelled"},{id:"complete",title:"Completed"}]),W=l=>l=="reject"?"Rejected":l=="complete"?"Completed":l,m=async()=>{u.value.loading=!0,await R(p.token).get("/api/fetch/request-assets/by-requestor/request?userid="+p.user.profile.id+"&role="+p.user.profile.role+"&page="+n.value+"&show="+y.value+"&search="+v.value+"&sort="+z.value+"&filter="+JSON.stringify(o.value)).then(l=>{$.value=l.data.last_page?l.data.last_page:l.data.length,n.value=l.data.current_page?l.data.current_page:n.value,E.value=l.data.total?l.data.total:l.data.length,u.value.data=l.data.data?l.data.data:l.data,u.value.loading=!1}).catch(l=>{u.value.loading=!1,localStorage.setItem("request-filter-company",null),localStorage.setItem("request-filter-location",null),localStorage.setItem("request-filter-from",null),localStorage.setItem("request-filter-status",null),localStorage.setItem("request-filter-row",10)})};ae(n,(l,e)=>{n.value&&l!=e&&(L.push({name:"PaginatedRequestAsset",params:{page:n.value}}).catch(t=>{}),m(n.value))});const X=l=>{L.push({name:"EditRequestAsset",params:{id:l}}).catch(e=>{console.log(e)})},Z=(l,e=6)=>{let t="00000"+l;return t.substring(t.length-e)};return oe(()=>{let l=localStorage.getItem("request-asset-search"),e=localStorage.getItem("request-filter-company"),t=localStorage.getItem("request-filter-location"),x=localStorage.getItem("request-filter-from"),C=localStorage.getItem("request-filter-status"),h=localStorage.getItem("request-filter-row");l&&(v.value=f(l)),e&&(o.value.company_id=f(e)),t&&(o.value.location_id=f(t)),x&&(o.value.from=f(x)),C&&(o.value.status=f(C)),h&&(y.value=f(h)),m().then(()=>{G().then(()=>{H()})})}),(l,e)=>(V(),N(se,null,{default:c(()=>[i(xe,{title:"Asset request page"}),i(U,{class:"mb-3"},{default:c(()=>[a("div",he,[i(ie,{loading:u.value.loading},{default:c(()=>[i(ne,{class:"d-flex align-center mb-3 pa-3"},{default:c(()=>[Ve,i(re,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=t=>v.value=t),variant:"outlined",density:"compact",clearable:"",label:"Search (ex. SN-5000035 )",type:"text","hide-details":"",style:{"max-width":"300px"},"onClick:appendOuter":A,onKeydown:ue(A,["enter"]),"onClick:clear":e[1]||(e[1]=t=>S("search"))},null,8,["modelValue","onKeydown"])]),_:1}),i(U,{class:"px-3"},{default:c(()=>[a("div",_e,[i(_,{items:P.value,modelValue:o.value.company_id,"onUpdate:modelValue":[e[2]||(e[2]=t=>o.value.company_id=t),e[3]||(e[3]=t=>q("company"))],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Company","onClick:clear":e[4]||(e[4]=t=>S("company"))},null,8,["items","modelValue"])]),a("div",be,[i(_,{items:D.value,modelValue:o.value.from,"onUpdate:modelValue":[e[5]||(e[5]=t=>o.value.from=t),e[6]||(e[6]=t=>q("from"))],variant:"outlined",density:"compact","hide-details":"",label:"Location From","item-value":"id",clearable:"","item-title":"title","onClick:clear":e[7]||(e[7]=t=>S("from"))},null,8,["items","modelValue"])]),a("div",qe,[i(_,{items:D.value,modelValue:o.value.location_id,"onUpdate:modelValue":[e[8]||(e[8]=t=>o.value.location_id=t),e[9]||(e[9]=t=>q("location"))],variant:"outlined",density:"compact","hide-details":"",label:"Location To","item-value":"id",clearable:"","item-title":"title","onClick:clear":e[10]||(e[10]=t=>S("location"))},null,8,["items","modelValue"])]),a("div",we,[i(_,{items:Q.value,modelValue:o.value.status,"onUpdate:modelValue":[e[11]||(e[11]=t=>o.value.status=t),e[12]||(e[12]=t=>q("status"))],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Status","onClick:clear":e[13]||(e[13]=t=>S("status"))},null,8,["items","modelValue"])]),a("div",ke,[i(_,{items:Y.value,modelValue:y.value,"onUpdate:modelValue":[e[14]||(e[14]=t=>y.value=t),J],variant:"outlined",density:"compact","hide-details":"",label:"Show"},null,8,["items","modelValue"])])]),_:1}),i(de,null,{default:c(()=>[a("thead",null,[a("tr",null,[Ie,a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[15]||(e[15]=t=>d("company_id"))}," Company "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[16]||(e[16]=t=>d("transferred_from"))}," From "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[17]||(e[17]=t=>d("transferred_to"))}," To "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[18]||(e[18]=t=>d("subject"))}," Subject "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[19]||(e[19]=t=>d("profile_id"))}," Requestor "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[20]||(e[20]=t=>d("reminder_profile_id"))},[b(" Approval"),$e,ze]),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[21]||(e[21]=t=>d("status"))}," Status "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[22]||(e[22]=t=>d("created_at"))},[b(" D.Requested"),De,Ne]),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[23]||(e[23]=t=>d("date_closed"))},[b(" D.Closed"),Re,Le]),Ae])]),a("tbody",null,[(V(!0),T(ge,null,ce(u.value.data,t=>{var x,C,h,B,F;return V(),T("tr",{key:t.id,class:me(`${k(p).user.profile.id==t.reminder_profile_id?"bg-blue-lighten-5":""} `)},[a("td",null,"SN-5"+r(Z(t.id)),1),a("td",null,r((x=t.company)==null?void 0:x.title),1),a("td",null,r((C=t.transfer_from)==null?void 0:C.title),1),a("td",null,r((h=t.transfer_to)==null?void 0:h.title),1),a("td",null,r(t.subject),1),a("td",null,r((B=t.profile)==null?void 0:B.display_name),1),a("td",null,r((F=t.reminder_profile)==null?void 0:F.display_name),1),a("td",null,[i(pe,{class:"text-uppercase",size:"small",color:`${t.status.toLowerCase()=="complete"?"success":t.status.toLowerCase()=="pending"||t.status.toLowerCase()=="awaiting-approval"?"warning":"error"}`},{default:c(()=>[b(r(W(t.status)),1)]),_:2},1032,["color"])]),a("td",null,r(k(K)(t.created_at)),1),a("td",null,r(t.date_closed&&t.date_closed!="0000-00-00"?k(K)(t.date_closed):""),1),a("td",je,[a("div",Pe,[i(ve,{size:"small",onClick:()=>X(t.id),icon:k(fe),class:"mx-1"},null,8,["onClick","icon"])])])],2)}),128))])]),_:1}),u.value.data.length==0?(V(),N(ye,{key:0,class:"pa-3 text-center w-100"},{default:c(()=>[b("No records found")]),_:1})):M("",!0)]),_:1},8,["loading"]),$.value>1?(V(),N(Se,{key:0,modelValue:n.value,"onUpdate:modelValue":e[24]||(e[24]=t=>n.value=t),class:"my-4",length:$.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:u.value.loading},null,8,["modelValue","length","disabled"])):M("",!0)])]),_:1}),i(Ce,{options:O.value},null,8,["options"])]),_:1}))}};export{Oe as default};
