import{r as l,a as Y,u as Z,G as ee,H as ae,I as te,c as m,w as i,m as le,n as D,o as p,d as s,v as B,k as F,s as K,J as se,_ as oe,i as ne,h as de,b as o,x as ie,y as c,j as b,e as N,z as g,p as L,q as ue,t as O,K as ce,L as re,as as pe,at as ve,F as me,M as fe,N as ge}from"./app-6a27533d.js";import{_ as ye}from"./AppPageHeader-05f5c601.js";import{d as he,e as _e}from"./encrypt-2ba6ce3d.js";import{_ as xe}from"./AppSnackBar-9b63c151.js";import{_ as ke}from"./DialogForm-f8fec764.js";import"./index.esm-5c823187.js";import"./Studio-79d4fd5b.js";import"./formatDate-559e9d83.js";const be=o("div",{class:"mt-2 mr-2"},"Show",-1),Ve={class:"v-col-12"},Ce={class:"text-right text-capitalize"},we={class:"d-flex align-center justify-end"},Ee={__name:"List",setup(Se){const x=l({status:!1,type:"primary",text:null}),n=Y(),I=Z(),V=ee(),u=l({loading:!1,data:[]}),C=l(0),T=l(0),f=l(""),U=l([10,20,50,100]),w=l(10),q=()=>{v()},P=()=>{localStorage.setItem("model-search",_e(f.value)),v()},J=()=>{f.value="",localStorage.setItem("model-search",""),v()},r=l(V.params&&V.params.page?V.params.page:1),k=l([]),$=l(""),j=l(0),S=e=>{u.value.loading=!0,k.value[0]=e,j.value%2?k.value[1]="DESC":k.value[1]="ASC",j.value++,$.value=JSON.stringify(k.value),v()},v=async()=>{u.value.loading=!0,await D(n.token).get("/api/models/all?page="+r.value+"&show="+w.value+"&search="+f.value+"&sort="+$.value).then(e=>{C.value=e.data.last_page?e.data.last_page:e.data.length,r.value=e.data.current_page?e.data.current_page:r.value,T.value=e.data.total?e.data.total:e.data.length,u.value.data=e.data.data?e.data.data:e.data,u.value.loading=!1}).catch(e=>{u.value.loading=!1,console.log(e)})};ae(r,(e,a)=>{r.value&&e!=a&&(I.push({name:"PaginatedModels",params:{page:r.value}}).catch(d=>{}),v(r.value))});const G=e=>{y.value={},_.value=e},H=async e=>{_.value=!1,e.profile_id=n.user.profile.id,await D(n.token).post("/api/models/store-update/data",e).then(a=>{x.value={status:!0,type:"success",text:a.data.message},v()}).catch(a=>{u.value.loading=!1,console.log(a)})},y=l({}),Q=l([{name:"title",label:"Model",required:!0,type:"text"}]),W=e=>{y.value=Object.assign({},e),y.value.type="model",_.value=!0},h=l(!1),z=async(e,a)=>{x.value={status:!0,type:"info",text:"Please wait..."},h.value=!0;let d={id:e,status:a,profile_id:n.user.profile.id};await D(n.token).post("/api/models/status-change/data",d).then(t=>{setTimeout(()=>{x.value={status:!0,type:"success",text:t.data.message},v(),h.value=!1},600)}).catch(t=>{u.value.loading=!1,console.log(t)})},_=l(!1),X=()=>{y.value="",_.value=!0};return te(()=>{let e=localStorage.getItem("model-search");e&&(f.value=he(e)),v()}),(e,a)=>(p(),m(le,null,{default:i(()=>[s(ye,{title:"Model List"}),s(K,{class:"mb-3"},{default:i(()=>[s(B,{class:"v-col-12 mt-1 col-sm-12 py-0"},{default:i(()=>[s(F,{class:"px-5"},{default:i(()=>[s(K,null,{default:i(()=>[s(B,{class:"v-col-6 v-col-md-2 v-col-sm-6 d-flex my-2"},{default:i(()=>[be,s(se,{items:U.value,modelValue:w.value,"onUpdate:modelValue":[a[0]||(a[0]=d=>w.value=d),q],variant:"outlined",density:"compact","hide-details":"",label:"Entry"},null,8,["items","modelValue"])]),_:1}),s(oe),s(B,{class:"v-col-6 v-col-md-3 v-col-sm-6 my-2"},{default:i(()=>[s(ne,{modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=d=>f.value=d),variant:"outlined",density:"compact",clearable:"",label:"Search",type:"text","hide-details":"","onClick:appendOuter":P,onKeydown:de(P,["enter"]),"onClick:clear":a[2]||(a[2]=d=>J("search"))},null,8,["modelValue","onKeydown"])]),_:1})]),_:1})]),_:1})]),_:1}),o("div",Ve,[s(F,{loading:u.value.loading},{default:i(()=>[s(ie,null,{default:i(()=>{var d;return[o("thead",null,[o("tr",null,[o("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[3]||(a[3]=t=>S("title"))}," Model "),o("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[4]||(a[4]=t=>S("profile_id"))}," Updated By "),o("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[5]||(a[5]=t=>S("status"))}," Status "),o("th",Ce,[c(n).user.role=="superadmin"||(d=c(n).capabilities)!=null&&d.includes("add")?(p(),m(b,{key:0,size:"small",color:"primary",onClick:X},{default:i(()=>[N("Add New")]),_:1})):g("",!0)])])]),o("tbody",null,[(p(!0),L(me,null,ue(u.value.data,t=>{var E,M,A,R;return p(),L("tr",{key:t.id},[o("td",null,O(t.title),1),o("td",null,O((E=t.profile)==null?void 0:E.display_name),1),o("td",null,[s(ce,{class:"text-uppercase",size:"small",color:`${t.status=="active"?"success":"error"}`},{default:i(()=>[N(O(t.status),1)]),_:2},1032,["color"])]),o("td",null,[o("div",we,[c(n).user.role=="superadmin"||(M=c(n).capabilities)!=null&&M.includes("edit")?(p(),m(b,{key:0,loading:h.value,onClick:()=>W(t),icon:c(re),title:"Edit",density:"compact",class:"mx-2"},null,8,["loading","onClick","icon"])):g("",!0),t.status=="active"&&(c(n).user.role=="superadmin"||(A=c(n).capabilities)!=null&&A.includes("delete"))?(p(),m(b,{key:1,density:"compact",loading:h.value,icon:c(pe),onClick:()=>z(t.id,"disabled"),title:"Disable",class:"mx-2 text-error"},null,8,["loading","icon","onClick"])):g("",!0),t.status=="disabled"&&(c(n).user.role=="superadmin"||(R=c(n).capabilities)!=null&&R.includes("delete"))?(p(),m(b,{key:2,loading:h.value,density:"compact",onClick:()=>z(t.id,"active"),icon:c(ve),title:"Enable",class:"mx-2 text-success"},null,8,["loading","onClick","icon"])):g("",!0)])])])}),128))])]}),_:1}),u.value.data.length==0?(p(),m(fe,{key:0,class:"pa-3 text-center w-100"},{default:i(()=>[N("No records found")]),_:1})):g("",!0)]),_:1},8,["loading"]),C.value>1?(p(),m(ge,{key:0,modelValue:r.value,"onUpdate:modelValue":a[6]||(a[6]=d=>r.value=d),class:"my-4",length:C.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:u.value.loading},null,8,["modelValue","length","disabled"])):g("",!0)])]),_:1}),s(ke,{"free-form":Q.value,"add-new-dialog":_.value,title:"Model","data-object":y.value,onCancelled:G,onSave:H},null,8,["free-form","add-new-dialog","data-object"]),s(xe,{options:x.value},null,8,["options"])]),_:1}))}};export{Ee as default};
