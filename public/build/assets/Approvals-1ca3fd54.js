import{G as he,r as y,c as j,w as n,m as ge,o as i,d as l,b as a,t as f,e as p,C as r,s as C,E as B,ae as J,y as b,p as v,q as te,B as V,ag as be,k as D,T as Ve,U as xe,R as ke,S as se,aw as Ee,i as x,as as L,ax as Q,ay as W,az as oe,aA as de,F as re,aB as Ce,ad as z,f as Re,W as Ae,Z as qe,_ as ce,j as ie}from"./app-9890d8ad.js";import{u as X}from"./formatDate-b9aad8c5.js";import{_ as we}from"./AppSnackBar-d1c561e7.js";const Oe={class:"v-col-3 mt-auto font-weight-bold"},Te={class:"d-flex"},Ue=a("div",{class:"mr-2"},"FROM:",-1),Ie={class:"d-flex"},je=a("div",{class:"mr-6 pr-2"},"TO:",-1),Se={class:"v-col-6 text-center"},Be=a("img",{src:"/assets/images/grandiose-logo.jpg",style:{"max-height":"100px"}},null,-1),Ne=a("br",null,null,-1),Pe={class:"v-col-3 mt-auto font-weight-bold text-right"},$e=a("br",null,null,-1),De=a("div",{class:"v-col-12 v-col-md-1 py-1"},"IMAGE",-1),Le=a("div",{class:"v-col-12 v-col-md-2 py-1"},"ITEM DESCRIPTION",-1),Fe=a("div",{class:"v-col-12 v-col-md-1 py-1"},"ASSET NO",-1),ze=a("div",{class:"v-col-12 v-col-md-1 py-1"},"QTY",-1),Ke=a("div",{class:"v-col-12 v-col-md-1 py-1"},"WEIGHT",-1),Me=a("div",{class:"v-col-12 v-col-md-1 py-1"},"ITEM VALUE",-1),He=a("div",{class:"v-col-12 v-col-md-1 py-1"},"COUNTRY OF ORIGIN",-1),Ge=a("div",{class:"v-col-12 v-col-md-2 py-1"},[p(" REMARKS"),a("br"),p("REASON FOR REQUEST ")],-1),Ye={class:"v-col-12 v-col-md-2 py-1 d-flex justify-space-between"},Je={class:"v-col-12 v-col-md-3 py-1 d-flex"},Qe={key:0},We={style:{height:"680px",width:"100%"},class:"d-flex align-center justify-center"},Xe={class:"v-col-12 v-col-md-1 py-1"},Ze={class:"v-col-12 v-col-md-1 py-1"},ea={class:"v-col-12 v-col-md-1 py-1"},aa={class:"v-col-12 v-col-md-1 py-1"},la={class:"v-col-12 v-col-md-1 py-1"},ta={class:"v-col-12 v-col-md-2 py-1"},sa={key:0,class:"v-col-12 v-col-md-2 py-1 d-flex justify-space-between"},oa={key:1,class:"v-col-12 v-col-md-2 py-1 d-flex justify-space-between"},da={key:0},ra={key:2,class:"v-col-12 v-col-md-2 py-1 d-flex justify-space-between"},ca={key:0},ia={key:1},na=a("div",{class:"v-col-12 text-center font-weight-bold text-info"},[p(" YOU CAN UPDATE SOME DATA AND"),a("br"),p(" PLEASE TICK CHECKBOX IF ASSET IS AVAILABLE BEFORE CLICKING THE APPROVE BUTTON ")],-1),ua={key:0,class:"ml-5 d-flex"},va=a("div",{class:"px-2 mr-5"},"|",-1),pa={key:1,class:"ml-6"},_a={class:"v-col-12 px-0 my-0"},ya={class:"v-col-12 v-col-md-3 pa-0 mb-4"},fa=a("div",{class:"text-center mx-2 py-4 font-weight-bold",style:{color:"rgb(3, 167, 3)",border:"1px solid #ccc","font-size":"17px"}}," APPROVED ",-1),ma=a("div",{class:"text-center py-1 font-weight-bold"}," Requested By ",-1),ha={class:"text-center py-1"},ga={class:"text-center py-1"},ba={class:"text-center"},Va={key:0},xa={key:0,class:"d-flex"},ka=["onClick"],Ea=["onClick"],Ca={key:1},Ra=["onClick"],Aa=["onClick"],qa={class:"text-center py-1"},wa={class:"text-center py-1"},Oa={class:"text-center"},Ta={key:2,class:"v-col-12",style:{border:"1px solid red"}},Ua={class:"v-col-12 text-center"},Ia=a("div",{class:"v-col-12 text-center mt-3 font-weight-bold"}," REASON FOR REJECTION ",-1),ja={class:"v-col-12"},$a={__name:"Approvals",setup(Sa){const o=he(),Z=y(!0),s=y({}),K=y({}),m=y(!1),ne=y(!1),R=y(!1),N=y([]),P=y(!1),S=y(""),M=y(!1),ee=async()=>{let d={id:o.query.id,profile_id:o.query.pid,order:o.query.o};if(!o.query.id||!o.query.pv){Z.value=!1;return}await axios.post("/api/public/fetch/request-assets/data",d).then(c=>{var h,A,q,_,k;if(s.value=c.data,!s.value.access){Z.value=!1;return}((q=(A=(h=s.value)==null?void 0:h.data)==null?void 0:A.request_approvals)==null?void 0:q.length)>0&&(m.value=s.value.data.request_approvals.filter(e=>{var g;return e.profile_id==o.query.pid&&e.orders==o.query.o&&e.status=="awaiting-approval"&&((g=e.profile)==null?void 0:g.role)=="asset-supervisor"})[0],ne.value=s.value.data.request_approvals.filter(e=>{var g;return e.profile_id==o.query.pid&&e.orders==o.query.o&&e.status=="awaiting-approval"&&((g=e.profile)==null?void 0:g.role)=="commercial-manager"})[0],R.value=s.value.data.request_approvals.filter(e=>e.profile_id==o.query.pid&&e.orders==o.query.o&&e.status=="awaiting-approval"&&e.approval_type=="receiver")[0],Y.value=s.value.data.request_approvals[s.value.data.request_approvals.length-1].approval_type,(R.value||m.value)&&(M.value=!0)),N.value=(k=(_=s.value)==null?void 0:_.data)==null?void 0:k.items}).catch(c=>{console.log(c.response.data)})},ue=y(window.location.origin),H=y(!1),G=y(1),ve=d=>{G.value=d,H.value=!0},Y=y(""),ae=y({}),pe=d=>{P.value=!0,ae.value=d},_e=()=>{P.value=!1,S.value=""},F=(d,c=null)=>{if(P.value=!1,(d.status=="awaiting-approval"||d.status=="reject")&&o.query.pid==d.profile_id&&o.query.o==d.orders){K.value={status:!0,type:"info",text:"Please wait..."};let h=[];(m.value||R.value)&&(h=N.value.map((_,k)=>(delete _.created_at,delete _.assets,delete _.updated_at,delete _.attachment,_)));let A={},q="";S.value&&c&&(q=S.value),A={profile_id:o.query.pid,id:o.query.id,order:o.query.o,type:s.value.data.types,assets:h,is_reject:q,requestor_id:s.value.data.profile_id},axios.post("/api/public/store/request-asset/approve-data",A).then(_=>{let k="success";_.data.success||(k="error"),K.value={status:!0,type:k,text:_.data.message},M.value=!1,setTimeout(()=>{ee()},500)}).catch(_=>{console.log(_.response.data)});return}},ye=d=>{if(d=="approve")return"Approval By";if(d=="reviewer")return"Review By";if(d=="receiver")return"Received";if(d=="transport")return"Trasportation Arranged";if(d=="releasing")return"Asset Released";if(d=="verify")return"Verified By"},fe=()=>{let d=R.value;N.value.map(c=>{d?c.is_received=$.value:c.is_available=$.value})},me=(d,c=6)=>{let h="00000"+d;return h.substring(h.length-c)},le=()=>{let d=!0,c=R.value;N.value.map(h=>{c?h.is_received||(d=!1):h.is_available||(d=!1)}),$.value=d},$=y(!1);return ee(),(d,c)=>(i(),j(ge,{style:{"max-width":"1200px"},class:"mt-0 pt-0"},{default:n(()=>{var h,A,q,_,k;return[l(C,{class:"mt-0 pt-0"},{default:n(()=>{var e,g,w,O,T,t,U,I,E;return[a("div",Oe,[a("div",Te,[Ue,a("div",null,f((g=(e=s.value.data)==null?void 0:e.transfer_from)==null?void 0:g.title),1)]),a("div",Ie,[je,a("div",null,f((O=(w=s.value.data)==null?void 0:w.transfer_to)==null?void 0:O.title),1)])]),a("div",Se,[Be,Ne,a("strong",null,f((t=(T=s.value.data)==null?void 0:T.setup)==null?void 0:t.title),1)]),a("div",Pe,[p(" SN-"+f(((I=(U=s.value)==null?void 0:U.data)==null?void 0:I.types)=="request"?"5":"3")+f(me(1)),1),$e,p(" "+f(r(X)((E=s.value.data)==null?void 0:E.created_at)),1)])]}),_:1}),l(B,{class:"my-5"}),l(C,null,{default:n(()=>[De,Le,Fe,ze,Ke,Me,He,Ge,a("div",Ye,[p(" REMARKS "),m.value||R.value?(i(),j(J,{key:0,modelValue:$.value,"onUpdate:modelValue":[c[0]||(c[0]=e=>$.value=e),fe],class:"pa-0 ma-0 v-col-1","hide-details":"",variant:"underlined",density:"compact"},null,8,["modelValue"])):b("",!0)])]),_:1}),(i(!0),v(re,null,te(N.value,(e,g)=>(i(),j(C,{class:"mt-1",key:e.id},{default:n(()=>{var w,O,T,t,U,I,E;return[a("div",Je,[(w=e.attachment)!=null&&w.id?(i(),v("div",Qe,[l(D,{onClick:()=>ve(g),maxHeight:"40",variant:"text",class:"ma-2"},{default:n(()=>[l(V,{size:"large",icon:r(be),color:"success"},null,8,["icon"])]),_:2},1032,["onClick"]),l(se,{modelValue:H.value,"onUpdate:modelValue":c[2]||(c[2]=u=>H.value=u),width:"95%","max-width":"900"},{default:n(()=>[l(D,{class:"bg-black"},{default:n(()=>[l(Ve,{"hide-delimiter-background":"","show-arrows":"hover",height:"680px",modelValue:G.value,"onUpdate:modelValue":c[1]||(c[1]=u=>G.value=u)},{default:n(()=>[l(xe,{"reverse-transition":"fade",transition:"fade"},{default:n(()=>[a("div",We,[l(ke,{src:ue.value+"/file/"+e.attachment.path},null,8,["src"])])]),_:2},1024)]),_:2},1032,["modelValue"])]),_:2},1024)]),_:2},1032,["modelValue"])])):(i(),j(D,{key:1,maxHeight:"40",variant:"text",class:"ma-2"},{default:n(()=>[l(V,{size:"large",icon:r(Ee)},null,8,["icon"])]),_:1})),l(x,{value:e.item_description,variant:"underlined",density:"compact","hide-details":"",class:"bg-light-gray",readonly:!0},null,8,["value"])]),a("div",Xe,[l(x,{modelValue:e.asset_code,"onUpdate:modelValue":u=>e.asset_code=u,variant:"underlined",density:"compact","hide-details":"",readonly:!m.value,class:L(`${m.value?"":"bg-light-gray"}`)},null,8,["modelValue","onUpdate:modelValue","readonly","class"])]),a("div",Ze,[l(x,{value:e.qty,variant:"underlined",density:"compact","hide-details":"",class:"bg-light-gray",type:"number",readonly:!0},null,8,["value"])]),a("div",ea,[l(x,{modelValue:e.weight,"onUpdate:modelValue":u=>e.weight=u,variant:"underlined",density:"compact","hide-details":"",readonly:!m.value,class:L(`${m.value?"":"bg-light-gray"}`)},null,8,["modelValue","onUpdate:modelValue","readonly","class"])]),a("div",aa,[l(x,{modelValue:e.item_value,"onUpdate:modelValue":u=>e.item_value=u,variant:"underlined",density:"compact","hide-details":"",readonly:!m.value,class:L(`${m.value?"":"bg-light-gray"}`)},null,8,["modelValue","onUpdate:modelValue","readonly","class"])]),a("div",la,[l(x,{modelValue:e.country_of_origin,"onUpdate:modelValue":u=>e.country_of_origin=u,variant:"underlined",density:"compact","hide-details":"",readonly:!m.value,class:L(`${m.value?"":"bg-light-gray"}`)},null,8,["modelValue","onUpdate:modelValue","readonly","class"])]),a("div",ta,[l(x,{value:e.reason_for_request,variant:"underlined",density:"compact","hide-details":"",class:"bg-light-gray",readonly:!0},null,8,["value"])]),m.value?(i(),v("div",sa,[l(x,{modelValue:e.remarks,"onUpdate:modelValue":u=>e.remarks=u,variant:"underlined",density:"compact","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),l(J,{modelValue:e.is_available,"onUpdate:modelValue":[u=>e.is_available=u,le],class:"pa-0 ma-0 v-col-1","hide-details":"",variant:"underlined",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])])):R.value?(i(),v("div",oa,[l(x,{modelValue:e.remarks,"onUpdate:modelValue":u=>e.remarks=u,variant:"underlined",density:"compact","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),(T=(O=s.value)==null?void 0:O.data)!=null&&T.is_available?(i(),v("div",da,[l(V,{class:"mt-3",icon:e.is_available?r(Q):r(W),color:`${e.is_available?"success":"error"}`},null,8,["icon","color"])])):b("",!0),l(J,{modelValue:e.is_received,"onUpdate:modelValue":[u=>e.is_received=u,le],class:"pa-0 ma-0 v-col-1","hide-details":"",variant:"underlined",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])])):(i(),v("div",ra,[l(x,{value:e.remarks,variant:"underlined",density:"compact","hide-details":"",class:"bg-light-gray",readonly:!0},null,8,["value"]),(U=(t=s.value)==null?void 0:t.data)!=null&&U.is_available?(i(),v("div",ca,[l(V,{class:"mt-3",icon:e.is_available?r(Q):r(W),color:`${e.is_available?"success":"error"}`},null,8,["icon","color"])])):b("",!0),((E=(I=s.value)==null?void 0:I.data)==null?void 0:E.status)=="complete"&&Y.value=="receiver"?(i(),v("div",ia,[l(V,{class:"mt-3",icon:e.is_received?r(oe):r(de),color:`${e.is_received?"success":"error"}`},null,8,["icon","color"])])):b("",!0)]))]}),_:2},1024))),128)),m.value?(i(),j(C,{key:0,class:"mt-3"},{default:n(()=>[na]),_:1})):b("",!0),(A=(h=s.value)==null?void 0:h.data)!=null&&A.is_available?(i(),j(C,{key:1,class:"mt-6 mb-2"},{default:n(()=>[l(D,{loading:M.value,variant:"text",class:"v-col-12 text-center pt-2 font-weight-bold pb-0 d-flex justify-center"},{default:n(()=>{var e;return[a("div",null,[l(V,{icon:r(Q),color:"success"},null,8,["icon"]),p(" AVAILABLE "),l(V,{icon:r(W),color:"error",class:"ml-5"},null,8,["icon"]),p(" NOT AVAILABLE ")]),R.value?(i(),v("div",ua,[va,l(V,{icon:r(Ce)},null,8,["icon"]),p(" TICK RECEIVED ASSETS ")])):b("",!0),((e=s.value.data)==null?void 0:e.status)=="complete"&&Y.value=="receiver"?(i(),v("div",pa,[l(V,{icon:r(oe),color:"success"},null,8,["icon"]),p(" RECEIVED "),l(V,{icon:r(de),color:"error",class:"ml-5"},null,8,["icon"]),p(" NOT RECEIVE ")])):b("",!0)]}),_:1},8,["loading"])]),_:1})):b("",!0),l(C,{class:"mt-3"},{default:n(()=>[a("div",_a,[l(B),l(B)])]),_:1}),((q=s.value.data)==null?void 0:q.request_approvals.length)>0?(i(),j(C,{key:2},{default:n(()=>{var e,g,w,O,T;return[a("div",ya,[fa,ma,a("div",ha,f((g=(e=s.value.data)==null?void 0:e.profile)==null?void 0:g.display_name),1),a("div",ga,f((O=(w=s.value.data)==null?void 0:w.profile)==null?void 0:O.designation),1),a("div",ba,f(r(X)((T=s.value.data)==null?void 0:T.created_at)),1)]),(i(!0),v(re,null,te(s.value.data.request_approvals,t=>{var U,I;return i(),v("div",{class:"v-col-12 v-col-md-3 pa-0 mb-4",key:t.id},[t.profile.role=="commercial-manager"&&r(o).query.pid==t.profile_id&&r(o).query.o==t.orders?(i(),v("div",Va,[t.status=="awaiting-approval"?(i(),v("div",xa,[a("div",{onClick:E=>pe(t),class:"cursor-pointer text-center py-5 v-col-6",style:z(`border:1px solid #ccc; ${r(o).query.pid==t.profile_id&&r(o).query.o==t.orders?"background-color: rgb(182, 3, 3);color:#fff;":"background-color: none;"}`)}," REJECT ",12,ka),a("div",{onClick:E=>F(t,"reject"),class:"cursor-pointer text-center py-5 v-col-6",style:z(`border:1px solid #ccc; ${r(o).query.pid==t.profile_id&&r(o).query.o==t.orders?"background-color: rgb(3, 167, 3);color:#fff;":"background-color: none"}`)}," APPROVE ",12,Ea)])):t.status=="reject"||t.status=="done"||t.status=="pending"?(i(),v("div",Ca,[a("div",{onClick:E=>F(t),class:"cursor-pointer text-center mx-2 py-5",style:z(`border:1px solid #ccc; ${t.status=="reject"&&r(o).query.pid==t.profile_id&&r(o).query.o==t.orders?"background-color: rgb(182, 3, 3);color:#fff;":t.status=="done"?"background-color: none;color:rgb(3, 167, 3); font-weight:bold;font-size:17px;padding-top:16px !important;padding-bottom:16px !important;":"background-color: gray; color:#fff;"}`)},f(t.status=="done"?"APPROVED":"CLICK TO APPROVE"),13,Ra)])):b("",!0)])):(i(),v("div",{key:1,onClick:E=>F(t),class:"cursor-pointer text-center mx-2 py-5",style:z(`border:1px solid #ccc; ${t.status=="awaiting-approval"&&r(o).query.pid==t.profile_id&&r(o).query.o==t.orders?"background-color: rgb(182, 3, 3);color:#fff;":t.status=="done"?"background-color: none;color:rgb(3, 167, 3); font-weight:bold;font-size:17px;padding-top:16px !important;padding-bottom:16px !important;":"background-color: gray; color:#fff;"}`)},f(t.status=="done"?"APPROVED":"CLICK TO APPROVE"),13,Aa)),a("div",{class:L(`text-center py-1 font-weight-bold ${t.status=="reject"?"text-error text-uppercase":""}`)},f(t.status=="reject"?"Rejected":ye(t.approval_type))+" By ",3),a("div",qa,f((U=t.profile)==null?void 0:U.display_name),1),a("div",wa,f((I=t.profile)==null?void 0:I.designation),1),a("div",Oa,f(t.date_approved?r(X)(t.date_approved):""),1),t.reason_rejected?(i(),v("div",Ta,[p(" Reason "),l(B,{class:"my-2"}),p(" "+f(t.reason_rejected),1)])):b("",!0)])}),128))]}),_:1})):b("",!0),((k=(_=s.value)==null?void 0:_.data)==null?void 0:k.status)!=="complete"?(i(),j(C,{key:3},{default:n(()=>[a("div",Ua,[l(B),p(" You will receive a notification once you click the button. "),l(B)])]),_:1})):b("",!0),l(se,{width:"500",modelValue:P.value,"onUpdate:modelValue":c[5]||(c[5]=e=>P.value=e),persistent:""},{default:n(()=>[l(D,null,{default:n(()=>[l(Re,null,{default:n(()=>[l(C,null,{default:n(()=>[Ia,a("div",ja,[l(Ae,{modelValue:S.value,"onUpdate:modelValue":c[3]||(c[3]=e=>S.value=e),label:"STATE YOUR REASON HERE",variant:"outlined"},null,8,["modelValue"])])]),_:1})]),_:1}),l(qe,null,{default:n(()=>[l(ce),l(ie,{onClick:_e},{default:n(()=>[p("Cancel")]),_:1}),l(ie,{color:"success",disabled:!S.value,onClick:c[4]||(c[4]=e=>F(ae.value,"reject"))},{default:n(()=>[p("Confirm")]),_:1},8,["disabled"]),l(ce)]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(we,{options:K.value},null,8,["options"])]}),_:1}))}};export{$a as default};
