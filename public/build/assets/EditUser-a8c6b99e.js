import{r as o,o as S,c as A,w as t,d as e,j as _,X as Z,k as U,f as N,J as j,Z as H,_ as ee,e as g,R as ae,a as q,p as O,V as le,b as u,t as M,i as te,C as se,Y as ie,h as oe,ae as ne,n as E,G as ue,u as de,I as ce,m as re,s as w,a7 as T,al as z,ad as J,y as B,E as I,q as pe,F as ve}from"./app-889fc684.js";import{_ as me}from"./ApppageHeader-283dc590.js";import{_ as fe,a as _e,b as ge}from"./ChangePassword-eec1e92b.js";import{_ as ye}from"./AppSnackBar-bc2d389f.js";import"./index.esm-144dccd3.js";const be={__name:"Capability",props:["item"],emits:["saved"],setup($,{emit:V}){const b=$,c=o(!1),d=o(b.item.capabilities),n=o(b.item.capabilities),f=o(["add","edit","delete"]),y=async()=>{c.value=!1,V("saved",{id:b.item.id,capabilities:d.value})},v=()=>{c.value=!1,d.value=n.value};return(p,m)=>(S(),A(ae,{width:"500",persistent:"",modelValue:c.value,"onUpdate:modelValue":m[1]||(m[1]=s=>c.value=s)},{activator:t(({props:s})=>[e(_,Z(s,{text:"Capability",size:"small",color:"primary"}),null,16)]),default:t(({isActive:s})=>[e(U,{title:"Capabilities"},{default:t(()=>[e(N,null,{default:t(()=>[e(j,{variant:"outlined",density:"compact","hide-details":"",multiple:"","item-title":"name","item-value":"name",label:"- Select -",modelValue:d.value,"onUpdate:modelValue":m[0]||(m[0]=r=>d.value=r),items:f.value},null,8,["modelValue","items"])]),_:1}),e(H,null,{default:t(()=>[e(ee),e(_,{size:"small",text:"cancel",onClick:v}),e(_,{size:"small",color:"secondary",onClick:y},{default:t(()=>[g("Confirm")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},he=u("div",{class:"text-caption"},"TRANSFER ASSET / REQUEST ASSET",-1),Se={class:"text-caption mt-4 text-capitalize"},Ve={class:"d-flex align-center"},xe={__name:"ApprovalTransfer",props:["user"],setup($){const V=$,b=q(),c=o(""),d=o(!1),n=o(!1),f=o(""),y=o({}),v=o(""),p=async()=>{n.value=!1,d.value=!0,await E(b.token).get("/api/admin/add-new/profile-by/ecode/"+c.value).then(s=>{var r;v.value="text-error",f.value="Employee Not Found.",(r=s==null?void 0:s.data)!=null&&r.id&&(v.value="text-info",y.value=s.data,n.value=!0,f.value="Employee: "+s.data.display_name),d.value=!1}).catch(s=>{d.value=!1})},m=async()=>{var r;d.value=!0,v.value="text-info";let s={from:(r=V.user)==null?void 0:r.id,to:y.value.id};await E(b.token).post("/api/user-transfer/approval",s).then(x=>{x.data.data?(v.value="text-success",f.value="Success: Pending approvals has been transfered to "+y.value.display_name):f.value="Info: No pending approvals for this employee.",n.value=!1,d.value=!1}).catch(x=>{d.value=!1,v.value="text-error",f.value="Error: Transfer has been failed!",n.value=!0})};return(s,r)=>(S(),O("div",null,[e(U,{loading:d.value},{default:t(()=>[e(le,{class:"text-primary text-capitalize mb-3"},{default:t(()=>[g(" APPROVAL TRANSFER "),he,u("div",Se,"FROM: "+M(V.user.display_name),1)]),_:1}),e(N,{class:"pb-6"},{default:t(()=>[e(te,{label:"Search Employee Code",modelValue:c.value,"onUpdate:modelValue":r[0]||(r[0]=x=>c.value=x),"item-value":"id","item-title":"title",variant:"outlined","append-inner-icon":se(ie),"hide-details":"",density:"compact",class:"mb-2","onClick:appendInner":p,onKeydown:oe(p,["enter"])},null,8,["modelValue","append-inner-icon","onKeydown"]),u("div",{class:ne(`${v.value} my-5`)},M(f.value),3),u("div",Ve,[e(_,{disabled:!n.value,loading:d.value,color:"primary",onClick:m},{default:t(()=>[g(" Transfer approval confirmation")]),_:1},8,["disabled","loading"])])]),_:1})]),_:1},8,["loading"])]))}},Ce={class:"v-col-12"},ke={class:"v-col-12"},we={class:"d-flex flex-wrap"},Ae={class:"v-col-12 v-col-md-5"},Ee={class:"v-col-12"},$e={class:"v-col-12 v-col-md-4"},Re={class:"v-col-12 v-col-md-12 d-flex"},Fe={class:"v-col-12 v-col-md-12 py-0 d-flex"},Te={class:"my-auto"},ze={key:0,class:"v-col-12 v-col-md-3"},Ue=u("div",{class:"v-col-12 v-col-md-12"},[g(" Capabilities "),u("br"),u("small",{class:"text-error"},"Warning: it will override the capabilities of all page."),u("br"),u("small",{class:"text-error"},"Select only here if all pages have same capabilities")],-1),Ne={class:"v-col-12 v-col-md-12 my-auto"},Le={__name:"EditUser",setup($){var K,L;const V=ue(),b=de(),c=q(),d=o(!0),n=o({loading:!1,data:{}}),f=()=>{b.back()},y=async()=>{d.value=!0,await E(c.token).get("/api/admin/user/single/"+V.params.id).then(a=>{n.value.data=a.data,d.value=!1}).catch(a=>{n.value.loading=!1,d.value=!1})},v=a=>{y().then(()=>{D.value={status:!0,type:"success",text:a}})};ce(()=>{y().then(()=>{x()})});const p=o("profile"),m=async a=>{p.value=a},s=o([]),r=o(!1),x=()=>{E(c.token).get("/api/fetch/pages-slug").then(a=>{var i;s.value=a.data,((i=n.value.data)==null?void 0:i.access.length)>0&&n.value.data.access.map((l,R)=>{s.value.map((F,Pe)=>{l.slug==F.slug&&(F.isSelected=l.slug,F.capabilities=l.capabilities?JSON.parse(l.capabilities):[],h.value.push(l.slug),C.value=!0)})})}).catch(a=>{})},C=o(!1),G=()=>{s.value.map((a,i)=>(a.capabilities||(a.capabilities=[]),r.value?(a.isSelected=a.slug,h.value.push(a.slug),C.value=!0):(a.isSelected="",h.value=[],C.value=!1),a))},P=o(!1),h=o([]),Q=a=>{a.isSelected?(h.value.splice(h.value.findIndex(l=>l===a.isSelected),1),a.isSelected="",a.capabilities=""):(!a.isSelected||a.isSelected==null||a.isSelected=="")&&(h.value.push(a.slug),a.isSelected=a.slug),C.value=!0,s.value.filter((l,R)=>!l.isSelected).length>0?r.value=!1:r.value=!0},k=o([]),W=o(["add","edit","delete"]),D=o({status:!0,type:"info",text:null}),X=a=>{s.value.map((i,l)=>{i.id==a.id&&(i.capabilities=a.capabilities)})};o((L=(K=c==null?void 0:c.user)==null?void 0:K.profile)==null?void 0:L.id);const Y=()=>{P.value=!0,k.value.length>0&&s.value.map((l,R)=>{l.isSelected?l.capabilities=k.value:l.capabilities=[]});let a=s.value.filter(l=>l.isSelected),i={profileID:V.params.id,data:a,profile_id:c.user.profile.id};E(c.token).post("/api/store-page/settings-capabilities/profile",i).then(l=>{h.value=[],k.value=[],D.value={status:!0,type:"success",text:l.data.message},P.value=!1,y().then(()=>{x()})})};return(a,i)=>(S(),A(re,null,{default:t(()=>[e(me,{title:"Edit User"}),e(w,{class:"mb-3",disabled:d.value},{default:t(()=>[u("div",Ce,[e(_,{color:"primary",class:"mr-4",loading:a.loadingAsset,onClick:f},{default:t(()=>[g("Back")]),_:1},8,["loading"])]),u("div",ke,[u("div",we,[e(_,{color:`${p.value=="profile"?"primary":"white"} `,size:"large",class:"mr-3 my-1",loading:n.value.loading,onClick:i[0]||(i[0]=()=>m("profile"))},{default:t(()=>[g("profile")]),_:1},8,["color","loading"]),e(_,{color:`${p.value=="account"?"primary":"white"} `,size:"large",class:"mr-3 my-1",loading:n.value.loading,onClick:i[1]||(i[1]=()=>m("account"))},{default:t(()=>[g("Account")]),_:1},8,["color","loading"]),e(_,{color:`${p.value=="change_password"?"primary":"white"} `,size:"large",class:"mr-3 my-1",loading:n.value.loading,onClick:i[2]||(i[2]=()=>m("change_password"))},{default:t(()=>[g("Change Password")]),_:1},8,["color","loading"]),e(_,{color:`${p.value=="approval_transfer"?"primary":"white"} `,size:"large",class:"mr-3 my-1",loading:n.value.loading,onClick:i[3]||(i[3]=()=>m("approval_transfer"))},{default:t(()=>[g("APPROVAL TRANSFER")]),_:1},8,["color","loading"])])]),u("div",Ae,[e(w,null,{default:t(()=>[u("div",Ee,[T(e(fe,{user:n.value.data,onSaved:v},null,8,["user"]),[[z,p.value=="account"]]),T(e(_e,{user:n.value.data,onSaved:v},null,8,["user"]),[[z,p.value=="profile"]]),T(e(ge,{user:n.value.data},null,8,["user"]),[[z,p.value=="change_password"]]),T(e(xe,{user:n.value.data},null,8,["user"]),[[z,p.value=="approval_transfer"]])])]),_:1})]),u("div",$e,[e(U,null,{default:t(()=>[e(N,null,{default:t(()=>[e(w,null,{default:t(()=>[u("div",Re,[e(J,{modelValue:r.value,"onUpdate:modelValue":[i[4]||(i[4]=l=>r.value=l),G],"hide-details":"",variant:"outlined",density:"compact",label:" Access / View Pages"},null,8,["modelValue"]),C.value?(S(),A(_,{key:0,class:"ml-5",size:"small",loading:P.value,color:"secondary",onClick:Y},{default:t(()=>[g("Save")]),_:1},8,["loading"])):B("",!0)])]),_:1}),e(I,{class:"mb-3"}),(S(!0),O(ve,null,pe(s.value,(l,R)=>(S(),A(w,{key:l.id},{default:t(()=>[u("div",Fe,[e(J,{"model-value":h.value.includes(l.slug),"hide-details":"",variant:"outlined","onUpdate:modelValue":F=>Q(l,R),label:l.title,density:"compact"},null,8,["model-value","onUpdate:modelValue","label"]),u("div",Te,[l.isSelected?(S(),A(be,{key:0,item:l,onSaved:X},null,8,["item"])):B("",!0)])]),e(I)]),_:2},1024))),128))]),_:1})]),_:1})]),C.value?(S(),O("div",ze,[e(U,null,{default:t(()=>[e(N,null,{default:t(()=>[e(w,null,{default:t(()=>[Ue,e(I),u("div",Ne,[e(j,{variant:"outlined",density:"compact","hide-details":"",multiple:"",label:"- Select -",modelValue:k.value,"onUpdate:modelValue":i[5]||(i[5]=l=>k.value=l),items:W.value},null,8,["modelValue","items"])])]),_:1})]),_:1})]),_:1})])):B("",!0)]),_:1},8,["disabled"]),e(ye,{options:D.value},null,8,["options"])]),_:1}))}};export{Le as default};
