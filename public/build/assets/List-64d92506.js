import{r as s,i as Z,u as ee,N as te,O as ae,o as le,j as y,k as d,C as se,D as w,b as f,l as o,e as l,A as oe,V as ne,y as ie,x as de,E as U,P as _,H as re,m as x,c as B,d as ue,t as r,Q as ce,K as g,J as F,R as pe,S as me,I as D,F as ve,T as fe,U as ge}from"./app-ac6f585e.js";import{_ as he}from"./ApppageHeader-4a0ba48d.js";import{d as ye,e as _e}from"./encrypt-0aa6abb4.js";import{_ as xe}from"./AppSnackBar-a3d2cc8d.js";import{u as I}from"./formatDate-b9aad8c5.js";const Ve={class:"v-col-12"},Ce=l("div",{class:"mr-auto"},"Asset Transfers",-1),be={class:"v-col-12 v-col-md"},ke={class:"v-col-12 v-col-md"},Se={class:"v-col-12 v-col-md"},we={class:"v-col-12 v-col-md"},De=l("th",{class:"text-left text-capitalize"},"SN No.",-1),ze=l("br",null,null,-1),Ne=l("small",null,"(DD/MM/YY)",-1),je=l("br",null,null,-1),Ae=l("small",null,"(DD/MM/YY)",-1),Re=l("th",{class:"text-right text-capitalize"},null,-1),Te={class:"d-flex align-center justify-end"},Ie={__name:"List",setup($e){const O=s({status:!1,type:"primary",text:null}),u=Z(),z=ee(),V=te(),i=s({loading:!1,data:[]}),C=s(0),K=s(0),v=s(""),M=s([10,20,50,100]),b=s(10),c=s({}),q=()=>{m()},k=()=>{S.value="",n.value==1?m():n.value=1},N=()=>{localStorage.setItem("transfer-asset-search",_e(v.value)),m()},E=()=>{v.value="",localStorage.setItem("transfer-asset-search",""),m()},n=s(V.params&&V.params.page?V.params.page:1),h=s([]),S=s(""),j=s(0),p=t=>{i.value.loading=!0,h.value[0]=t,j.value%2?h.value[1]="DESC":h.value[1]="ASC",j.value++,S.value=JSON.stringify(h.value),m()},A=s([]),Y=async()=>{await w(u.token).get("/api/fetch/companies").then(t=>{A.value=t.data}).catch(t=>{})},R=s([]),J=async()=>{await w(u.token).get("/api/fetch/locations/non-paginated/data").then(t=>{R.value=t.data}).catch(t=>{})},H=s([{id:"pending",title:"Pending"},{id:"awaiting-approval",title:"Awaiting Approval"},{id:"reject",title:"Rejected"},{id:"cancelled",title:"Cancelled"},{id:"complete",title:"Completed"}]),Q=t=>t=="reject"?"Rejected":t=="complete"?"Completed":t,m=async()=>{i.value.loading=!0,await w(u.token).get("/api/fetch/request-assets/by-requestor/transfer?userid="+u.user.profile.id+"&role="+u.user.profile.role+"&page="+n.value+"&show="+b.value+"&search="+v.value+"&sort="+S.value+"&filter="+JSON.stringify(c.value)).then(t=>{C.value=t.data.last_page?t.data.last_page:t.data.length,n.value=t.data.current_page?t.data.current_page:n.value,K.value=t.data.total?t.data.total:t.data.length,i.value.data=t.data.data?t.data.data:t.data,i.value.loading=!1}).catch(t=>{i.value.loading=!1,console.log(t)})};ae(n,(t,a)=>{n.value&&t!=a&&(z.push({name:"PaginatedTransferAsset",params:{page:n.value}}).catch(e=>{}),m(n.value))});const G=t=>{z.push({name:"EditTransferAsset",params:{id:t}}).catch(a=>{console.log(a)})},W=t=>{console.log("delete",t)},X=(t,a=6)=>{let e="00000"+t;return e.substring(e.length-a)};return le(()=>{let t=localStorage.getItem("transfer-asset-search");t&&(v.value=ye(t)),m().then(()=>{Y().then(()=>{J()})})}),(t,a)=>(f(),y(se,null,{default:d(()=>[o(he,{title:"Asset Transfer page"}),o(U,{class:"mb-3"},{default:d(()=>[l("div",Ve,[o(oe,{loading:i.value.loading},{default:d(()=>[o(ne,{class:"d-flex align-center mb-3 pa-3"},{default:d(()=>[Ce,o(ie,{modelValue:v.value,"onUpdate:modelValue":a[0]||(a[0]=e=>v.value=e),variant:"outlined",density:"compact",clearable:"",label:"Search (ex. SN-3000035 )",type:"text","hide-details":"",style:{"max-width":"300px"},"onClick:appendOuter":N,onKeydown:de(N,["enter"]),"onClick:clear":a[1]||(a[1]=e=>E("search"))},null,8,["modelValue","onKeydown"])]),_:1}),o(U,{class:"px-3"},{default:d(()=>[l("div",be,[o(_,{items:A.value,modelValue:c.value.company_id,"onUpdate:modelValue":[a[2]||(a[2]=e=>c.value.company_id=e),k],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Company"},null,8,["items","modelValue"])]),l("div",ke,[o(_,{items:R.value,modelValue:c.value.location_id,"onUpdate:modelValue":[a[3]||(a[3]=e=>c.value.location_id=e),k],variant:"outlined",density:"compact","hide-details":"",label:"Location","item-value":"id",clearable:"","item-title":"title"},null,8,["items","modelValue"])]),l("div",Se,[o(_,{items:H.value,modelValue:c.value.status,"onUpdate:modelValue":[a[4]||(a[4]=e=>c.value.status=e),k],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Status"},null,8,["items","modelValue"])]),l("div",we,[o(_,{items:M.value,modelValue:b.value,"onUpdate:modelValue":[a[5]||(a[5]=e=>b.value=e),q],variant:"outlined",density:"compact","hide-details":"",label:"Show"},null,8,["items","modelValue"])])]),_:1}),o(re,null,{default:d(()=>[l("thead",null,[l("tr",null,[De,l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[6]||(a[6]=e=>p("company_id"))}," Company "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[7]||(a[7]=e=>p("transferred_to"))}," Location "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[8]||(a[8]=e=>p("subject"))}," Subject "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[9]||(a[9]=e=>p("profile_id"))}," Requestor "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[10]||(a[10]=e=>p("status"))}," Status "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[11]||(a[11]=e=>p("created_at"))},[x(" D.Requested"),ze,Ne]),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[12]||(a[12]=e=>p("date_closed"))},[x(" D.Closed"),je,Ae]),Re])]),l("tbody",null,[(f(!0),B(ve,null,ue(i.value.data,e=>{var T,$,L,P;return f(),B("tr",{key:e.id},[l("td",null,"SN-3"+r(X(e.id)),1),l("td",null,r((T=e.company)==null?void 0:T.title),1),l("td",null,r(($=e.transfer_to)==null?void 0:$.title),1),l("td",null,r(e.subject),1),l("td",null,r((L=e.profile)==null?void 0:L.display_name),1),l("td",null,[o(ce,{class:"text-uppercase",size:"small",color:`${e.status.toLowerCase()=="complete"?"success":"error"}`},{default:d(()=>[x(r(Q(e.status)),1)]),_:2},1032,["color"])]),l("td",null,r(g(I)(e.created_at)),1),l("td",null,r(e.date_closed&&e.date_closed!="0000-00-00"?g(I)(e.date_closed):""),1),l("td",null,[l("div",Te,[o(F,{size:"small",onClick:()=>G(e.id),icon:g(pe),class:"mx-1"},null,8,["onClick","icon"]),g(u).user.role=="superadmin"||(P=g(u).capabilities)!=null&&P.includes("delete")?(f(),y(F,{key:0,size:"small",onClick:()=>W(e.id),icon:g(me),class:"mx-1"},null,8,["onClick","icon"])):D("",!0)])])])}),128))])]),_:1}),i.value.data.length==0?(f(),y(fe,{key:0,class:"pa-3 text-center w-100"},{default:d(()=>[x("No records found")]),_:1})):D("",!0)]),_:1},8,["loading"]),C.value>1?(f(),y(ge,{key:0,modelValue:n.value,"onUpdate:modelValue":a[13]||(a[13]=e=>n.value=e),class:"my-4",length:C.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:i.value.loading},null,8,["modelValue","length","disabled"])):D("",!0)])]),_:1}),o(xe,{options:O.value},null,8,["options"])]),_:1}))}};export{Ie as default};
