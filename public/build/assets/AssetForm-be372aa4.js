import{ah as qe,ad as Ee,ai as $e,D as ie,N as Fe,i as Me,r as B,O as xe,b as D,j as K,k as r,e as l,l as s,z as P,m as q,J as ke,K as _,ac as Ce,A as le,H as we,c as G,F as ve,d as pe,t as A,T as Ve,I as se,Z as Ue,V as Oe,X as Ae,q as We,E as J,y as O,a3 as W,P as ae,u as Ye,W as Ie,w as oe,a0 as Pe,v as re,Y as Se,_ as He,$ as Re}from"./app-727d01fd.js";import{c as ze,a as T,F as Ne,b as Y}from"./index.esm-4829bacc.js";import{_ as je}from"./AppSnackBar-213ad8ac.js";import{_ as Be}from"./Studio-b1d434b9.js";import{u as De}from"./formatDate-e2fbee14.js";import{u as Je}from"./categories-104f93b8.js";import{u as Ke}from"./status-8587d48f.js";var Te={exports:{}};(function(k,V){(function(H,E){k.exports=E()})(qe,function(){var H=1e3,E=6e4,N=36e5,j="millisecond",F="second",i="minute",$="hour",M="day",w="week",b="month",S="quarter",m="year",u="date",a="Invalid Date",C=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,he=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,fe={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(v){var d=["th","st","nd","rd"],n=v%100;return"["+v+(d[(n-20)%10]||d[n]||d[0])+"]"}},de=function(v,d,n){var c=String(v);return!c||c.length>=d?v:""+Array(d+1-c.length).join(n)+v},be={s:de,z:function(v){var d=-v.utcOffset(),n=Math.abs(d),c=Math.floor(n/60),o=n%60;return(d<=0?"+":"-")+de(c,2,"0")+":"+de(o,2,"0")},m:function v(d,n){if(d.date()<n.date())return-v(n,d);var c=12*(n.year()-d.year())+(n.month()-d.month()),o=d.clone().add(c,b),p=n-o<0,f=d.clone().add(c+(p?-1:1),b);return+(-(c+(n-o)/(p?o-f:f-o))||0)},a:function(v){return v<0?Math.ceil(v)||0:Math.floor(v)},p:function(v){return{M:b,y:m,w,d:M,D:u,h:$,m:i,s:F,ms:j,Q:S}[v]||String(v||"").toLowerCase().replace(/s$/,"")},u:function(v){return v===void 0}},X="en",Z={};Z[X]=fe;var _e="$isDayjsObject",ue=function(v){return v instanceof g||!(!v||!v[_e])},y=function v(d,n,c){var o;if(!d)return X;if(typeof d=="string"){var p=d.toLowerCase();Z[p]&&(o=p),n&&(Z[p]=n,o=p);var f=d.split("-");if(!o&&f.length>1)return v(f[0])}else{var x=d.name;Z[x]=d,o=x}return!c&&o&&(X=o),o||!c&&X},t=function(v,d){if(ue(v))return v.clone();var n=typeof d=="object"?d:{};return n.date=v,n.args=arguments,new g(n)},e=be;e.l=y,e.i=ue,e.w=function(v,d){return t(v,{locale:d.$L,utc:d.$u,x:d.$x,$offset:d.$offset})};var g=function(){function v(n){this.$L=y(n.locale,null,!0),this.parse(n),this.$x=this.$x||n.x||{},this[_e]=!0}var d=v.prototype;return d.parse=function(n){this.$d=function(c){var o=c.date,p=c.utc;if(o===null)return new Date(NaN);if(e.u(o))return new Date;if(o instanceof Date)return new Date(o);if(typeof o=="string"&&!/Z$/i.test(o)){var f=o.match(C);if(f){var x=f[2]-1||0,U=(f[7]||"0").substring(0,3);return p?new Date(Date.UTC(f[1],x,f[3]||1,f[4]||0,f[5]||0,f[6]||0,U)):new Date(f[1],x,f[3]||1,f[4]||0,f[5]||0,f[6]||0,U)}}return new Date(o)}(n),this.init()},d.init=function(){var n=this.$d;this.$y=n.getFullYear(),this.$M=n.getMonth(),this.$D=n.getDate(),this.$W=n.getDay(),this.$H=n.getHours(),this.$m=n.getMinutes(),this.$s=n.getSeconds(),this.$ms=n.getMilliseconds()},d.$utils=function(){return e},d.isValid=function(){return this.$d.toString()!==a},d.isSame=function(n,c){var o=t(n);return this.startOf(c)<=o&&o<=this.endOf(c)},d.isAfter=function(n,c){return t(n)<this.startOf(c)},d.isBefore=function(n,c){return this.endOf(c)<t(n)},d.$g=function(n,c,o){return e.u(n)?this[c]:this.set(o,n)},d.unix=function(){return Math.floor(this.valueOf()/1e3)},d.valueOf=function(){return this.$d.getTime()},d.startOf=function(n,c){var o=this,p=!!e.u(c)||c,f=e.p(n),x=function(te,I){var Q=e.w(o.$u?Date.UTC(o.$y,I,te):new Date(o.$y,I,te),o);return p?Q:Q.endOf(M)},U=function(te,I){return e.w(o.toDate()[te].apply(o.toDate("s"),(p?[0,0,0,0]:[23,59,59,999]).slice(I)),o)},z=this.$W,L=this.$M,R=this.$D,ne="set"+(this.$u?"UTC":"");switch(f){case m:return p?x(1,0):x(31,11);case b:return p?x(1,L):x(0,L+1);case w:var ee=this.$locale().weekStart||0,ce=(z<ee?z+7:z)-ee;return x(p?R-ce:R+(6-ce),L);case M:case u:return U(ne+"Hours",0);case $:return U(ne+"Minutes",1);case i:return U(ne+"Seconds",2);case F:return U(ne+"Milliseconds",3);default:return this.clone()}},d.endOf=function(n){return this.startOf(n,!1)},d.$set=function(n,c){var o,p=e.p(n),f="set"+(this.$u?"UTC":""),x=(o={},o[M]=f+"Date",o[u]=f+"Date",o[b]=f+"Month",o[m]=f+"FullYear",o[$]=f+"Hours",o[i]=f+"Minutes",o[F]=f+"Seconds",o[j]=f+"Milliseconds",o)[p],U=p===M?this.$D+(c-this.$W):c;if(p===b||p===m){var z=this.clone().set(u,1);z.$d[x](U),z.init(),this.$d=z.set(u,Math.min(this.$D,z.daysInMonth())).$d}else x&&this.$d[x](U);return this.init(),this},d.set=function(n,c){return this.clone().$set(n,c)},d.get=function(n){return this[e.p(n)]()},d.add=function(n,c){var o,p=this;n=Number(n);var f=e.p(c),x=function(L){var R=t(p);return e.w(R.date(R.date()+Math.round(L*n)),p)};if(f===b)return this.set(b,this.$M+n);if(f===m)return this.set(m,this.$y+n);if(f===M)return x(1);if(f===w)return x(7);var U=(o={},o[i]=E,o[$]=N,o[F]=H,o)[f]||1,z=this.$d.getTime()+n*U;return e.w(z,this)},d.subtract=function(n,c){return this.add(-1*n,c)},d.format=function(n){var c=this,o=this.$locale();if(!this.isValid())return o.invalidDate||a;var p=n||"YYYY-MM-DDTHH:mm:ssZ",f=e.z(this),x=this.$H,U=this.$m,z=this.$M,L=o.weekdays,R=o.months,ne=o.meridiem,ee=function(I,Q,me,ye){return I&&(I[Q]||I(c,p))||me[Q].slice(0,ye)},ce=function(I){return e.s(x%12||12,I,"0")},te=ne||function(I,Q,me){var ye=I<12?"AM":"PM";return me?ye.toLowerCase():ye};return p.replace(he,function(I,Q){return Q||function(me){switch(me){case"YY":return String(c.$y).slice(-2);case"YYYY":return e.s(c.$y,4,"0");case"M":return z+1;case"MM":return e.s(z+1,2,"0");case"MMM":return ee(o.monthsShort,z,R,3);case"MMMM":return ee(R,z);case"D":return c.$D;case"DD":return e.s(c.$D,2,"0");case"d":return String(c.$W);case"dd":return ee(o.weekdaysMin,c.$W,L,2);case"ddd":return ee(o.weekdaysShort,c.$W,L,3);case"dddd":return L[c.$W];case"H":return String(x);case"HH":return e.s(x,2,"0");case"h":return ce(1);case"hh":return ce(2);case"a":return te(x,U,!0);case"A":return te(x,U,!1);case"m":return String(U);case"mm":return e.s(U,2,"0");case"s":return String(c.$s);case"ss":return e.s(c.$s,2,"0");case"SSS":return e.s(c.$ms,3,"0");case"Z":return f}return null}(I)||f.replace(":","")})},d.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},d.diff=function(n,c,o){var p,f=this,x=e.p(c),U=t(n),z=(U.utcOffset()-this.utcOffset())*E,L=this-U,R=function(){return e.m(f,U)};switch(x){case m:p=R()/12;break;case b:p=R();break;case S:p=R()/3;break;case w:p=(L-z)/6048e5;break;case M:p=(L-z)/864e5;break;case $:p=L/N;break;case i:p=L/E;break;case F:p=L/H;break;default:p=L}return o?p:e.a(p)},d.daysInMonth=function(){return this.endOf(b).$D},d.$locale=function(){return Z[this.$L]},d.locale=function(n,c){if(!n)return this.$L;var o=this.clone(),p=y(n,c,!0);return p&&(o.$L=p),o},d.clone=function(){return e.w(this.$d,this)},d.toDate=function(){return new Date(this.valueOf())},d.toJSON=function(){return this.isValid()?this.toISOString():null},d.toISOString=function(){return this.$d.toISOString()},d.toString=function(){return this.$d.toUTCString()},v}(),h=g.prototype;return t.prototype=h,[["$ms",j],["$s",F],["$m",i],["$H",$],["$W",M],["$M",b],["$y",m],["$D",u]].forEach(function(v){h[v[1]]=function(d){return this.$g(d,v[0],v[1])}}),t.extend=function(v,d){return v.$i||(v(d,g,t),v.$i=!0),t},t.locale=y,t.isDayjs=ue,t.unix=function(v){return t(1e3*v)},t.en=Z[X],t.Ls=Z,t.p={},t})})(Te);var Ze=Te.exports;const ge=Ee(Ze),Le=$e("vendors",{state:()=>({vendors:[]}),getters:{list:k=>k.vendors},actions:{async getVendors(k){await ie(k).get("/api/vendor/state/vendor-list").then(V=>{this.vendors=Object.assign([],V.data)}).catch(V=>{console.log("getvendors error: ",V)})}}}),Ge={class:"v-col-12 pt-0 pb-2"},Xe=l("thead",null,[l("tr",null,[l("th",{class:"text-left text-primary"},"#"),l("th",{class:"text-left text-primary"},"Title"),l("th",{class:"text-left text-primary"},"Warranty Start"),l("th",{class:"text-left text-primary"},"Warranty End"),l("th",{class:"text-left text-primary"},"Vendor"),l("th",{class:"text-left text-primary"},"Vendor Start"),l("th",{class:"text-left text-primary"},"Vendor End")])],-1),Qe=["onClick"],et=l("div",{class:"v-col-12 pt-0 pb-2"},"Warranty",-1),tt={class:"v-col-12 v-col-md-4 pt-0 pb-2"},at={class:"v-col-12 v-col-md-4 pt-0 pb-2"},lt={class:"v-col-12 v-col-md-4 pt-0 pb-2"},st=l("div",{class:"v-col-12 pt-0 pb-2"},"Vendor Warranty",-1),nt={class:"v-col-12 v-col-md-4 pt-0 pb-2"},ot={class:"v-col-12 v-col-md-4 pt-0 pb-2"},rt={class:"v-col-12 v-col-md-4 pt-0 pb-2"},it={class:"v-col-12 pt-0 pb-2 d-flex justify-end"},dt={__name:"AssetWarranties",props:{page:{type:String,default:"add"},asset:{type:Object,default:null}},setup(k){const V=k,H=Fe(),E=Me(),N=Le(),j=B({}),F=ze({"Warranty Title":T().required().max(150),"Warranty Start Date":T().nullable(),"Warranty End Date":T().nullable(),"Vendor Start Date":T().nullable(),"Vendor End Date":T().nullable()}),i=B({status:!1,action:"add",loading:!1,data:{}}),$=B([]);xe(()=>V.asset,S=>{$.value=S.warranty});const M=(S=null)=>{i.value.status=!0,S?(i.value.action="edit",i.value.data=Object.assign({},S)):(i.value.action="add",i.value.data={})},w=async()=>{i.value.loading=!0;let S={id:i.value.data.id,asset_id:H.params.id,warranty_title:i.value.data.title,warranty_start_date:i.value.data.warranty_start_date,warranty_end_date:i.value.data.warranty_end_date,warranty_vendor_id:i.value.data.vendor_id,vendor_start_date:i.value.data.vendor_start_date,vendor_end_date:i.value.data.vendor_end_date};await ie(E.token).post("/api/asset/save-warranty",S).then(m=>{b().then(()=>{j.value={status:!0,type:"success",text:m.data.message},i.value.loading=!1,i.value.status=!1})}).catch(m=>{i.value.loading=!1,j.value={status:!0,type:"eroor",text:"Error while saving warranty"},console.log("err",m)})},b=async()=>{await ie(E.token).get("/api/asset/warranty/"+H.params.id).then(S=>{$.value=S.data,i.value.loading=!1}).catch(S=>{i.value.loading=!1,console.log("err",S)})};return(S,m)=>(D(),K(J,null,{default:r(()=>[l("div",Ge,[s(P,{onClick:m[0]||(m[0]=()=>M()),class:"mb-3",size:"small"},{default:r(()=>[q(" New Warranty "),s(ke,{class:"ml-2",icon:_(Ce)},null,8,["icon"])]),_:1}),s(le,null,{default:r(()=>[s(we,{density:"compact"},{default:r(()=>[Xe,l("tbody",null,[(D(!0),G(ve,null,pe($.value,(u,a)=>(D(),G("tr",{key:u.id,onClick:()=>M(u),class:"cursor-pointer table-cell-hover"},[l("td",null,A(a+1),1),l("td",null,A(u.title),1),l("td",null,A(u.warranty_start_date&&_(ge)(u.warranty_start_date).format("MMM. DD, YYYY")),1),l("td",null,A(u.warranty_end_date&&_(ge)(u.warranty_end_date).format("MMM. DD, YYYY")),1),l("td",null,A(u.vendor&&u.vendor.title),1),l("td",null,A(u.vendor_start_date&&_(ge)(u.vendor_start_date).format("MMM. DD, YYYY")),1),l("td",null,A(u.vendor_end_date&&_(ge)(u.vendor_end_date).format("MMM. DD, YYYY")),1)],8,Qe))),128))])]),_:1}),$.value.length==0?(D(),K(Ve,{key:0,class:"pa-3 text-center"},{default:r(()=>[q("No record at the moment")]),_:1})):se("",!0)]),_:1})]),s(Ue,{modelValue:i.value.status,"onUpdate:modelValue":m[13]||(m[13]=u=>i.value.status=u),persistent:"",width:"1000"},{default:r(()=>[s(le,null,{default:r(()=>[s(Oe,{class:"text-capitalize mb-3 d-flex justify-space-between align-center"},{default:r(()=>[q(A(i.value.action+" Warranty")+" ",1),s(P,{icon:_(Ae),variant:"flat",size:"small",onClick:m[1]||(m[1]=u=>i.value.status=!1)},null,8,["icon"])]),_:1}),s(We,null,{default:r(()=>[s(_(Ne),{as:"v-form","validation-schema":_(F)},{default:r(()=>[s(J,{class:"mb-0"},{default:r(()=>[et,l("div",tt,[s(_(Y),{name:"Warranty Title",modelValue:i.value.data.title,"onUpdate:modelValue":m[3]||(m[3]=u=>i.value.data.title=u)},{default:r(({field:u,errors:a})=>[s(O,W({modelValue:i.value.data.title,"onUpdate:modelValue":m[2]||(m[2]=C=>i.value.data.title=C)},u,{label:"Warranty Title",variant:"outlined",density:"compact","error-messages":a}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])]),l("div",at,[s(_(Y),{name:"Warranty Start Date",modelValue:i.value.data.warranty_start_date,"onUpdate:modelValue":m[5]||(m[5]=u=>i.value.data.warranty_start_date=u)},{default:r(({field:u,errors:a})=>[s(O,W({type:"date",modelValue:i.value.data.warranty_start_date,"onUpdate:modelValue":m[4]||(m[4]=C=>i.value.data.warranty_start_date=C)},u,{label:"Warranty Start Date",variant:"outlined",density:"compact","error-messages":a}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])]),l("div",lt,[s(_(Y),{name:"Warranty End Date",modelValue:i.value.data.warranty_end_date,"onUpdate:modelValue":m[7]||(m[7]=u=>i.value.data.warranty_end_date=u)},{default:r(({field:u,errors:a})=>[s(O,W({type:"date",modelValue:i.value.data.warranty_end_date,"onUpdate:modelValue":m[6]||(m[6]=C=>i.value.data.warranty_end_date=C)},u,{label:"Warranty End Date",variant:"outlined",density:"compact","error-messages":a}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])]),st,l("div",nt,[s(ae,{modelValue:i.value.data.vendor_id,"onUpdate:modelValue":m[8]||(m[8]=u=>i.value.data.vendor_id=u),items:_(N).list,"item-title":"title","item-value":"id",label:"Vendor Warranty",density:"compact",variant:"outlined",rules:[u=>!!u||"Vendor Warranty is required"]},null,8,["modelValue","items","rules"])]),l("div",ot,[s(_(Y),{name:"Vendor Start Date",modelValue:i.value.data.vendor_start_date,"onUpdate:modelValue":m[10]||(m[10]=u=>i.value.data.vendor_start_date=u)},{default:r(({field:u,errors:a})=>[s(O,W({type:"date",modelValue:i.value.data.vendor_start_date,"onUpdate:modelValue":m[9]||(m[9]=C=>i.value.data.vendor_start_date=C)},u,{label:"Vendor Start Date",variant:"outlined",density:"compact","error-messages":a}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])]),l("div",rt,[s(_(Y),{name:"Vendor End Date",modelValue:i.value.data.vendor_end_date,"onUpdate:modelValue":m[12]||(m[12]=u=>i.value.data.vendor_end_date=u)},{default:r(({field:u,errors:a})=>[s(O,W({type:"date",modelValue:i.value.data.vendor_end_date,"onUpdate:modelValue":m[11]||(m[11]=C=>i.value.data.vendor_end_date=C)},u,{label:"Vendor End Date",variant:"outlined",density:"compact","error-messages":a}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])]),l("div",it,[s(P,{color:"primary",loading:i.value.loading,onClick:w},{default:r(()=>[q("Save")]),_:1},8,["loading"])])]),_:1})]),_:1},8,["validation-schema"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(je,{options:j.value},null,8,["options"])]),_:1}))}},ut={class:"v-col-12 pt-0 pb-2"},ct=l("thead",null,[l("tr",null,[l("th",{class:"text-left text-primary"},"ISR ID"),l("th",{class:"text-left text-primary"},"Urgency"),l("th",{class:"text-left text-primary"},"Priority"),l("th",{class:"text-left text-primary"},"Reported by"),l("th",{class:"text-left text-primary"},"Handled by"),l("th",{class:"text-left text-primary"},"Date Reported"),l("th",{class:"text-left text-primary"},"Date Completed"),l("th",{class:"text-left text-primary"},"Status"),l("th",{class:"text-left text-primary"})])],-1),mt={__name:"AssetMaintenances",props:{asset:{type:Object,default:null}},setup(k){const V=k,H=Ye(),E=()=>{H.push({name:"NewMaintenance",query:{type:"details",asset_code:i.value.asset_code,asset_id:i.value.id,comp:i.value.company_id,loc:i.value.location_id,title:i.value.asset_name}})},N=$=>{H.push({name:"EditMaintenance",params:{id:$},query:{type:"details",pd:"ox2rKaIYFhBOQW31j6kkiMrJ4KfnYpLmwJhMzBFwPBlVjgGR4g",v:1,vv:"xK2sX1sDL1BBAvmuoPpWoNRgc4wzbdZ9F2OXAKrS3N2g65xNgy"}}).catch(M=>{console.log(M)})},j=$=>$?$==1?"Normal":$==2?"Medium":"High":"",F=($,M=5)=>{let w="0000"+$;return w.substring(w.length-M)},i=B({});return xe(()=>V.asset,($,M)=>{i.value=$,console.log("assetDetail.value",i.value)},{deep:!0}),($,M)=>(D(),K(J,null,{default:r(()=>[l("div",ut,[i.value.status_id!=2?(D(),K(P,{key:0,onClick:E,class:"mb-3",size:"small"},{default:r(()=>[q(" New Maintenance "),s(ke,{class:"ml-2",icon:_(Ce)},null,8,["icon"])]),_:1})):se("",!0),s(le,null,{default:r(()=>[s(we,{density:"compact"},{default:r(()=>[ct,l("tbody",null,[(D(!0),G(ve,null,pe(V.asset.maintenance,(w,b)=>{var S,m,u;return D(),G("tr",{key:w.id},[l("td",null,"ISR-2"+A(F(w.id)),1),l("td",null,A(j(w.urgency)),1),l("td",null,A(j(w.priority)),1),l("td",null,A((S=w.profile)==null?void 0:S.display_name),1),l("td",null,A((m=w.handle_by)==null?void 0:m.display_name),1),l("td",null,A(_(De)(w.created_at)),1),l("td",null,A(w.date_closed?_(De)(w.date_closed):""),1),l("td",null,A((u=w.status)==null?void 0:u.title),1),l("td",null,[s(P,{color:"info",size:"x-small",onClick:a=>N(w.id)},{default:r(()=>[q("Details")]),_:2},1032,["onClick"])])])}),128))])]),_:1}),V.asset.maintenance&&V.asset.maintenance.length==0?(D(),K(Ve,{key:0,class:"pa-3 text-center"},{default:r(()=>[q("No record at the moment")]),_:1})):se("",!0)]),_:1})])]),_:1}))}},vt={class:"v-col-12 pt-0 pb-2"},pt=l("thead",null,[l("tr",null,[l("th",{class:"text-left text-primary"},"#"),l("th",{class:"text-left text-primary"},"Alloted to"),l("th",{class:"text-left text-primary"},"Remarks")])],-1),ft={__name:"AssetAllotedLocations",props:{asset:{type:Object,default:null}},setup(k){const V=k;return(H,E)=>(D(),K(J,null,{default:r(()=>[l("div",vt,[s(le,null,{default:r(()=>[s(we,{density:"compact"},{default:r(()=>[pt,l("tbody",null,[(D(!0),G(ve,null,pe(V.asset.allotted_informations,(N,j)=>(D(),G("tr",{key:N.id},[l("td",null,A(j+1),1),l("td",null,A(N.title),1),l("td",null,A(N.remarks),1)]))),128))])]),_:1}),V.asset.allotted_informations&&V.asset.allotted_informations.length==0?(D(),K(Ve,{key:0,class:"pa-3 text-center"},{default:r(()=>[q("No record at the moment")]),_:1})):se("",!0)]),_:1})])]),_:1}))}},_t=$e("companies",{state:()=>({companies:[]}),getters:{list:k=>k.companies},actions:{async getCompanies(k){await ie(k).get("/api/company/state/list").then(V=>{this.companies=Object.assign([],V.data)}).catch(V=>{console.log("getCompanies error: ",V)})}}}),yt=$e("locations",{state:()=>({locations:[]}),getters:{list:k=>k.locations},actions:{async getLocations(k){await ie(k).get("/api/location/state/location-list").then(V=>{this.locations=Object.assign([],V.data)}).catch(V=>{console.log("getlocations error: ",V)})}}}),gt={class:"text-primary text-capitalize"},Vt={class:"d-flex align-center"},ht=l("div",{class:"v-col-12 font-weight-bold"},"Asset Info",-1),bt={class:"v-col-12 v-col-md-6 pt-0 pb-2"},$t={class:"v-col-12 v-col-md-6 pt-0 pb-2"},xt={class:"v-col-12 v-col-md-6 pt-0 pb-2"},wt={class:"v-col-12 v-col-md-6 pt-0 pb-2"},St={class:"v-col-12 v-col-md-6 pt-0 pb-2"},Dt={class:"v-col-12 v-col-md-6 pt-0 pb-2"},Mt={class:"v-col-12 v-col-md-6 pt-0 pb-2"},kt={class:"v-col-12 v-col-md-6 pt-0 pb-2"},Ct={key:0,class:"v-col-12 pt-0 font-weight-bold"},Ut={key:1,class:"v-col-12 pt-0"},Ot={class:"v-col-12 pt-0 text-capitalize"},At={class:"v-col-12"},Wt={class:"v-col-12 v-col-md-6 pt-0 pb-2"},Yt={class:"v-col-12 v-col-md-6 pt-0 pb-2"},zt={class:"v-col-12 v-col-md-6 pt-0 pb-2"},Nt={class:"v-col-12 v-col-md-6 pt-0 pb-2"},jt={class:"v-col-12 v-col-md-12 pt-0 pb-2"},Tt={class:"v-col-12"},Lt={class:"v-col-12 v-col-md-6 pt-0 pb-2"},qt={class:"v-col-12 v-col-md-6 pt-0 pb-2"},Et={class:"v-col-12 v-col-md-6 pt-0 pb-2"},Ft={class:"v-col-12 v-col-md-6 pt-0 pb-2"},It={class:"v-col-12"},Pt={class:"v-col-12 v-col-md-6 pt-0 pb-2"},Ht={class:"v-col-12 v-col-md-6 pt-0 pb-2"},Rt={class:"v-col-12 v-col-md-6 pt-0 pb-2"},Bt={class:"v-col-12 v-col-md-6 pt-0 pb-2"},Jt={class:"v-col-12 v-col-md-6 pt-0 pb-2"},Kt={class:"v-col-12 v-col-md-6 pt-0 pb-2"},Zt={class:"v-col-12 mb-6"},Gt={class:"v-col-12 mb-6"},Xt={class:"v-col-12 mb-6"},Qt=l("div",{class:"v-col-12 pt-0 font-weight-bold"},"Attachment",-1),ea={class:"v-col-12 pt-0"},ta={class:"v-col-12 pb-2"},aa={style:{height:"680px",width:"100%"},class:"d-flex align-center justify-center"},la={class:"v-col-12 pt-0 pb-2"},ca={__name:"AssetForm",props:{page:{type:String,default:"add"},asset:{type:Object,default:null}},setup(k){const V=k,H=Ye(),E=B({}),N=Me(),j=_t();j.list.length==0&&j.getCompanies(N.token);const F=Je();F.list.length==0&&F.getCategories(N.token);const i=yt();i.list.length==0&&i.getLocations(N.token);const $=Ke();($.list.length==0||$.conditions.length==0)&&$.getStatuses(N.token);const M=Le();M.list.length==0&&(console.log("fORM",M.list),M.getVendors(N.token));const w=B(window.location.origin),b=B("specification"),S=y=>{b.value=y};let m=ze({Name:T().required().max(150),"Serial Number":T().max(80).nullable(),"Asset Code":T().max(50).nullable(),"Section code":T().max(30).nullable(),Category:T().required(),Company:T().required(),Location:T().required(),"Asset Status":T().required(),Specification:T().max(120).nullable(),Brand:T().required(),Model:T().required(),Condition:T().required()});const u=B(!1),a=B({}),C=B([]),he=Ie(()=>C.value.map(y=>y.id)),fe=y=>{a.value=Object.assign({},y),C.value=y&&y.attachments?Object.assign([],y.attachments):[],y&&y.financial_information&&(a.value.capitalization_price=y.financial_information.capitalization_price,a.value.depreciation_percentage=y.financial_information.depreciation_percentage,a.value.scrap_value=y.financial_information.scrap_value,a.value.scrap_date=y.financial_information.scrap_date,a.value.capitalization_date=y.financial_information.capitalization_date,a.value.end_of_life=y.financial_information.end_of_life)};fe(V.asset),xe(()=>V.asset,y=>{fe(y)});const de=async()=>{u.value=!0,a.value.file_ids=he.value,a.value.company_code=j.list.filter(y=>y.id==a.value.company_id)[0].code,a.value.category_code=F.list.filter(y=>y.id==a.value.category_id)[0].code,a.value.financial_information_id=a.value.financial_information?a.value.financial_information.id:null,await ie(N.token).post("/api/asset/save",a.value).then(y=>{E.value={status:!0,type:"success",text:y.data.message},u.value=!1,V.page=="add"&&H.push({name:"edit-asset",params:{id:y.data.asset.id}}).catch(t=>{console.log("router.push",t)})}).catch(y=>{console.log("saveAsset",y),E.value={status:!0,type:"error",text:"Error while saving asset"},u.value=!1})},be=y=>{let t=null;y.map(e=>{t=C.value.find(g=>g.id==e.id),t||C.value.push(e)})},X=B(!1),Z=B(1),_e=y=>{Z.value=y,X.value=!0},ue=y=>{C.value=C.value.filter(t=>t.id!==y)};return(y,t)=>(D(),K(le,{loading:u.value,"max-width":"1600px",class:"mx-auto elevation-0"},{default:r(()=>[s(_(Ne),{as:"v-form","validation-schema":_(m)},{default:r(()=>[s(Oe,{class:"pb-6 pt-3 d-flex align-center justify-space-between"},{default:r(()=>[l("div",gt,A(V.page+" Asset"),1),l("div",Vt,[s(P,{color:"primary",loading:u.value,onClick:de},{default:r(()=>[q("Save")]),_:1},8,["loading"])])]),_:1}),s(We,null,{default:r(()=>[s(J,null,{default:r(()=>[ht,l("div",bt,[s(_(Y),{name:"Name",modelValue:a.value.asset_name,"onUpdate:modelValue":t[1]||(t[1]=e=>a.value.asset_name=e)},{default:r(({field:e,errors:g})=>[s(O,W({modelValue:a.value.asset_name,"onUpdate:modelValue":t[0]||(t[0]=h=>a.value.asset_name=h)},e,{label:"Name*",variant:"outlined",density:"compact","error-messages":g}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])]),l("div",$t,[s(_(Y),{name:"Serial Number",modelValue:a.value.serial_number,"onUpdate:modelValue":t[3]||(t[3]=e=>a.value.serial_number=e)},{default:r(({field:e,errors:g})=>[s(O,W({modelValue:a.value.serial_number,"onUpdate:modelValue":t[2]||(t[2]=h=>a.value.serial_number=h)},e,{label:"Serial Number(Optional)",variant:"outlined",density:"compact","error-messages":g}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])]),l("div",xt,[s(_(Y),{name:"Section code",modelValue:a.value.section_code,"onUpdate:modelValue":t[5]||(t[5]=e=>a.value.section_code=e)},{default:r(({field:e,errors:g})=>[s(O,W({modelValue:a.value.section_code,"onUpdate:modelValue":t[4]||(t[4]=h=>a.value.section_code=h)},e,{label:"Section code (optional)",variant:"outlined",density:"compact","error-messages":g}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])]),l("div",wt,[s(ae,{modelValue:a.value.category_id,"onUpdate:modelValue":t[6]||(t[6]=e=>a.value.category_id=e),items:_(F).list,"item-title":"title","item-value":"id",label:"Category*",density:"compact",variant:"outlined",rules:[e=>!!e||"Category is required"]},null,8,["modelValue","items","rules"])]),l("div",St,[s(ae,{modelValue:a.value.company_id,"onUpdate:modelValue":t[7]||(t[7]=e=>a.value.company_id=e),items:_(j).list,"item-title":"title","item-value":"id",label:"Company*",density:"compact",variant:"outlined",rules:[e=>!!e||"Company is required"]},null,8,["modelValue","items","rules"])]),l("div",Dt,[s(ae,{modelValue:a.value.location_id,"onUpdate:modelValue":t[8]||(t[8]=e=>a.value.location_id=e),items:_(i).list,"item-title":"title","item-value":"id",label:"Location*",density:"compact",variant:"outlined",rules:[e=>!!e||"Location is required"]},null,8,["modelValue","items","rules"])]),l("div",Mt,[s(_(Y),{name:"Asset Code",modelValue:a.value.asset_code,"onUpdate:modelValue":t[10]||(t[10]=e=>a.value.asset_code=e)},{default:r(({field:e,errors:g})=>[s(O,W({readonly:"",modelValue:a.value.asset_code,"onUpdate:modelValue":t[9]||(t[9]=h=>a.value.asset_code=h)},e,{label:"Asset Code (Auto Generated)",variant:"outlined",density:"compact","error-messages":g}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])]),l("div",kt,[s(ae,{modelValue:a.value.status_id,"onUpdate:modelValue":t[11]||(t[11]=e=>a.value.status_id=e),items:_($).assets,disabled:a.value.status_id==2,"item-title":"title","item-value":"id",label:"Asset Status*",density:"compact",variant:"outlined",rules:[e=>!!e||"Asset Status is required"]},null,8,["modelValue","items","disabled","rules"])])]),_:1}),s(J,null,{default:r(()=>[V.page=="edit"?(D(),G("div",Ct," Additional Info ")):se("",!0),V.page=="edit"?(D(),G("div",Ut,[s(P,{class:"mr-2 mb-2",onClick:t[12]||(t[12]=()=>S("specification")),color:b.value=="specification"?"primary":"white"},{default:r(()=>[q("Specification")]),_:1},8,["color"]),s(P,{class:"mr-2 mb-2",onClick:t[13]||(t[13]=()=>S("purchase")),color:b.value=="purchase"?"primary":"white"},{default:r(()=>[q("Purchase")]),_:1},8,["color"]),s(P,{class:"mr-2 mb-2",onClick:t[14]||(t[14]=()=>S("financial")),color:b.value=="financial"?"primary":"white"},{default:r(()=>[q("Financial")]),_:1},8,["color"]),s(P,{class:"mr-2 mb-2",onClick:t[15]||(t[15]=()=>S("warranty")),color:b.value=="warranty"?"primary":"white"},{default:r(()=>[q("Warranty")]),_:1},8,["color"]),s(P,{class:"mr-2 mb-2",onClick:t[16]||(t[16]=()=>S("allotted")),color:b.value=="allotted"?"primary":"white"},{default:r(()=>[q("Allotted")]),_:1},8,["color"]),s(P,{class:"mr-2 mb-2",onClick:t[17]||(t[17]=()=>S("maintenance")),color:b.value=="maintenance"?"primary":"white"},{default:r(()=>[q("Maintenance")]),_:1},8,["color"])])):se("",!0),l("div",Ot,A(b.value+" Information"),1),oe(l("div",At,[s(J,null,{default:r(()=>[l("div",Wt,[s(_(Y),{name:"Specification",modelValue:a.value.specification,"onUpdate:modelValue":t[19]||(t[19]=e=>a.value.specification=e)},{default:r(({field:e,errors:g})=>[s(O,W({modelValue:a.value.specification,"onUpdate:modelValue":t[18]||(t[18]=h=>a.value.specification=h)},e,{label:"Specification*",variant:"outlined",density:"compact","error-messages":g}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])]),l("div",Yt,[s(O,{modelValue:a.value.model,"onUpdate:modelValue":t[20]||(t[20]=e=>a.value.model=e),label:"Model*",variant:"outlined",density:"compact"},null,8,["modelValue"])]),l("div",zt,[s(O,{modelValue:a.value.brand,"onUpdate:modelValue":t[21]||(t[21]=e=>a.value.brand=e),label:"Brand*",variant:"outlined",density:"compact"},null,8,["modelValue"])]),l("div",Nt,[s(ae,{modelValue:a.value.condition_id,"onUpdate:modelValue":t[22]||(t[22]=e=>a.value.condition_id=e),items:_($).conditions,"item-title":"title","item-value":"id",label:"Condition*",density:"compact",variant:"outlined",rules:[e=>!!e||"Condition is required"]},null,8,["modelValue","items","rules"])]),l("div",jt,[s(Pe,{modelValue:a.value.remarks,"onUpdate:modelValue":t[23]||(t[23]=e=>a.value.remarks=e),label:"Asset Remarks*",density:"compact",variant:"outlined",rows:"2"},null,8,["modelValue"])])]),_:1})],512),[[re,b.value=="specification"]]),oe(l("div",Tt,[s(J,null,{default:r(()=>[l("div",Lt,[s(_(Y),{name:"Price",modelValue:a.value.price,"onUpdate:modelValue":t[25]||(t[25]=e=>a.value.price=e)},{default:r(({field:e,errors:g})=>[s(O,W({modelValue:a.value.price,"onUpdate:modelValue":t[24]||(t[24]=h=>a.value.price=h)},e,{label:"Price",variant:"outlined",density:"compact","error-messages":g}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])]),l("div",qt,[s(ae,{modelValue:a.value.vendor_id,"onUpdate:modelValue":t[26]||(t[26]=e=>a.value.vendor_id=e),items:_(M).list,"item-title":"title","item-value":"id",label:"Vendor",density:"compact",variant:"outlined",rules:[e=>!!e||"Vendor is required"]},null,8,["modelValue","items","rules"])]),l("div",Et,[s(_(Y),{name:"PO Number",modelValue:a.value.po_number,"onUpdate:modelValue":t[28]||(t[28]=e=>a.value.po_number=e)},{default:r(({field:e,errors:g})=>[s(O,W({modelValue:a.value.po_number,"onUpdate:modelValue":t[27]||(t[27]=h=>a.value.po_number=h)},e,{label:"PO Number",variant:"outlined",density:"compact","error-messages":g}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])]),l("div",Ft,[s(_(Y),{name:"Purchase Date",modelValue:a.value.purchased_date,"onUpdate:modelValue":t[30]||(t[30]=e=>a.value.purchased_date=e)},{default:r(({field:e,errors:g})=>[s(O,W({type:"date",modelValue:a.value.purchased_date,"onUpdate:modelValue":t[29]||(t[29]=h=>a.value.purchased_date=h)},e,{label:"Purchase Date",variant:"outlined",density:"compact","error-messages":g}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])])]),_:1})],512),[[re,b.value=="purchase"]]),oe(l("div",It,[s(J,null,{default:r(()=>[l("div",Pt,[s(_(Y),{name:"Capitalization Price",modelValue:a.value.capitalization_price,"onUpdate:modelValue":t[32]||(t[32]=e=>a.value.capitalization_price=e)},{default:r(({field:e,errors:g})=>[s(O,W({modelValue:a.value.capitalization_price,"onUpdate:modelValue":t[31]||(t[31]=h=>a.value.capitalization_price=h)},e,{label:"Capitalization Price",variant:"outlined",density:"compact","error-messages":g}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])]),l("div",Ht,[s(_(Y),{name:"Depreciation Percentage",modelValue:a.value.depreciation_percentage,"onUpdate:modelValue":t[34]||(t[34]=e=>a.value.depreciation_percentage=e)},{default:r(({field:e,errors:g})=>[s(O,W({modelValue:a.value.depreciation_percentage,"onUpdate:modelValue":t[33]||(t[33]=h=>a.value.depreciation_percentage=h)},e,{label:"Depreciation Percentage",variant:"outlined",density:"compact","error-messages":g}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])]),l("div",Rt,[s(_(Y),{name:"Scrap Value",modelValue:a.value.scrap_value,"onUpdate:modelValue":t[36]||(t[36]=e=>a.value.scrap_value=e)},{default:r(({field:e,errors:g})=>[s(O,W({modelValue:a.value.scrap_value,"onUpdate:modelValue":t[35]||(t[35]=h=>a.value.scrap_value=h)},e,{label:"Scrap Value",variant:"outlined",density:"compact","error-messages":g}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])]),l("div",Bt,[s(_(Y),{name:"Scrap Date",modelValue:a.value.scrap_date,"onUpdate:modelValue":t[38]||(t[38]=e=>a.value.scrap_date=e)},{default:r(({field:e,errors:g})=>[s(O,W({type:"date",modelValue:a.value.scrap_date,"onUpdate:modelValue":t[37]||(t[37]=h=>a.value.scrap_date=h)},e,{label:"Scrap Date",variant:"outlined",density:"compact","error-messages":g}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])]),l("div",Jt,[s(_(Y),{name:"Capitalization Date",modelValue:a.value.capitalization_date,"onUpdate:modelValue":t[40]||(t[40]=e=>a.value.capitalization_date=e)},{default:r(({field:e,errors:g})=>[s(O,W({type:"date",modelValue:a.value.capitalization_date,"onUpdate:modelValue":t[39]||(t[39]=h=>a.value.capitalization_date=h)},e,{label:"Capitalization Date",variant:"outlined",density:"compact","error-messages":g}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])]),l("div",Kt,[s(_(Y),{name:"End of Life",modelValue:a.value.end_of_life,"onUpdate:modelValue":t[42]||(t[42]=e=>a.value.end_of_life=e)},{default:r(({field:e,errors:g})=>[s(O,W({type:"date",modelValue:a.value.end_of_life,"onUpdate:modelValue":t[41]||(t[41]=h=>a.value.end_of_life=h)},e,{label:"End of Life",density:"compact",variant:"outlined","error-messages":g}),null,16,["modelValue","error-messages"])]),_:1},8,["modelValue"])])]),_:1})],512),[[re,b.value=="financial"]]),oe(l("div",Zt,[V.page!="add"?(D(),K(dt,{key:0,asset:a.value,page:V.page},null,8,["asset","page"])):se("",!0)],512),[[re,b.value=="warranty"]]),oe(l("div",Gt,[s(ft,{asset:a.value},null,8,["asset"])],512),[[re,b.value=="allotted"]]),oe(l("div",Xt,[s(mt,{asset:a.value},null,8,["asset"])],512),[[re,b.value=="maintenance"]]),Qt,l("div",ea,[s(J,null,{default:r(()=>[l("div",ta,[s(Be,{options:{multiSelect:!0},onSelect:be})])]),_:1}),C.value.length>0?(D(),K(J,{key:0,class:"px-1"},{default:r(()=>[(D(!0),G(ve,null,pe(C.value,(e,g)=>(D(),G("div",{key:e.id,class:"v-col-12 v-col-md-2 pa-2",style:{position:"relative"}},[s(P,{style:{position:"absolute",top:"0",right:"0","z-index":"1"},icon:_(Ae),size:"26px",color:"error",onClick:()=>ue(e.id)},null,8,["icon","onClick"]),s(le,{onClick:()=>_e(g)},{default:r(()=>[s(Se,{src:w.value+"/file/"+e.path,cover:"","aspect-ratio":"1"},null,8,["src"])]),_:2},1032,["onClick"])]))),128)),s(Ue,{modelValue:X.value,"onUpdate:modelValue":t[44]||(t[44]=e=>X.value=e),width:"95%","max-width":"900"},{default:r(()=>[s(le,{class:"bg-black"},{default:r(()=>[s(He,{"hide-delimiter-background":"","show-arrows":"hover",height:"680px",modelValue:Z.value,"onUpdate:modelValue":t[43]||(t[43]=e=>Z.value=e)},{default:r(()=>[(D(!0),G(ve,null,pe(C.value,(e,g)=>(D(),K(Re,{key:g,"reverse-transition":"fade",transition:"fade"},{default:r(()=>[l("div",aa,[s(Se,{src:w.value+"/file/"+e.path},null,8,["src"])])]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),_:1})):(D(),K(J,{key:1},{default:r(()=>[l("div",la,[s(Ve,{color:"grey-lighten-4",class:"pa-6 text-center"},{default:r(()=>[q(" Attachment is empty at the moment. ")]),_:1})])]),_:1}))])]),_:1})]),_:1})]),_:1},8,["validation-schema"]),s(je,{options:E.value},null,8,["options"])]),_:1},8,["loading"]))}};export{ca as _};
