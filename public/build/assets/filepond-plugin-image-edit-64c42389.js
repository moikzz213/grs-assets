/*!
 * FilePondPluginImageExifOrientation 1.0.11
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const Ht=t=>/^image\/jpeg/.test(t.type),tt={JPEG:65496,APP1:65505,EXIF:1165519206,TIFF:18761,Orientation:274,Unknown:65280},et=(t,e,n=!1)=>t.getUint16(e,n),yt=(t,e,n=!1)=>t.getUint32(e,n),Yt=t=>new Promise((e,n)=>{const i=new FileReader;i.onload=function(o){const a=new DataView(o.target.result);if(et(a,0)!==tt.JPEG){e(-1);return}const s=a.byteLength;let l=2;for(;l<s;){const c=et(a,l);if(l+=2,c===tt.APP1){if(yt(a,l+=2)!==tt.EXIF)break;const f=et(a,l+=6)===tt.TIFF;l+=yt(a,l+4,f);const h=et(a,l,f);l+=2;for(let r=0;r<h;r++)if(et(a,l+r*12,f)===tt.Orientation){e(et(a,l+r*12+8,f));return}}else{if((c&tt.Unknown)!==tt.Unknown)break;l+=et(a,l)}}e(-1)},i.readAsArrayBuffer(t.slice(0,64*1024))}),jt=(()=>typeof window<"u"&&typeof window.document<"u")(),Zt=()=>jt,Xt="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=";let Ft;const wt=Zt()?new Image:{};wt.onload=()=>Ft=wt.naturalWidth>wt.naturalHeight;wt.src=Xt;const qt=()=>Ft,Kt=({addFilter:t,utils:e})=>{const{Type:n,isFile:i}=e;return t("DID_LOAD_ITEM",(o,{query:a})=>new Promise((s,l)=>{const c=o.file;if(!i(c)||!Ht(c)||!a("GET_ALLOW_IMAGE_EXIF_ORIENTATION")||!qt())return s(o);Yt(c).then(f=>{o.setMetadata("exif",{orientation:f}),s(o)})})),{options:{allowImageExifOrientation:[!0,n.BOOLEAN]}}},Jt=typeof window<"u"&&typeof window.document<"u";Jt&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:Kt}));/*!
 * FilePondPluginFileValidateSize 2.2.8
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const Qt=({addFilter:t,utils:e})=>{const{Type:n,replaceInString:i,toNaturalFileSize:o}=e;return t("ALLOW_HOPPER_ITEM",(a,{query:s})=>{if(!s("GET_ALLOW_FILE_SIZE_VALIDATION"))return!0;const l=s("GET_MAX_FILE_SIZE");if(l!==null&&a.size>l)return!1;const c=s("GET_MIN_FILE_SIZE");return!(c!==null&&a.size<c)}),t("LOAD_FILE",(a,{query:s})=>new Promise((l,c)=>{if(!s("GET_ALLOW_FILE_SIZE_VALIDATION"))return l(a);const f=s("GET_FILE_VALIDATE_SIZE_FILTER");if(f&&!f(a))return l(a);const h=s("GET_MAX_FILE_SIZE");if(h!==null&&a.size>h){c({status:{main:s("GET_LABEL_MAX_FILE_SIZE_EXCEEDED"),sub:i(s("GET_LABEL_MAX_FILE_SIZE"),{filesize:o(h,".",s("GET_FILE_SIZE_BASE"),s("GET_FILE_SIZE_LABELS",s))})}});return}const r=s("GET_MIN_FILE_SIZE");if(r!==null&&a.size<r){c({status:{main:s("GET_LABEL_MIN_FILE_SIZE_EXCEEDED"),sub:i(s("GET_LABEL_MIN_FILE_SIZE"),{filesize:o(r,".",s("GET_FILE_SIZE_BASE"),s("GET_FILE_SIZE_LABELS",s))})}});return}const g=s("GET_MAX_TOTAL_FILE_SIZE");if(g!==null&&s("GET_ACTIVE_ITEMS").reduce((E,m)=>E+m.fileSize,0)>g){c({status:{main:s("GET_LABEL_MAX_TOTAL_FILE_SIZE_EXCEEDED"),sub:i(s("GET_LABEL_MAX_TOTAL_FILE_SIZE"),{filesize:o(g,".",s("GET_FILE_SIZE_BASE"),s("GET_FILE_SIZE_LABELS",s))})}});return}l(a)})),{options:{allowFileSizeValidation:[!0,n.BOOLEAN],maxFileSize:[null,n.INT],minFileSize:[null,n.INT],maxTotalFileSize:[null,n.INT],fileValidateSizeFilter:[null,n.FUNCTION],labelMinFileSizeExceeded:["File is too small",n.STRING],labelMinFileSize:["Minimum file size is {filesize}",n.STRING],labelMaxFileSizeExceeded:["File is too large",n.STRING],labelMaxFileSize:["Maximum file size is {filesize}",n.STRING],labelMaxTotalFileSizeExceeded:["Maximum total size exceeded",n.STRING],labelMaxTotalFileSize:["Maximum total file size is {filesize}",n.STRING]}}},te=typeof window<"u"&&typeof window.document<"u";te&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:Qt}));/*!
 * FilePondPluginFileValidateType 1.2.8
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const ee=({addFilter:t,utils:e})=>{const{Type:n,isString:i,replaceInString:o,guesstimateMimeType:a,getExtensionFromFilename:s,getFilenameFromURL:l}=e,c=(d,E)=>{const m=(/^[^/]+/.exec(d)||[]).pop(),p=E.slice(0,-2);return m===p},f=(d,E)=>d.some(m=>/\*$/.test(m)?c(E,m):m===E),h=d=>{let E="";if(i(d)){const m=l(d),p=s(m);p&&(E=a(p))}else E=d.type;return E},r=(d,E,m)=>{if(E.length===0)return!0;const p=h(d);return m?new Promise((T,u)=>{m(d,p).then(w=>{f(E,w)?T():u()}).catch(u)}):f(E,p)},g=d=>E=>d[E]===null?!1:d[E]||E;return t("SET_ATTRIBUTE_TO_OPTION_MAP",d=>Object.assign(d,{accept:"acceptedFileTypes"})),t("ALLOW_HOPPER_ITEM",(d,{query:E})=>E("GET_ALLOW_FILE_TYPE_VALIDATION")?r(d,E("GET_ACCEPTED_FILE_TYPES")):!0),t("LOAD_FILE",(d,{query:E})=>new Promise((m,p)=>{if(!E("GET_ALLOW_FILE_TYPE_VALIDATION")){m(d);return}const T=E("GET_ACCEPTED_FILE_TYPES"),u=E("GET_FILE_VALIDATE_TYPE_DETECT_TYPE"),w=r(d,T,u),I=()=>{const _=T.map(g(E("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES_MAP"))).filter(M=>M!==!1),R=_.filter(function(M,y){return _.indexOf(M)===y});p({status:{main:E("GET_LABEL_FILE_TYPE_NOT_ALLOWED"),sub:o(E("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES"),{allTypes:R.join(", "),allButLastType:R.slice(0,-1).join(", "),lastType:R[_.length-1]})}})};if(typeof w=="boolean")return w?m(d):I();w.then(()=>{m(d)}).catch(I)})),{options:{allowFileTypeValidation:[!0,n.BOOLEAN],acceptedFileTypes:[[],n.ARRAY],labelFileTypeNotAllowed:["File is of invalid type",n.STRING],fileValidateTypeLabelExpectedTypes:["Expects {allButLastType} or {lastType}",n.STRING],fileValidateTypeLabelExpectedTypesMap:[{},n.OBJECT],fileValidateTypeDetectType:[null,n.FUNCTION]}}},ne=typeof window<"u"&&typeof window.document<"u";ne&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:ee}));/*!
 * FilePondPluginImageCrop 2.0.6
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const Mt=t=>/^image/.test(t.type),ie=({addFilter:t,utils:e})=>{const{Type:n,isFile:i,getNumericAspectRatioFromString:o}=e,a=(f,h)=>!(!Mt(f.file)||!h("GET_ALLOW_IMAGE_CROP")),s=f=>typeof f=="object",l=f=>typeof f=="number",c=(f,h)=>f.setMetadata("crop",Object.assign({},f.getMetadata("crop"),h));return t("DID_CREATE_ITEM",(f,{query:h})=>{f.extend("setImageCrop",r=>{if(!(!a(f,h)||!s(center)))return f.setMetadata("crop",r),r}),f.extend("setImageCropCenter",r=>{if(!(!a(f,h)||!s(r)))return c(f,{center:r})}),f.extend("setImageCropZoom",r=>{if(!(!a(f,h)||!l(r)))return c(f,{zoom:Math.max(1,r)})}),f.extend("setImageCropRotation",r=>{if(!(!a(f,h)||!l(r)))return c(f,{rotation:r})}),f.extend("setImageCropFlip",r=>{if(!(!a(f,h)||!s(r)))return c(f,{flip:r})}),f.extend("setImageCropAspectRatio",r=>{if(!a(f,h)||typeof r>"u")return;const g=f.getMetadata("crop"),d=o(r),E={center:{x:.5,y:.5},flip:g?Object.assign({},g.flip):{horizontal:!1,vertical:!1},rotation:0,zoom:1,aspectRatio:d};return f.setMetadata("crop",E),E})}),t("DID_LOAD_ITEM",(f,{query:h})=>new Promise((r,g)=>{const d=f.file;if(!i(d)||!Mt(d)||!h("GET_ALLOW_IMAGE_CROP")||f.getMetadata("crop"))return r(f);const m=h("GET_IMAGE_CROP_ASPECT_RATIO");f.setMetadata("crop",{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},rotation:0,zoom:1,aspectRatio:m?o(m):null}),r(f)})),{options:{allowImageCrop:[!0,n.BOOLEAN],imageCropAspectRatio:[null,n.STRING]}}},oe=typeof window<"u"&&typeof window.document<"u";oe&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:ie}));/*!
 * FilePondPluginImageResize 2.0.10
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const se=t=>/^image/.test(t.type),ae=(t,e)=>{let n=new Image;n.onload=()=>{const i=n.naturalWidth,o=n.naturalHeight;n=null,e({width:i,height:o})},n.onerror=()=>e(null),n.src=t},re=({addFilter:t,utils:e})=>{const{Type:n}=e;return t("DID_LOAD_ITEM",(i,{query:o})=>new Promise((a,s)=>{const l=i.file;if(!se(l)||!o("GET_ALLOW_IMAGE_RESIZE"))return a(i);const c=o("GET_IMAGE_RESIZE_MODE"),f=o("GET_IMAGE_RESIZE_TARGET_WIDTH"),h=o("GET_IMAGE_RESIZE_TARGET_HEIGHT"),r=o("GET_IMAGE_RESIZE_UPSCALE");if(f===null&&h===null)return a(i);const g=f===null?h:f,d=h===null?g:h,E=URL.createObjectURL(l);ae(E,m=>{if(URL.revokeObjectURL(E),!m)return a(i);let{width:p,height:T}=m;const u=(i.getMetadata("exif")||{}).orientation||-1;if(u>=5&&u<=8&&([p,T]=[T,p]),p===g&&T===d)return a(i);if(!r){if(c==="cover"){if(p<=g||T<=d)return a(i)}else if(p<=g&&T<=g)return a(i)}i.setMetadata("resize",{mode:c,upscale:r,size:{width:g,height:d}}),a(i)})})),{options:{allowImageResize:[!0,n.BOOLEAN],imageResizeMode:["cover",n.STRING],imageResizeUpscale:[!0,n.BOOLEAN],imageResizeTargetWidth:[null,n.INT],imageResizeTargetHeight:[null,n.INT]}}},ce=typeof window<"u"&&typeof window.document<"u";ce&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:re}));/*!
 * FilePondPluginImageTransform 3.8.7
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const le=t=>/^image/.test(t.type),de=t=>t.substr(0,t.lastIndexOf("."))||t,he={jpeg:"jpg","svg+xml":"svg"},ge=(t,e)=>{const n=de(t),i=e.split("/")[1],o=he[i]||i;return`${n}.${o}`},fe=t=>/jpeg|png|svg\+xml/.test(t)?t:"image/jpeg",ue=t=>/^image/.test(t.type),Ee={1:()=>[1,0,0,1,0,0],2:t=>[-1,0,0,1,t,0],3:(t,e)=>[-1,0,0,-1,t,e],4:(t,e)=>[1,0,0,-1,0,e],5:()=>[0,1,1,0,0,0],6:(t,e)=>[0,1,-1,0,e,0],7:(t,e)=>[0,-1,-1,0,e,t],8:t=>[0,-1,1,0,0,t]},pe=(t,e,n)=>(n===-1&&(n=1),Ee[n](t,e)),lt=(t,e)=>({x:t,y:e}),we=(t,e)=>t.x*e.x+t.y*e.y,Rt=(t,e)=>lt(t.x-e.x,t.y-e.y),me=(t,e)=>we(Rt(t,e),Rt(t,e)),xt=(t,e)=>Math.sqrt(me(t,e)),Lt=(t,e)=>{const n=t,i=1.5707963267948966,o=e,a=1.5707963267948966-e,s=Math.sin(i),l=Math.sin(o),c=Math.sin(a),f=Math.cos(a),h=n/s,r=h*l,g=h*c;return lt(f*r,f*g)},Ie=(t,e)=>{const n=t.width,i=t.height,o=Lt(n,e),a=Lt(i,e),s=lt(t.x+Math.abs(o.x),t.y-Math.abs(o.y)),l=lt(t.x+t.width+Math.abs(a.y),t.y+Math.abs(a.x)),c=lt(t.x-Math.abs(a.y),t.y+t.height-Math.abs(a.x));return{width:xt(s,l),height:xt(s,c)}},Nt=(t,e,n=0,i={x:.5,y:.5})=>{const o=i.x>.5?1-i.x:i.x,a=i.y>.5?1-i.y:i.y,s=o*2*t.width,l=a*2*t.height,c=Ie(e,n);return Math.max(c.width/s,c.height/l)},Bt=(t,e)=>{let n=t.width,i=n*e;i>t.height&&(i=t.height,n=i/e);const o=(t.width-n)*.5,a=(t.height-i)*.5;return{x:o,y:a,width:n,height:i}},Ct=(t,e,n=1)=>{const i=t.height/t.width;let o=1,a=e,s=1,l=i;l>a&&(l=a,s=l/i);const c=Math.max(o/s,a/l),f=t.width/(n*c*s),h=f*e;return{width:f,height:h}},Vt=t=>{t.width=1,t.height=1,t.getContext("2d").clearRect(0,0,1,1)},Ot=t=>t&&(t.horizontal||t.vertical),_e=(t,e,n)=>{if(e<=1&&!Ot(n))return t.width=t.naturalWidth,t.height=t.naturalHeight,t;const i=document.createElement("canvas"),o=t.naturalWidth,a=t.naturalHeight,s=e>=5&&e<=8;s?(i.width=a,i.height=o):(i.width=o,i.height=a);const l=i.getContext("2d");if(e&&l.transform.apply(l,pe(o,a,e)),Ot(n)){const c=[1,0,0,1,0,0];(!s&&n.horizontal||s&n.vertical)&&(c[0]=-1,c[4]=o),(!s&&n.vertical||s&&n.horizontal)&&(c[3]=-1,c[5]=a),l.transform(...c)}return l.drawImage(t,0,0,o,a),i},Te=(t,e,n={},i={})=>{const{canvasMemoryLimit:o,background:a=null}=i,s=n.zoom||1,l=_e(t,e,n.flip),c={width:l.width,height:l.height},f=n.aspectRatio||c.height/c.width;let h=Ct(c,f,s);if(o){const w=h.width*h.height;if(w>o){const I=Math.sqrt(o)/Math.sqrt(w);c.width=Math.floor(c.width*I),c.height=Math.floor(c.height*I),h=Ct(c,f,s)}}const r=document.createElement("canvas"),g={x:h.width*.5,y:h.height*.5},d={x:0,y:0,width:h.width,height:h.height,center:g},E=typeof n.scaleToFit>"u"||n.scaleToFit,m=s*Nt(c,Bt(d,f),n.rotation,E?n.center:{x:.5,y:.5});r.width=Math.round(h.width/m),r.height=Math.round(h.height/m),g.x/=m,g.y/=m;const p={x:g.x-c.width*(n.center?n.center.x:.5),y:g.y-c.height*(n.center?n.center.y:.5)},T=r.getContext("2d");a&&(T.fillStyle=a,T.fillRect(0,0,r.width,r.height)),T.translate(g.x,g.y),T.rotate(n.rotation||0),T.drawImage(l,p.x-g.x,p.y-g.y,c.width,c.height);const u=T.getImageData(0,0,r.width,r.height);return Vt(r),u},Ae=(()=>typeof window<"u"&&typeof window.document<"u")();Ae&&(HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,n){var i=this.toDataURL(e,n).split(",")[1];setTimeout(function(){for(var o=atob(i),a=o.length,s=new Uint8Array(a),l=0;l<a;l++)s[l]=o.charCodeAt(l);t(new Blob([s],{type:e||"image/png"}))})}}));const ye=(t,e,n=null)=>new Promise(i=>{const o=n?n(t):t;Promise.resolve(o).then(a=>{a.toBlob(i,e.type,e.quality)})}),mt=(t,e)=>gt(t.x*e,t.y*e),It=(t,e)=>gt(t.x+e.x,t.y+e.y),Ut=t=>{const e=Math.sqrt(t.x*t.x+t.y*t.y);return e===0?{x:0,y:0}:gt(t.x/e,t.y/e)},Q=(t,e,n)=>{const i=Math.cos(e),o=Math.sin(e),a=gt(t.x-n.x,t.y-n.y);return gt(n.x+i*a.x-o*a.y,n.y+o*a.x+i*a.y)},gt=(t=0,e=0)=>({x:t,y:e}),k=(t,e,n=1,i)=>{if(typeof t=="string")return parseFloat(t)*n;if(typeof t=="number")return t*(i?e[i]:Math.min(e.width,e.height))},nt=(t,e,n)=>{const i=t.borderStyle||t.lineStyle||"solid",o=t.backgroundColor||t.fontColor||"transparent",a=t.borderColor||t.lineColor||"transparent",s=k(t.borderWidth||t.lineWidth,e,n),l=t.lineCap||"round",c=t.lineJoin||"round",f=typeof i=="string"?"":i.map(r=>k(r,e,n)).join(","),h=t.opacity||1;return{"stroke-linecap":l,"stroke-linejoin":c,"stroke-width":s||0,"stroke-dasharray":f,stroke:a,fill:o,opacity:h}},Y=t=>t!=null,at=(t,e,n=1)=>{let i=k(t.x,e,n,"width")||k(t.left,e,n,"width"),o=k(t.y,e,n,"height")||k(t.top,e,n,"height"),a=k(t.width,e,n,"width"),s=k(t.height,e,n,"height"),l=k(t.right,e,n,"width"),c=k(t.bottom,e,n,"height");return Y(o)||(Y(s)&&Y(c)?o=e.height-s-c:o=c),Y(i)||(Y(a)&&Y(l)?i=e.width-a-l:i=l),Y(a)||(Y(i)&&Y(l)?a=e.width-i-l:a=0),Y(s)||(Y(o)&&Y(c)?s=e.height-o-c:s=0),{x:i||0,y:o||0,width:a||0,height:s||0}},Me=t=>t.map((e,n)=>`${n===0?"M":"L"} ${e.x} ${e.y}`).join(" "),K=(t,e)=>Object.keys(e).forEach(n=>t.setAttribute(n,e[n])),Re="http://www.w3.org/2000/svg",ot=(t,e)=>{const n=document.createElementNS(Re,t);return e&&K(n,e),n},xe=t=>K(t,{...t.rect,...t.styles}),Le=t=>{const e=t.rect.x+t.rect.width*.5,n=t.rect.y+t.rect.height*.5,i=t.rect.width*.5,o=t.rect.height*.5;return K(t,{cx:e,cy:n,rx:i,ry:o,...t.styles})},Ce={contain:"xMidYMid meet",cover:"xMidYMid slice"},Oe=(t,e)=>{K(t,{...t.rect,...t.styles,preserveAspectRatio:Ce[e.fit]||"none"})},Pe={left:"start",center:"middle",right:"end"},Se=(t,e,n,i)=>{const o=k(e.fontSize,n,i),a=e.fontFamily||"sans-serif",s=e.fontWeight||"normal",l=Pe[e.textAlign]||"start";K(t,{...t.rect,...t.styles,"stroke-width":0,"font-weight":s,"font-size":o,"font-family":a,"text-anchor":l}),t.text!==e.text&&(t.text=e.text,t.textContent=e.text.length?e.text:" ")},Ge=(t,e,n,i)=>{K(t,{...t.rect,...t.styles,fill:"none"});const o=t.childNodes[0],a=t.childNodes[1],s=t.childNodes[2],l=t.rect,c={x:t.rect.x+t.rect.width,y:t.rect.y+t.rect.height};if(K(o,{x1:l.x,y1:l.y,x2:c.x,y2:c.y}),!e.lineDecoration)return;a.style.display="none",s.style.display="none";const f=Ut({x:c.x-l.x,y:c.y-l.y}),h=k(.05,n,i);if(e.lineDecoration.indexOf("arrow-begin")!==-1){const r=mt(f,h),g=It(l,r),d=Q(l,2,g),E=Q(l,-2,g);K(a,{style:"display:block;",d:`M${d.x},${d.y} L${l.x},${l.y} L${E.x},${E.y}`})}if(e.lineDecoration.indexOf("arrow-end")!==-1){const r=mt(f,-h),g=It(c,r),d=Q(c,2,g),E=Q(c,-2,g);K(s,{style:"display:block;",d:`M${d.x},${d.y} L${c.x},${c.y} L${E.x},${E.y}`})}},ve=(t,e,n,i)=>{K(t,{...t.styles,fill:"none",d:Me(e.points.map(o=>({x:k(o.x,n,i,"width"),y:k(o.y,n,i,"height")})))})},ut=t=>e=>ot(t,{id:e.id}),be=t=>{const e=ot("image",{id:t.id,"stroke-linecap":"round","stroke-linejoin":"round",opacity:"0"});return e.onload=()=>{e.setAttribute("opacity",t.opacity||1)},e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.src),e},De=t=>{const e=ot("g",{id:t.id,"stroke-linecap":"round","stroke-linejoin":"round"}),n=ot("line");e.appendChild(n);const i=ot("path");e.appendChild(i);const o=ot("path");return e.appendChild(o),e},Fe={image:be,rect:ut("rect"),ellipse:ut("ellipse"),text:ut("text"),path:ut("path"),line:De},Ne={rect:xe,ellipse:Le,image:Oe,text:Se,path:ve,line:Ge},Be=(t,e)=>Fe[t](e),Ve=(t,e,n,i,o)=>{e!=="path"&&(t.rect=at(n,i,o)),t.styles=nt(n,i,o),Ne[e](t,n,i,o)},Wt=(t,e)=>t[1].zIndex>e[1].zIndex?1:t[1].zIndex<e[1].zIndex?-1:0,Ue=(t,e={},n,i)=>new Promise(o=>{const{background:a=null}=i,s=new FileReader;s.onloadend=()=>{const l=s.result,c=document.createElement("div");c.style.cssText="position:absolute;pointer-events:none;width:0;height:0;visibility:hidden;",c.innerHTML=l;const f=c.querySelector("svg");document.body.appendChild(c);const h=f.getBBox();c.parentNode.removeChild(c);const r=c.querySelector("title"),g=f.getAttribute("viewBox")||"",d=f.getAttribute("width")||"",E=f.getAttribute("height")||"";let m=parseFloat(d)||null,p=parseFloat(E)||null;const T=(d.match(/[a-z]+/)||[])[0]||"",u=(E.match(/[a-z]+/)||[])[0]||"",w=g.split(" ").map(parseFloat),I=w.length?{x:w[0],y:w[1],width:w[2],height:w[3]}:h;let _=m??I.width,R=p??I.height;f.style.overflow="visible",f.setAttribute("width",_),f.setAttribute("height",R);let M="";if(n&&n.length){const H={width:_,height:R};M=n.sort(Wt).reduce((Z,$)=>{const F=Be($[0],$[1]);return Ve(F,$[0],$[1],H),F.removeAttribute("id"),F.getAttribute("opacity")===1&&F.removeAttribute("opacity"),Z+`
`+F.outerHTML+`
`},""),M=`

<g>${M.replace(/&nbsp;/g," ")}</g>

`}const y=e.aspectRatio||R/_,A=_,C=A*y,P=typeof e.scaleToFit>"u"||e.scaleToFit,x=e.center?e.center.x:.5,L=e.center?e.center.y:.5,G=Nt({width:_,height:R},Bt({width:A,height:C},y),e.rotation,P?{x,y:L}:{x:.5,y:.5}),O=e.zoom*G,N=e.rotation*(180/Math.PI),b={x:A*.5,y:C*.5},B={x:b.x-_*x,y:b.y-R*L},v=[`rotate(${N} ${b.x} ${b.y})`,`translate(${b.x} ${b.y})`,`scale(${O})`,`translate(${-b.x} ${-b.y})`,`translate(${B.x} ${B.y})`],D=e.flip&&e.flip.horizontal,S=e.flip&&e.flip.vertical,U=[`scale(${D?-1:1} ${S?-1:1})`,`translate(${D?-_:0} ${S?-R:0})`],V=`<?xml version="1.0" encoding="UTF-8"?>
<svg width="${A}${T}" height="${C}${u}" 
viewBox="0 0 ${A} ${C}" ${a?'style="background:'+a+'" ':""}
preserveAspectRatio="xMinYMin"
xmlns:xlink="http://www.w3.org/1999/xlink"
xmlns="http://www.w3.org/2000/svg">
<!-- Generated by PQINA - https://pqina.nl/ -->
<title>${r?r.textContent:""}</title>
<g transform="${v.join(" ")}">
<g transform="${U.join(" ")}">
${f.outerHTML}${M}
</g>
</g>
</svg>`;o(V)},s.readAsText(t)}),We=t=>{let e;try{e=new ImageData(t.width,t.height)}catch{e=document.createElement("canvas").getContext("2d").createImageData(t.width,t.height)}return e.data.set(t.data),e},$e=()=>{const t={resize:h,filter:f},e=(r,g)=>(r.forEach(d=>{g=t[d.type](g,d.data)}),g),n=(r,g)=>{let d=r.transforms,E=null;if(d.forEach(m=>{m.type==="filter"&&(E=m)}),E){let m=null;d.forEach(p=>{p.type==="resize"&&(m=p)}),m&&(m.data.matrix=E.data,d=d.filter(p=>p.type!=="filter"))}g(e(d,r.imageData))};self.onmessage=r=>{n(r.data.message,g=>{self.postMessage({id:r.data.id,message:g},[g.data.buffer])})};const i=1,o=1,a=1;function s(r,g,d){const E=g[r]/255,m=g[r+1]/255,p=g[r+2]/255,T=g[r+3]/255,u=E*d[0]+m*d[1]+p*d[2]+T*d[3]+d[4],w=E*d[5]+m*d[6]+p*d[7]+T*d[8]+d[9],I=E*d[10]+m*d[11]+p*d[12]+T*d[13]+d[14],_=E*d[15]+m*d[16]+p*d[17]+T*d[18]+d[19],R=Math.max(0,u*_)+i*(1-_),M=Math.max(0,w*_)+o*(1-_),y=Math.max(0,I*_)+a*(1-_);g[r]=Math.max(0,Math.min(1,R))*255,g[r+1]=Math.max(0,Math.min(1,M))*255,g[r+2]=Math.max(0,Math.min(1,y))*255}const l=self.JSON.stringify([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]);function c(r){return self.JSON.stringify(r||[])===l}function f(r,g){if(!g||c(g))return r;const d=r.data,E=d.length,m=g[0],p=g[1],T=g[2],u=g[3],w=g[4],I=g[5],_=g[6],R=g[7],M=g[8],y=g[9],A=g[10],C=g[11],P=g[12],x=g[13],L=g[14],G=g[15],O=g[16],N=g[17],b=g[18],B=g[19];let v=0,D=0,S=0,U=0,V=0,H=0,Z=0,$=0,F=0,W=0,X=0,it=0;for(;v<E;v+=4)D=d[v]/255,S=d[v+1]/255,U=d[v+2]/255,V=d[v+3]/255,H=D*m+S*p+U*T+V*u+w,Z=D*I+S*_+U*R+V*M+y,$=D*A+S*C+U*P+V*x+L,F=D*G+S*O+U*N+V*b+B,W=Math.max(0,H*F)+i*(1-F),X=Math.max(0,Z*F)+o*(1-F),it=Math.max(0,$*F)+a*(1-F),d[v]=Math.max(0,Math.min(1,W))*255,d[v+1]=Math.max(0,Math.min(1,X))*255,d[v+2]=Math.max(0,Math.min(1,it))*255;return r}function h(r,g){let{mode:d="contain",upscale:E=!1,width:m,height:p,matrix:T}=g;if(T=!T||c(T)?null:T,!m&&!p)return f(r,T);if(m===null?m=p:p===null&&(p=m),d!=="force"){let x=m/r.width,L=p/r.height,G=1;if(d==="cover"?G=Math.max(x,L):d==="contain"&&(G=Math.min(x,L)),G>1&&E===!1)return f(r,T);m=r.width*G,p=r.height*G}const u=r.width,w=r.height,I=Math.round(m),_=Math.round(p),R=r.data,M=new Uint8ClampedArray(I*_*4),y=u/I,A=w/_,C=Math.ceil(y*.5),P=Math.ceil(A*.5);for(let x=0;x<_;x++)for(let L=0;L<I;L++){let G=(L+x*I)*4,O=0,N=0,b=0,B=0,v=0,D=0,S=0,U=(x+.5)*A;for(let V=Math.floor(x*A);V<(x+1)*A;V++){let H=Math.abs(U-(V+.5))/P,Z=(L+.5)*y,$=H*H;for(let F=Math.floor(L*y);F<(L+1)*y;F++){let W=Math.abs(Z-(F+.5))/C,X=Math.sqrt($+W*W);if(X>=-1&&X<=1&&(O=2*X*X*X-3*X*X+1,O>0)){W=4*(F+V*u);let it=R[W+3];S+=O*it,b+=O,it<255&&(O=O*it/250),B+=O*R[W],v+=O*R[W+1],D+=O*R[W+2],N+=O}}}M[G]=B/N,M[G+1]=v/N,M[G+2]=D/N,M[G+3]=S/b,T&&s(G,M,T)}return{data:M,width:I,height:_}}},ke=(t,e)=>{if(t.getUint32(e+4,!1)!==1165519206)return;e+=4;const n=t.getUint16(e+=6,!1)===18761;e+=t.getUint32(e+4,n);const i=t.getUint16(e,n);e+=2;for(let o=0;o<i;o++)if(t.getUint16(e+o*12,n)===274)return t.setUint16(e+o*12+8,1,n),!0;return!1},ze=t=>{const e=new DataView(t);if(e.getUint16(0)!==65496)return null;let n=2,i,o,a=!1;for(;n<e.byteLength&&(i=e.getUint16(n,!1),o=e.getUint16(n+2,!1)+2,!(!(i>=65504&&i<=65519||i===65534)||(a||(a=ke(e,n)),n+o>e.byteLength)));)n+=o;return t.slice(0,n)},He=t=>new Promise(e=>{const n=new FileReader;n.onload=()=>e(ze(n.result)||null),n.readAsArrayBuffer(t.slice(0,256*1024))}),Ye=()=>window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,je=(t,e)=>{const n=Ye();if(n){const i=new n;return i.append(t),i.getBlob(e)}return new Blob([t],{type:e})},Ze=()=>Math.random().toString(36).substr(2,9),Xe=t=>{const e=new Blob(["(",t.toString(),")()"],{type:"application/javascript"}),n=URL.createObjectURL(e),i=new Worker(n),o=[];return{transfer:()=>{},post:(a,s,l)=>{const c=Ze();o[c]=s,i.onmessage=f=>{const h=o[f.data.id];h&&(h(f.data.message),delete o[f.data.id])},i.postMessage({id:c,message:a},l)},terminate:()=>{i.terminate(),URL.revokeObjectURL(n)}}},qe=t=>new Promise((e,n)=>{const i=new Image;i.onload=()=>{e(i)},i.onerror=o=>{n(o)},i.src=t}),Ke=t=>t.reduce((e,n)=>e.then(i=>n().then(Array.prototype.concat.bind(i))),Promise.resolve([])),Je=(t,e)=>new Promise(n=>{const i={width:t.width,height:t.height},o=t.getContext("2d"),a=e.sort(Wt).map(s=>()=>new Promise(l=>{an[s[0]](o,i,s[1],l)&&l()}));Ke(a).then(()=>n(t))}),rt=(t,e)=>{t.beginPath(),t.lineCap=e["stroke-linecap"],t.lineJoin=e["stroke-linejoin"],t.lineWidth=e["stroke-width"],e["stroke-dasharray"].length&&t.setLineDash(e["stroke-dasharray"].split(",")),t.fillStyle=e.fill,t.strokeStyle=e.stroke,t.globalAlpha=e.opacity||1},ct=t=>{t.fill(),t.stroke(),t.globalAlpha=1},Qe=(t,e,n)=>{const i=at(n,e),o=nt(n,e);return rt(t,o),t.rect(i.x,i.y,i.width,i.height),ct(t),!0},tn=(t,e,n)=>{const i=at(n,e),o=nt(n,e);rt(t,o);const a=i.x,s=i.y,l=i.width,c=i.height,f=.5522848,h=l/2*f,r=c/2*f,g=a+l,d=s+c,E=a+l/2,m=s+c/2;return t.moveTo(a,m),t.bezierCurveTo(a,m-r,E-h,s,E,s),t.bezierCurveTo(E+h,s,g,m-r,g,m),t.bezierCurveTo(g,m+r,E+h,d,E,d),t.bezierCurveTo(E-h,d,a,m+r,a,m),ct(t),!0},en=(t,e,n,i)=>{const o=at(n,e),a=nt(n,e);rt(t,a);const s=new Image;new URL(n.src,window.location.href).origin!==window.location.origin&&(s.crossOrigin=""),s.onload=()=>{if(n.fit==="cover"){const c=o.width/o.height,f=c>1?s.width:s.height*c,h=c>1?s.width/c:s.height,r=s.width*.5-f*.5,g=s.height*.5-h*.5;t.drawImage(s,r,g,f,h,o.x,o.y,o.width,o.height)}else if(n.fit==="contain"){const c=Math.min(o.width/s.width,o.height/s.height),f=c*s.width,h=c*s.height,r=o.x+o.width*.5-f*.5,g=o.y+o.height*.5-h*.5;t.drawImage(s,0,0,s.width,s.height,r,g,f,h)}else t.drawImage(s,0,0,s.width,s.height,o.x,o.y,o.width,o.height);ct(t),i()},s.src=n.src},nn=(t,e,n)=>{const i=at(n,e),o=nt(n,e);rt(t,o);const a=k(n.fontSize,e),s=n.fontFamily||"sans-serif",l=n.fontWeight||"normal",c=n.textAlign||"left";return t.font=`${l} ${a}px ${s}`,t.textAlign=c,t.fillText(n.text,i.x,i.y),ct(t),!0},on=(t,e,n)=>{const i=nt(n,e);rt(t,i),t.beginPath();const o=n.points.map(s=>({x:k(s.x,e,1,"width"),y:k(s.y,e,1,"height")}));t.moveTo(o[0].x,o[0].y);const a=o.length;for(let s=1;s<a;s++)t.lineTo(o[s].x,o[s].y);return ct(t),!0},sn=(t,e,n)=>{const i=at(n,e),o=nt(n,e);rt(t,o),t.beginPath();const a={x:i.x,y:i.y},s={x:i.x+i.width,y:i.y+i.height};t.moveTo(a.x,a.y),t.lineTo(s.x,s.y);const l=Ut({x:s.x-a.x,y:s.y-a.y}),c=.04*Math.min(e.width,e.height);if(n.lineDecoration.indexOf("arrow-begin")!==-1){const f=mt(l,c),h=It(a,f),r=Q(a,2,h),g=Q(a,-2,h);t.moveTo(r.x,r.y),t.lineTo(a.x,a.y),t.lineTo(g.x,g.y)}if(n.lineDecoration.indexOf("arrow-end")!==-1){const f=mt(l,-c),h=It(s,f),r=Q(s,2,h),g=Q(s,-2,h);t.moveTo(r.x,r.y),t.lineTo(s.x,s.y),t.lineTo(g.x,g.y)}return ct(t),!0},an={rect:Qe,ellipse:tn,image:en,text:nn,line:sn,path:on},rn=t=>{const e=document.createElement("canvas");return e.width=t.width,e.height=t.height,e.getContext("2d").putImageData(t,0,0),e},cn=(t,e,n={})=>new Promise((i,o)=>{if(!t||!ue(t))return o({status:"not an image file",file:t});const{stripImageHead:a,beforeCreateBlob:s,afterCreateBlob:l,canvasMemoryLimit:c}=n,{crop:f,size:h,filter:r,markup:g,output:d}=e,E=e.image&&e.image.orientation?Math.max(1,Math.min(8,e.image.orientation)):null,m=d&&d.quality,p=m===null?null:m/100,T=d&&d.type||null,u=d&&d.background||null,w=[];h&&(typeof h.width=="number"||typeof h.height=="number")&&w.push({type:"resize",data:h}),r&&r.length===20&&w.push({type:"filter",data:r});const I=M=>{const y=l?l(M):M;Promise.resolve(y).then(i)},_=(M,y)=>{const A=rn(M),C=g.length?Je(A,g):A;Promise.resolve(C).then(P=>{ye(P,y,s).then(x=>{if(Vt(P),a)return I(x);He(t).then(L=>{L!==null&&(x=new Blob([L,x.slice(20)],{type:x.type})),I(x)})}).catch(o)})};if(/svg/.test(t.type)&&T===null)return Ue(t,f,g,{background:u}).then(M=>{i(je(M,"image/svg+xml"))});const R=URL.createObjectURL(t);qe(R).then(M=>{URL.revokeObjectURL(R);const y=Te(M,E,f,{canvasMemoryLimit:c,background:u}),A={quality:p,type:T||t.type};if(!w.length)return _(y,A);const C=Xe($e);C.post({transforms:w,imageData:y},P=>{_(We(P),A),C.terminate()},[y.data.buffer])}).catch(o)}),ln=["x","y","left","top","right","bottom","width","height"],dn=t=>typeof t=="string"&&/%/.test(t)?parseFloat(t)/100:t,hn=t=>{const[e,n]=t,i=n.points?{}:ln.reduce((o,a)=>(o[a]=dn(n[a]),o),{});return[e,{zIndex:0,...n,...i}]},gn=t=>new Promise((e,n)=>{const i=new Image;i.src=URL.createObjectURL(t);const o=()=>{const s=i.naturalWidth,l=i.naturalHeight;s&&l&&(URL.revokeObjectURL(i.src),clearInterval(a),e({width:s,height:l}))};i.onerror=s=>{URL.revokeObjectURL(i.src),clearInterval(a),n(s)};const a=setInterval(o,1);o()});typeof window<"u"&&typeof window.document<"u"&&(HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,n){const i=this;setTimeout(()=>{const o=i.toDataURL(e,n).split(",")[1],a=atob(o);let s=a.length;const l=new Uint8Array(s);for(;s--;)l[s]=a.charCodeAt(s);t(new Blob([l],{type:e||"image/png"}))})}}));const At=typeof window<"u"&&typeof window.document<"u",fn=At&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,un=({addFilter:t,utils:e})=>{const{Type:n,forin:i,getFileFromBlob:o,isFile:a}=e,s=["crop","resize","filter","markup","output"],l=h=>(r,g,d)=>r(g,h?h(d):d),c=h=>h.aspectRatio===null&&h.rotation===0&&h.zoom===1&&h.center&&h.center.x===.5&&h.center.y===.5&&h.flip&&h.flip.horizontal===!1&&h.flip.vertical===!1;t("SHOULD_PREPARE_OUTPUT",(h,{query:r})=>new Promise(g=>{g(!r("IS_ASYNC"))}));const f=(h,r,g)=>new Promise(d=>{if(!h("GET_ALLOW_IMAGE_TRANSFORM")||g.archived||!a(r)||!le(r))return d(!1);gn(r).then(()=>{const E=h("GET_IMAGE_TRANSFORM_IMAGE_FILTER");if(E){const m=E(r);if(m==null)return handleRevert(!0);if(typeof m=="boolean")return d(m);if(typeof m.then=="function")return m.then(d)}d(!0)}).catch(E=>{d(!1)})});return t("DID_CREATE_ITEM",(h,{query:r,dispatch:g})=>{r("GET_ALLOW_IMAGE_TRANSFORM")&&h.extend("requestPrepare",()=>new Promise((d,E)=>{g("REQUEST_PREPARE_OUTPUT",{query:h.id,item:h,success:d,failure:E},!0)}))}),t("PREPARE_OUTPUT",(h,{query:r,item:g})=>new Promise(d=>{f(r,h,g).then(E=>{if(!E)return d(h);const m=[];r("GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_ORIGINAL")&&m.push(()=>new Promise(y=>{y({name:r("GET_IMAGE_TRANSFORM_VARIANTS_ORIGINAL_NAME"),file:h})})),r("GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_DEFAULT")&&m.push((y,A,C)=>new Promise(P=>{y(A,C).then(x=>P({name:r("GET_IMAGE_TRANSFORM_VARIANTS_DEFAULT_NAME"),file:x}))}));const p=r("GET_IMAGE_TRANSFORM_VARIANTS")||{};i(p,(y,A)=>{const C=l(A);m.push((P,x,L)=>new Promise(G=>{C(P,x,L).then(O=>G({name:y,file:O}))}))});const T=r("GET_IMAGE_TRANSFORM_OUTPUT_QUALITY"),u=r("GET_IMAGE_TRANSFORM_OUTPUT_QUALITY_MODE"),w=T===null?null:T/100,I=r("GET_IMAGE_TRANSFORM_OUTPUT_MIME_TYPE"),_=r("GET_IMAGE_TRANSFORM_CLIENT_TRANSFORMS")||s;g.setMetadata("output",{type:I,quality:w,client:_},!0);const R=(y,A)=>new Promise((C,P)=>{const x={...A};Object.keys(x).filter(S=>S!=="exif").forEach(S=>{_.indexOf(S)===-1&&delete x[S]});const{resize:L,exif:G,output:O,crop:N,filter:b,markup:B}=x,v={image:{orientation:G?G.orientation:null},output:O&&(O.type||typeof O.quality=="number"||O.background)?{type:O.type,quality:typeof O.quality=="number"?O.quality*100:null,background:O.background||r("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR")||null}:void 0,size:L&&(L.size.width||L.size.height)?{mode:L.mode,upscale:L.upscale,...L.size}:void 0,crop:N&&!c(N)?{...N}:void 0,markup:B&&B.length?B.map(hn):[],filter:b};if(v.output){const S=O.type?O.type!==y.type:!1,U=/\/jpe?g$/.test(y.type),V=O.quality!==null?U&&u==="always":!1;if(!!!(v.size||v.crop||v.filter||S||V))return C(y)}const D={beforeCreateBlob:r("GET_IMAGE_TRANSFORM_BEFORE_CREATE_BLOB"),afterCreateBlob:r("GET_IMAGE_TRANSFORM_AFTER_CREATE_BLOB"),canvasMemoryLimit:r("GET_IMAGE_TRANSFORM_CANVAS_MEMORY_LIMIT"),stripImageHead:r("GET_IMAGE_TRANSFORM_OUTPUT_STRIP_IMAGE_HEAD")};cn(y,v,D).then(S=>{const U=o(S,ge(y.name,fe(S.type)));C(U)}).catch(P)}),M=m.map(y=>y(R,h,g.getMetadata()));Promise.all(M).then(y=>{d(y.length===1&&y[0].name===null?y[0].file:y)})})})),{options:{allowImageTransform:[!0,n.BOOLEAN],imageTransformImageFilter:[null,n.FUNCTION],imageTransformOutputMimeType:[null,n.STRING],imageTransformOutputQuality:[null,n.INT],imageTransformOutputStripImageHead:[!0,n.BOOLEAN],imageTransformClientTransforms:[null,n.ARRAY],imageTransformOutputQualityMode:["always",n.STRING],imageTransformVariants:[null,n.OBJECT],imageTransformVariantsIncludeDefault:[!0,n.BOOLEAN],imageTransformVariantsDefaultName:[null,n.STRING],imageTransformVariantsIncludeOriginal:[!1,n.BOOLEAN],imageTransformVariantsOriginalName:["original_",n.STRING],imageTransformBeforeCreateBlob:[null,n.FUNCTION],imageTransformAfterCreateBlob:[null,n.FUNCTION],imageTransformCanvasMemoryLimit:[At&&fn?4096*4096:null,n.INT],imageTransformCanvasBackgroundColor:[null,n.STRING]}}};At&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:un}));/*!
 * FilePondPluginPdfPreview 1.0.2
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit undefined for details.
 */const dt=t=>/pdf$/.test(t.type),En=t=>t.utils.createView({name:"pdf-preview",tag:"div",ignoreRect:!0,create:({root:e,props:n})=>{const i=e.query("GET_ITEM",{id:n.id});if(dt(i.file)){const o=e.query("GET_PDF_PREVIEW_HEIGHT");e.ref.pdf=document.createElement("object"),e.ref.pdf.setAttribute("height",o),e.ref.pdf.setAttribute("width","100%"),e.ref.pdf.setAttribute("style","position:absolute;left:0;right:0;margin:auto;padding-top:unset;"+(o?"height:"+o+"px;":"")),e.element.appendChild(e.ref.pdf)}},write:t.utils.createRoute({DID_PDF_PREVIEW_LOAD:({root:e,props:n})=>{const{id:i}=n,o=e.query("GET_ITEM",{id:i});if(!o)return;let a=window.URL||window.webkitURL,s=new Blob([o.file],{type:o.file.type});if(e.ref.pdf.type=o.file.type,dt(o.file)){const l=e.query("GET_PDF_COMPONENT_EXTRA_PARAMS");e.ref.pdf.data=a.createObjectURL(s)+(l?"#?"+l:"")}e.ref.pdf.addEventListener("load",()=>{dt(o.file)&&e.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:i,height:e.ref.pdf.scrollHeight})},!1)}})}),pn=t=>{const e=({root:i,props:o})=>{const{id:a}=o;i.query("GET_ITEM",a)&&i.dispatch("DID_PDF_PREVIEW_LOAD",{id:a})},n=({root:i,props:o})=>{const a=En(t);i.ref.pdf=i.appendChildView(i.createChildView(a,{id:o.id}))};return t.utils.createView({name:"pdf-preview-wrapper",create:n,write:t.utils.createRoute({DID_PDF_PREVIEW_CONTAINER_CREATE:e})})},wn=t=>{const{addFilter:e,utils:n}=t,{Type:i,createRoute:o}=n,a=pn(t);return e("CREATE_VIEW",s=>{const{is:l,view:c,query:f}=s;if(!l("file"))return;const h=({root:r,props:g})=>{const{id:d}=g,E=f("GET_ITEM",d);!E||E.archived||!dt(E.file)||(r.ref.pdfPreview=c.appendChildView(c.createChildView(a,{id:d})),r.dispatch("DID_PDF_PREVIEW_CONTAINER_CREATE",{id:d}))};c.registerWriter(o({DID_LOAD_ITEM:h},({root:r,props:g})=>{const{id:d}=g,E=f("GET_ITEM",d);!dt(E.file)||r.rect.element.hidden}))}),{options:{allowPdfPreview:[!0,i.BOOLEAN],pdfPreviewHeight:[320,i.INT],pdfComponentExtraParams:["toolbar=0&navpanes=0&scrollbar=0&statusbar=0&zoom=0&messages=0&view=fitH&page=1",i.STRING]}}},mn=typeof window<"u"&&typeof window.document<"u";mn&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:wn}));/*!
 * FilePondPluginImagePreview 4.6.11
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const In=t=>/^image/.test(t.type),Pt=(t,e)=>ft(t.x*e,t.y*e),St=(t,e)=>ft(t.x+e.x,t.y+e.y),_n=t=>{const e=Math.sqrt(t.x*t.x+t.y*t.y);return e===0?{x:0,y:0}:ft(t.x/e,t.y/e)},Et=(t,e,n)=>{const i=Math.cos(e),o=Math.sin(e),a=ft(t.x-n.x,t.y-n.y);return ft(n.x+i*a.x-o*a.y,n.y+o*a.x+i*a.y)},ft=(t=0,e=0)=>({x:t,y:e}),z=(t,e,n=1,i)=>{if(typeof t=="string")return parseFloat(t)*n;if(typeof t=="number")return t*(i?e[i]:Math.min(e.width,e.height))},Tn=(t,e,n)=>{const i=t.borderStyle||t.lineStyle||"solid",o=t.backgroundColor||t.fontColor||"transparent",a=t.borderColor||t.lineColor||"transparent",s=z(t.borderWidth||t.lineWidth,e,n),l=t.lineCap||"round",c=t.lineJoin||"round",f=typeof i=="string"?"":i.map(r=>z(r,e,n)).join(","),h=t.opacity||1;return{"stroke-linecap":l,"stroke-linejoin":c,"stroke-width":s||0,"stroke-dasharray":f,stroke:a,fill:o,opacity:h}},j=t=>t!=null,An=(t,e,n=1)=>{let i=z(t.x,e,n,"width")||z(t.left,e,n,"width"),o=z(t.y,e,n,"height")||z(t.top,e,n,"height"),a=z(t.width,e,n,"width"),s=z(t.height,e,n,"height"),l=z(t.right,e,n,"width"),c=z(t.bottom,e,n,"height");return j(o)||(j(s)&&j(c)?o=e.height-s-c:o=c),j(i)||(j(a)&&j(l)?i=e.width-a-l:i=l),j(a)||(j(i)&&j(l)?a=e.width-i-l:a=0),j(s)||(j(o)&&j(c)?s=e.height-o-c:s=0),{x:i||0,y:o||0,width:a||0,height:s||0}},yn=t=>t.map((e,n)=>`${n===0?"M":"L"} ${e.x} ${e.y}`).join(" "),J=(t,e)=>Object.keys(e).forEach(n=>t.setAttribute(n,e[n])),Mn="http://www.w3.org/2000/svg",st=(t,e)=>{const n=document.createElementNS(Mn,t);return e&&J(n,e),n},Rn=t=>J(t,{...t.rect,...t.styles}),xn=t=>{const e=t.rect.x+t.rect.width*.5,n=t.rect.y+t.rect.height*.5,i=t.rect.width*.5,o=t.rect.height*.5;return J(t,{cx:e,cy:n,rx:i,ry:o,...t.styles})},Ln={contain:"xMidYMid meet",cover:"xMidYMid slice"},Cn=(t,e)=>{J(t,{...t.rect,...t.styles,preserveAspectRatio:Ln[e.fit]||"none"})},On={left:"start",center:"middle",right:"end"},Pn=(t,e,n,i)=>{const o=z(e.fontSize,n,i),a=e.fontFamily||"sans-serif",s=e.fontWeight||"normal",l=On[e.textAlign]||"start";J(t,{...t.rect,...t.styles,"stroke-width":0,"font-weight":s,"font-size":o,"font-family":a,"text-anchor":l}),t.text!==e.text&&(t.text=e.text,t.textContent=e.text.length?e.text:" ")},Sn=(t,e,n,i)=>{J(t,{...t.rect,...t.styles,fill:"none"});const o=t.childNodes[0],a=t.childNodes[1],s=t.childNodes[2],l=t.rect,c={x:t.rect.x+t.rect.width,y:t.rect.y+t.rect.height};if(J(o,{x1:l.x,y1:l.y,x2:c.x,y2:c.y}),!e.lineDecoration)return;a.style.display="none",s.style.display="none";const f=_n({x:c.x-l.x,y:c.y-l.y}),h=z(.05,n,i);if(e.lineDecoration.indexOf("arrow-begin")!==-1){const r=Pt(f,h),g=St(l,r),d=Et(l,2,g),E=Et(l,-2,g);J(a,{style:"display:block;",d:`M${d.x},${d.y} L${l.x},${l.y} L${E.x},${E.y}`})}if(e.lineDecoration.indexOf("arrow-end")!==-1){const r=Pt(f,-h),g=St(c,r),d=Et(c,2,g),E=Et(c,-2,g);J(s,{style:"display:block;",d:`M${d.x},${d.y} L${c.x},${c.y} L${E.x},${E.y}`})}},Gn=(t,e,n,i)=>{J(t,{...t.styles,fill:"none",d:yn(e.points.map(o=>({x:z(o.x,n,i,"width"),y:z(o.y,n,i,"height")})))})},pt=t=>e=>st(t,{id:e.id}),vn=t=>{const e=st("image",{id:t.id,"stroke-linecap":"round","stroke-linejoin":"round",opacity:"0"});return e.onload=()=>{e.setAttribute("opacity",t.opacity||1)},e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.src),e},bn=t=>{const e=st("g",{id:t.id,"stroke-linecap":"round","stroke-linejoin":"round"}),n=st("line");e.appendChild(n);const i=st("path");e.appendChild(i);const o=st("path");return e.appendChild(o),e},Dn={image:vn,rect:pt("rect"),ellipse:pt("ellipse"),text:pt("text"),path:pt("path"),line:bn},Fn={rect:Rn,ellipse:xn,image:Cn,text:Pn,path:Gn,line:Sn},Nn=(t,e)=>Dn[t](e),Bn=(t,e,n,i,o)=>{e!=="path"&&(t.rect=An(n,i,o)),t.styles=Tn(n,i,o),Fn[e](t,n,i,o)},Vn=["x","y","left","top","right","bottom","width","height"],Un=t=>typeof t=="string"&&/%/.test(t)?parseFloat(t)/100:t,Wn=t=>{const[e,n]=t,i=n.points?{}:Vn.reduce((o,a)=>(o[a]=Un(n[a]),o),{});return[e,{zIndex:0,...n,...i}]},$n=(t,e)=>t[1].zIndex>e[1].zIndex?1:t[1].zIndex<e[1].zIndex?-1:0,kn=t=>t.utils.createView({name:"image-preview-markup",tag:"svg",ignoreRect:!0,mixins:{apis:["width","height","crop","markup","resize","dirty"]},write:({root:e,props:n})=>{if(!n.dirty)return;const{crop:i,resize:o,markup:a}=n,s=n.width,l=n.height;let c=i.width,f=i.height;if(o){const{size:d}=o;let E=d&&d.width,m=d&&d.height;const p=o.mode,T=o.upscale;E&&!m&&(m=E),m&&!E&&(E=m);const u=c<E&&f<m;if(!u||u&&T){let w=E/c,I=m/f;if(p==="force")c=E,f=m;else{let _;p==="cover"?_=Math.max(w,I):p==="contain"&&(_=Math.min(w,I)),c=c*_,f=f*_}}}const h={width:s,height:l};e.element.setAttribute("width",h.width),e.element.setAttribute("height",h.height);const r=Math.min(s/c,l/f);e.element.innerHTML="";const g=e.query("GET_IMAGE_PREVIEW_MARKUP_FILTER");a.filter(g).map(Wn).sort($n).forEach(d=>{const[E,m]=d,p=Nn(E,m);Bn(p,E,m,h,r),e.element.appendChild(p)})}}),ht=(t,e)=>({x:t,y:e}),zn=(t,e)=>t.x*e.x+t.y*e.y,Gt=(t,e)=>ht(t.x-e.x,t.y-e.y),Hn=(t,e)=>zn(Gt(t,e),Gt(t,e)),vt=(t,e)=>Math.sqrt(Hn(t,e)),bt=(t,e)=>{const n=t,i=1.5707963267948966,o=e,a=1.5707963267948966-e,s=Math.sin(i),l=Math.sin(o),c=Math.sin(a),f=Math.cos(a),h=n/s,r=h*l,g=h*c;return ht(f*r,f*g)},Yn=(t,e)=>{const n=t.width,i=t.height,o=bt(n,e),a=bt(i,e),s=ht(t.x+Math.abs(o.x),t.y-Math.abs(o.y)),l=ht(t.x+t.width+Math.abs(a.y),t.y+Math.abs(a.x)),c=ht(t.x-Math.abs(a.y),t.y+t.height-Math.abs(a.x));return{width:vt(s,l),height:vt(s,c)}},jn=(t,e,n=1)=>{const i=t.height/t.width;let o=1,a=e,s=1,l=i;l>a&&(l=a,s=l/i);const c=Math.max(o/s,a/l),f=t.width/(n*c*s),h=f*e;return{width:f,height:h}},$t=(t,e,n,i)=>{const o=i.x>.5?1-i.x:i.x,a=i.y>.5?1-i.y:i.y,s=o*2*t.width,l=a*2*t.height,c=Yn(e,n);return Math.max(c.width/s,c.height/l)},kt=(t,e)=>{let n=t.width,i=n*e;i>t.height&&(i=t.height,n=i/e);const o=(t.width-n)*.5,a=(t.height-i)*.5;return{x:o,y:a,width:n,height:i}},Zn=(t,e={})=>{let{zoom:n,rotation:i,center:o,aspectRatio:a}=e;a||(a=t.height/t.width);const s=jn(t,a,n),l={x:s.width*.5,y:s.height*.5},c={x:0,y:0,width:s.width,height:s.height,center:l},f=typeof e.scaleToFit>"u"||e.scaleToFit,h=$t(t,kt(c,a),i,f?o:{x:.5,y:.5}),r=n*h;return{widthFloat:s.width/r,heightFloat:s.height/r,width:Math.round(s.width/r),height:Math.round(s.height/r)}},q={type:"spring",stiffness:.5,damping:.45,mass:10},Xn=t=>t.utils.createView({name:"image-bitmap",ignoreRect:!0,mixins:{styles:["scaleX","scaleY"]},create:({root:e,props:n})=>{e.appendChild(n.image)}}),qn=t=>t.utils.createView({name:"image-canvas-wrapper",tag:"div",ignoreRect:!0,mixins:{apis:["crop","width","height"],styles:["originX","originY","translateX","translateY","scaleX","scaleY","rotateZ"],animations:{originX:q,originY:q,scaleX:q,scaleY:q,translateX:q,translateY:q,rotateZ:q}},create:({root:e,props:n})=>{n.width=n.image.width,n.height=n.image.height,e.ref.bitmap=e.appendChildView(e.createChildView(Xn(t),{image:n.image}))},write:({root:e,props:n})=>{const{flip:i}=n.crop,{bitmap:o}=e.ref;o.scaleX=i.horizontal?-1:1,o.scaleY=i.vertical?-1:1}}),Kn=t=>t.utils.createView({name:"image-clip",tag:"div",ignoreRect:!0,mixins:{apis:["crop","markup","resize","width","height","dirty","background"],styles:["width","height","opacity"],animations:{opacity:{type:"tween",duration:250}}},didWriteView:function({root:e,props:n}){n.background&&(e.element.style.backgroundColor=n.background)},create:({root:e,props:n})=>{e.ref.image=e.appendChildView(e.createChildView(qn(t),Object.assign({},n))),e.ref.createMarkup=()=>{e.ref.markup||(e.ref.markup=e.appendChildView(e.createChildView(kn(t),Object.assign({},n))))},e.ref.destroyMarkup=()=>{e.ref.markup&&(e.removeChildView(e.ref.markup),e.ref.markup=null)};const i=e.query("GET_IMAGE_PREVIEW_TRANSPARENCY_INDICATOR");i!==null&&(i==="grid"?e.element.dataset.transparencyIndicator=i:e.element.dataset.transparencyIndicator="color")},write:({root:e,props:n,shouldOptimize:i})=>{const{crop:o,markup:a,resize:s,dirty:l,width:c,height:f}=n;e.ref.image.crop=o;const h={x:0,y:0,width:c,height:f,center:{x:c*.5,y:f*.5}},r={width:e.ref.image.width,height:e.ref.image.height},g={x:o.center.x*r.width,y:o.center.y*r.height},d={x:h.center.x-r.width*o.center.x,y:h.center.y-r.height*o.center.y},E=Math.PI*2+o.rotation%(Math.PI*2),m=o.aspectRatio||r.height/r.width,p=typeof o.scaleToFit>"u"||o.scaleToFit,T=$t(r,kt(h,m),E,p?o.center:{x:.5,y:.5}),u=o.zoom*T;a&&a.length?(e.ref.createMarkup(),e.ref.markup.width=c,e.ref.markup.height=f,e.ref.markup.resize=s,e.ref.markup.dirty=l,e.ref.markup.markup=a,e.ref.markup.crop=Zn(r,o)):e.ref.markup&&e.ref.destroyMarkup();const w=e.ref.image;if(i){w.originX=null,w.originY=null,w.translateX=null,w.translateY=null,w.rotateZ=null,w.scaleX=null,w.scaleY=null;return}w.originX=g.x,w.originY=g.y,w.translateX=d.x,w.translateY=d.y,w.rotateZ=E,w.scaleX=u,w.scaleY=u}}),Jn=t=>t.utils.createView({name:"image-preview",tag:"div",ignoreRect:!0,mixins:{apis:["image","crop","markup","resize","dirty","background"],styles:["translateY","scaleX","scaleY","opacity"],animations:{scaleX:q,scaleY:q,translateY:q,opacity:{type:"tween",duration:400}}},create:({root:e,props:n})=>{e.ref.clip=e.appendChildView(e.createChildView(Kn(t),{id:n.id,image:n.image,crop:n.crop,markup:n.markup,resize:n.resize,dirty:n.dirty,background:n.background}))},write:({root:e,props:n,shouldOptimize:i})=>{const{clip:o}=e.ref,{image:a,crop:s,markup:l,resize:c,dirty:f}=n;if(o.crop=s,o.markup=l,o.resize=c,o.dirty=f,o.opacity=i?0:1,i||e.rect.element.hidden)return;const h=a.height/a.width;let r=s.aspectRatio||h;const g=e.rect.inner.width,d=e.rect.inner.height;let E=e.query("GET_IMAGE_PREVIEW_HEIGHT");const m=e.query("GET_IMAGE_PREVIEW_MIN_HEIGHT"),p=e.query("GET_IMAGE_PREVIEW_MAX_HEIGHT"),T=e.query("GET_PANEL_ASPECT_RATIO"),u=e.query("GET_ALLOW_MULTIPLE");T&&!u&&(E=g*T,r=T);let w=E!==null?E:Math.max(m,Math.min(g*r,p)),I=w/r;I>g&&(I=g,w=I*r),w>d&&(w=d,I=d/r),o.width=I,o.height=w}});let Qn=`<svg width="500" height="200" viewBox="0 0 500 200" preserveAspectRatio="none">
    <defs>
        <radialGradient id="gradient-__UID__" cx=".5" cy="1.25" r="1.15">
            <stop offset='50%' stop-color='#000000'/>
            <stop offset='56%' stop-color='#0a0a0a'/>
            <stop offset='63%' stop-color='#262626'/>
            <stop offset='69%' stop-color='#4f4f4f'/>
            <stop offset='75%' stop-color='#808080'/>
            <stop offset='81%' stop-color='#b1b1b1'/>
            <stop offset='88%' stop-color='#dadada'/>
            <stop offset='94%' stop-color='#f6f6f6'/>
            <stop offset='100%' stop-color='#ffffff'/>
        </radialGradient>
        <mask id="mask-__UID__">
            <rect x="0" y="0" width="500" height="200" fill="url(#gradient-__UID__)"></rect>
        </mask>
    </defs>
    <rect x="0" width="500" height="200" fill="currentColor" mask="url(#mask-__UID__)"></rect>
</svg>`,Dt=0;const ti=t=>t.utils.createView({name:"image-preview-overlay",tag:"div",ignoreRect:!0,create:({root:e,props:n})=>{let i=Qn;if(document.querySelector("base")){const o=new URL(window.location.href.replace(window.location.hash,"")).href;i=i.replace(/url\(\#/g,"url("+o+"#")}Dt++,e.element.classList.add(`filepond--image-preview-overlay-${n.status}`),e.element.innerHTML=i.replace(/__UID__/g,Dt)},mixins:{styles:["opacity"],animations:{opacity:{type:"spring",mass:25}}}}),ei=function(){self.onmessage=t=>{createImageBitmap(t.data.message.file).then(e=>{self.postMessage({id:t.data.id,message:e},[e])})}},ni=function(){self.onmessage=t=>{const e=t.data.message.imageData,n=t.data.message.colorMatrix,i=e.data,o=i.length,a=n[0],s=n[1],l=n[2],c=n[3],f=n[4],h=n[5],r=n[6],g=n[7],d=n[8],E=n[9],m=n[10],p=n[11],T=n[12],u=n[13],w=n[14],I=n[15],_=n[16],R=n[17],M=n[18],y=n[19];let A=0,C=0,P=0,x=0,L=0;for(;A<o;A+=4)C=i[A]/255,P=i[A+1]/255,x=i[A+2]/255,L=i[A+3]/255,i[A]=Math.max(0,Math.min((C*a+P*s+x*l+L*c+f)*255,255)),i[A+1]=Math.max(0,Math.min((C*h+P*r+x*g+L*d+E)*255,255)),i[A+2]=Math.max(0,Math.min((C*m+P*p+x*T+L*u+w)*255,255)),i[A+3]=Math.max(0,Math.min((C*I+P*_+x*R+L*M+y)*255,255));self.postMessage({id:t.data.id,message:e},[e.data.buffer])}},ii=(t,e)=>{let n=new Image;n.onload=()=>{const i=n.naturalWidth,o=n.naturalHeight;n=null,e(i,o)},n.src=t},oi={1:()=>[1,0,0,1,0,0],2:t=>[-1,0,0,1,t,0],3:(t,e)=>[-1,0,0,-1,t,e],4:(t,e)=>[1,0,0,-1,0,e],5:()=>[0,1,1,0,0,0],6:(t,e)=>[0,1,-1,0,e,0],7:(t,e)=>[0,-1,-1,0,e,t],8:t=>[0,-1,1,0,0,t]},si=(t,e,n,i)=>{i!==-1&&t.transform.apply(t,oi[i](e,n))},ai=(t,e,n,i)=>{e=Math.round(e),n=Math.round(n);const o=document.createElement("canvas");o.width=e,o.height=n;const a=o.getContext("2d");return i>=5&&i<=8&&([e,n]=[n,e]),si(a,e,n,i),a.drawImage(t,0,0,e,n),o},zt=t=>/^image/.test(t.type)&&!/svg/.test(t.type),ri=10,ci=10,li=t=>{const e=Math.min(ri/t.width,ci/t.height),n=document.createElement("canvas"),i=n.getContext("2d"),o=n.width=Math.ceil(t.width*e),a=n.height=Math.ceil(t.height*e);i.drawImage(t,0,0,o,a);let s=null;try{s=i.getImageData(0,0,o,a).data}catch{return null}const l=s.length;let c=0,f=0,h=0,r=0;for(;r<l;r+=4)c+=s[r]*s[r],f+=s[r+1]*s[r+1],h+=s[r+2]*s[r+2];return c=_t(c,l),f=_t(f,l),h=_t(h,l),{r:c,g:f,b:h}},_t=(t,e)=>Math.floor(Math.sqrt(t/(e/4))),di=(t,e)=>(e=e||document.createElement("canvas"),e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),e),hi=t=>{let e;try{e=new ImageData(t.width,t.height)}catch{e=document.createElement("canvas").getContext("2d").createImageData(t.width,t.height)}return e.data.set(new Uint8ClampedArray(t.data)),e},gi=t=>new Promise((e,n)=>{const i=new Image;i.crossOrigin="Anonymous",i.onload=()=>{e(i)},i.onerror=o=>{n(o)},i.src=t}),fi=t=>{const e=ti(t),n=Jn(t),{createWorker:i}=t.utils,o=(u,w,I)=>new Promise(_=>{u.ref.imageData||(u.ref.imageData=I.getContext("2d").getImageData(0,0,I.width,I.height));const R=hi(u.ref.imageData);if(!w||w.length!==20)return I.getContext("2d").putImageData(R,0,0),_();const M=i(ni);M.post({imageData:R,colorMatrix:w},y=>{I.getContext("2d").putImageData(y,0,0),M.terminate(),_()},[R.data.buffer])}),a=(u,w)=>{u.removeChildView(w),w.image.width=1,w.image.height=1,w._destroy()},s=({root:u})=>{const w=u.ref.images.shift();return w.opacity=0,w.translateY=-15,u.ref.imageViewBin.push(w),w},l=({root:u,props:w,image:I})=>{const _=w.id,R=u.query("GET_ITEM",{id:_});if(!R)return;const M=R.getMetadata("crop")||{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},zoom:1,rotation:0,aspectRatio:null},y=u.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR");let A,C,P=!1;u.query("GET_IMAGE_PREVIEW_MARKUP_SHOW")&&(A=R.getMetadata("markup")||[],C=R.getMetadata("resize"),P=!0);const x=u.appendChildView(u.createChildView(n,{id:_,image:I,crop:M,resize:C,markup:A,dirty:P,background:y,opacity:0,scaleX:1.15,scaleY:1.15,translateY:15}),u.childViews.length);u.ref.images.push(x),x.opacity=1,x.scaleX=1,x.scaleY=1,x.translateY=0,setTimeout(()=>{u.dispatch("DID_IMAGE_PREVIEW_SHOW",{id:_})},250)},c=({root:u,props:w})=>{const I=u.query("GET_ITEM",{id:w.id});if(!I)return;const _=u.ref.images[u.ref.images.length-1];_.crop=I.getMetadata("crop"),_.background=u.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR"),u.query("GET_IMAGE_PREVIEW_MARKUP_SHOW")&&(_.dirty=!0,_.resize=I.getMetadata("resize"),_.markup=I.getMetadata("markup"))},f=({root:u,props:w,action:I})=>{if(!/crop|filter|markup|resize/.test(I.change.key)||!u.ref.images.length)return;const _=u.query("GET_ITEM",{id:w.id});if(_){if(/filter/.test(I.change.key)){const R=u.ref.images[u.ref.images.length-1];o(u,I.change.value,R.image);return}if(/crop|markup|resize/.test(I.change.key)){const R=_.getMetadata("crop"),M=u.ref.images[u.ref.images.length-1];if(R&&R.aspectRatio&&M.crop&&M.crop.aspectRatio&&Math.abs(R.aspectRatio-M.crop.aspectRatio)>1e-5){const y=s({root:u});l({root:u,props:w,image:di(y.image)})}else c({root:u,props:w})}}},h=u=>{const I=window.navigator.userAgent.match(/Firefox\/([0-9]+)\./);return(I?parseInt(I[1]):null)<=58?!1:"createImageBitmap"in window&&zt(u)},r=({root:u,props:w})=>{const{id:I}=w,_=u.query("GET_ITEM",I);if(!_)return;const R=URL.createObjectURL(_.file);ii(R,(M,y)=>{u.dispatch("DID_IMAGE_PREVIEW_CALCULATE_SIZE",{id:I,width:M,height:y})})},g=({root:u,props:w})=>{const{id:I}=w,_=u.query("GET_ITEM",I);if(!_)return;const R=URL.createObjectURL(_.file),M=()=>{gi(R).then(y)},y=A=>{URL.revokeObjectURL(R);const P=(_.getMetadata("exif")||{}).orientation||-1;let{width:x,height:L}=A;if(!x||!L)return;P>=5&&P<=8&&([x,L]=[L,x]);const G=Math.max(1,window.devicePixelRatio*.75),N=u.query("GET_IMAGE_PREVIEW_ZOOM_FACTOR")*G,b=L/x,B=u.rect.element.width,v=u.rect.element.height;let D=B,S=D*b;b>1?(D=Math.min(x,B*N),S=D*b):(S=Math.min(L,v*N),D=S/b);const U=ai(A,D,S,P),V=()=>{const Z=u.query("GET_IMAGE_PREVIEW_CALCULATE_AVERAGE_IMAGE_COLOR")?li(data):null;_.setMetadata("color",Z,!0),"close"in A&&A.close(),u.ref.overlayShadow.opacity=1,l({root:u,props:w,image:U})},H=_.getMetadata("filter");H?o(u,H,U).then(V):V()};if(h(_.file)){const A=i(ei);A.post({file:_.file},C=>{if(A.terminate(),!C){M();return}y(C)})}else M()},d=({root:u})=>{const w=u.ref.images[u.ref.images.length-1];w.translateY=0,w.scaleX=1,w.scaleY=1,w.opacity=1},E=({root:u})=>{u.ref.overlayShadow.opacity=1,u.ref.overlayError.opacity=0,u.ref.overlaySuccess.opacity=0},m=({root:u})=>{u.ref.overlayShadow.opacity=.25,u.ref.overlayError.opacity=1},p=({root:u})=>{u.ref.overlayShadow.opacity=.25,u.ref.overlaySuccess.opacity=1},T=({root:u})=>{u.ref.images=[],u.ref.imageData=null,u.ref.imageViewBin=[],u.ref.overlayShadow=u.appendChildView(u.createChildView(e,{opacity:0,status:"idle"})),u.ref.overlaySuccess=u.appendChildView(u.createChildView(e,{opacity:0,status:"success"})),u.ref.overlayError=u.appendChildView(u.createChildView(e,{opacity:0,status:"failure"}))};return t.utils.createView({name:"image-preview-wrapper",create:T,styles:["height"],apis:["height"],destroy:({root:u})=>{u.ref.images.forEach(w=>{w.image.width=1,w.image.height=1})},didWriteView:({root:u})=>{u.ref.images.forEach(w=>{w.dirty=!1})},write:t.utils.createRoute({DID_IMAGE_PREVIEW_DRAW:d,DID_IMAGE_PREVIEW_CONTAINER_CREATE:r,DID_FINISH_CALCULATE_PREVIEWSIZE:g,DID_UPDATE_ITEM_METADATA:f,DID_THROW_ITEM_LOAD_ERROR:m,DID_THROW_ITEM_PROCESSING_ERROR:m,DID_THROW_ITEM_INVALID:m,DID_COMPLETE_ITEM_PROCESSING:p,DID_START_ITEM_PROCESSING:E,DID_REVERT_ITEM_PROCESSING:E},({root:u})=>{const w=u.ref.imageViewBin.filter(I=>I.opacity===0);u.ref.imageViewBin=u.ref.imageViewBin.filter(I=>I.opacity>0),w.forEach(I=>a(u,I)),w.length=0})})},ui=t=>{const{addFilter:e,utils:n}=t,{Type:i,createRoute:o,isFile:a}=n,s=fi(t);return e("CREATE_VIEW",l=>{const{is:c,view:f,query:h}=l;if(!c("file")||!h("GET_ALLOW_IMAGE_PREVIEW"))return;const r=({root:p,props:T})=>{const{id:u}=T,w=h("GET_ITEM",u);if(!w||!a(w.file)||w.archived)return;const I=w.file;if(!In(I)||!h("GET_IMAGE_PREVIEW_FILTER_ITEM")(w))return;const _="createImageBitmap"in(window||{}),R=h("GET_IMAGE_PREVIEW_MAX_FILE_SIZE");if(!_&&R&&I.size>R)return;p.ref.imagePreview=f.appendChildView(f.createChildView(s,{id:u}));const M=p.query("GET_IMAGE_PREVIEW_HEIGHT");M&&p.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:w.id,height:M});const y=!_&&I.size>h("GET_IMAGE_PREVIEW_MAX_INSTANT_PREVIEW_FILE_SIZE");p.dispatch("DID_IMAGE_PREVIEW_CONTAINER_CREATE",{id:u},y)},g=(p,T)=>{if(!p.ref.imagePreview)return;let{id:u}=T;const w=p.query("GET_ITEM",{id:u});if(!w)return;const I=p.query("GET_PANEL_ASPECT_RATIO"),_=p.query("GET_ITEM_PANEL_ASPECT_RATIO"),R=p.query("GET_IMAGE_PREVIEW_HEIGHT");if(I||_||R)return;let{imageWidth:M,imageHeight:y}=p.ref;if(!M||!y)return;const A=p.query("GET_IMAGE_PREVIEW_MIN_HEIGHT"),C=p.query("GET_IMAGE_PREVIEW_MAX_HEIGHT"),x=(w.getMetadata("exif")||{}).orientation||-1;if(x>=5&&x<=8&&([M,y]=[y,M]),!zt(w.file)||p.query("GET_IMAGE_PREVIEW_UPSCALE")){const B=2048/M;M*=B,y*=B}const L=y/M,G=(w.getMetadata("crop")||{}).aspectRatio||L;let O=Math.max(A,Math.min(y,C));const N=p.rect.element.width,b=Math.min(N*G,O);p.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:w.id,height:b})},d=({root:p})=>{p.ref.shouldRescale=!0},E=({root:p,action:T})=>{T.change.key==="crop"&&(p.ref.shouldRescale=!0)},m=({root:p,action:T})=>{p.ref.imageWidth=T.width,p.ref.imageHeight=T.height,p.ref.shouldRescale=!0,p.ref.shouldDrawPreview=!0,p.dispatch("KICK")};f.registerWriter(o({DID_RESIZE_ROOT:d,DID_STOP_RESIZE:d,DID_LOAD_ITEM:r,DID_IMAGE_PREVIEW_CALCULATE_SIZE:m,DID_UPDATE_ITEM_METADATA:E},({root:p,props:T})=>{p.ref.imagePreview&&(p.rect.element.hidden||(p.ref.shouldRescale&&(g(p,T),p.ref.shouldRescale=!1),p.ref.shouldDrawPreview&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{p.dispatch("DID_FINISH_CALCULATE_PREVIEWSIZE",{id:T.id})})}),p.ref.shouldDrawPreview=!1)))}))}),{options:{allowImagePreview:[!0,i.BOOLEAN],imagePreviewFilterItem:[()=>!0,i.FUNCTION],imagePreviewHeight:[null,i.INT],imagePreviewMinHeight:[44,i.INT],imagePreviewMaxHeight:[256,i.INT],imagePreviewMaxFileSize:[null,i.INT],imagePreviewZoomFactor:[2,i.INT],imagePreviewUpscale:[!1,i.BOOLEAN],imagePreviewMaxInstantPreviewFileSize:[1e6,i.INT],imagePreviewTransparencyIndicator:[null,i.STRING],imagePreviewCalculateAverageImageColor:[!1,i.BOOLEAN],imagePreviewMarkupShow:[!0,i.BOOLEAN],imagePreviewMarkupFilter:[()=>!0,i.FUNCTION]}}},Ei=typeof window<"u"&&typeof window.document<"u";Ei&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:ui}));/*!
 * FilePondPluginImageEdit 1.6.3
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const Tt=t=>/^image/.test(t.type),pi=t=>{const{addFilter:e,utils:n,views:i}=t,{Type:o,createRoute:a,createItemAPI:s=h=>h}=n,{fileActionButton:l}=i;e("SHOULD_REMOVE_ON_REVERT",(h,{item:r,query:g})=>new Promise(d=>{const{file:E}=r,m=g("GET_ALLOW_IMAGE_EDIT")&&g("GET_IMAGE_EDIT_ALLOW_EDIT")&&Tt(E);d(!m)})),e("DID_LOAD_ITEM",(h,{query:r,dispatch:g})=>new Promise((d,E)=>{if(h.origin>1){d(h);return}const{file:m}=h;if(!r("GET_ALLOW_IMAGE_EDIT")||!r("GET_IMAGE_EDIT_INSTANT_EDIT")){d(h);return}if(!Tt(m)){d(h);return}const p=(u,w,I)=>_=>{c.shift(),_?w(u):I(u),g("KICK"),T()},T=()=>{if(!c.length)return;const{item:u,resolve:w,reject:I}=c[0];g("EDIT_ITEM",{id:u.id,handleEditorResponse:p(u,w,I)})};f({item:h,resolve:d,reject:E}),c.length===1&&T()})),e("DID_CREATE_ITEM",(h,{query:r,dispatch:g})=>{h.extend("edit",()=>{g("EDIT_ITEM",{id:h.id})})});const c=[],f=h=>(c.push(h),h);return e("CREATE_VIEW",h=>{const{is:r,view:g,query:d}=h;if(!d("GET_ALLOW_IMAGE_EDIT"))return;const E=d("GET_ALLOW_IMAGE_PREVIEW");if(!(r("file-info")&&!E||r("file")&&E))return;const p=d("GET_IMAGE_EDIT_EDITOR");if(!p)return;p.filepondCallbackBridge||(p.outputData=!0,p.outputFile=!1,p.filepondCallbackBridge={onconfirm:p.onconfirm||(()=>{}),oncancel:p.oncancel||(()=>{})});const T=({root:I,props:_,action:R})=>{const{id:M}=_,{handleEditorResponse:y}=R;p.cropAspectRatio=I.query("GET_IMAGE_CROP_ASPECT_RATIO")||p.cropAspectRatio,p.outputCanvasBackgroundColor=I.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR")||p.outputCanvasBackgroundColor;const A=I.query("GET_ITEM",M);if(!A)return;const C=A.file,P=A.getMetadata("crop"),x={center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},zoom:1,rotation:0,aspectRatio:null},L=A.getMetadata("resize"),G=A.getMetadata("filter")||null,O=A.getMetadata("filters")||null,N=A.getMetadata("colors")||null,b=A.getMetadata("markup")||null,B={crop:P||x,size:L?{upscale:L.upscale,mode:L.mode,width:L.size.width,height:L.size.height}:null,filter:O?O.id||O.matrix:I.query("GET_ALLOW_IMAGE_FILTER")&&I.query("GET_IMAGE_FILTER_COLOR_MATRIX")&&!N?G:null,color:N,markup:b};p.onconfirm=({data:v})=>{const{crop:D,size:S,filter:U,color:V,colorMatrix:H,markup:Z}=v,$={};if(D&&($.crop=D),S){const F=(A.getMetadata("resize")||{}).size,W={width:S.width,height:S.height};!(W.width&&W.height)&&F&&(W.width=F.width,W.height=F.height),(W.width||W.height)&&($.resize={upscale:S.upscale,mode:S.mode,size:W})}Z&&($.markup=Z),$.colors=V,$.filters=U,$.filter=H,A.setMetadata($),p.filepondCallbackBridge.onconfirm(v,s(A)),y&&(p.onclose=()=>{y(!0),p.onclose=null})},p.oncancel=()=>{p.filepondCallbackBridge.oncancel(s(A)),y&&(p.onclose=()=>{y(!1),p.onclose=null})},p.open(C,B)},u=({root:I,props:_})=>{if(!d("GET_IMAGE_EDIT_ALLOW_EDIT"))return;const{id:R}=_,M=d("GET_ITEM",R);if(!M)return;const y=M.file;if(Tt(y))if(I.ref.handleEdit=A=>{A.stopPropagation(),I.dispatch("EDIT_ITEM",{id:R})},E){const A=g.createChildView(l,{label:"edit",icon:d("GET_IMAGE_EDIT_ICON_EDIT"),opacity:0});A.element.classList.add("filepond--action-edit-item"),A.element.dataset.align=d("GET_STYLE_IMAGE_EDIT_BUTTON_EDIT_ITEM_POSITION"),A.on("click",I.ref.handleEdit),I.ref.buttonEditItem=g.appendChildView(A)}else{const A=g.element.querySelector(".filepond--file-info-main"),C=document.createElement("button");C.className="filepond--action-edit-item-alt",C.innerHTML=d("GET_IMAGE_EDIT_ICON_EDIT")+"<span>edit</span>",C.addEventListener("click",I.ref.handleEdit),A.appendChild(C),I.ref.editButton=C}};g.registerDestroyer(({root:I})=>{I.ref.buttonEditItem&&I.ref.buttonEditItem.off("click",I.ref.handleEdit),I.ref.editButton&&I.ref.editButton.removeEventListener("click",I.ref.handleEdit)});const w={EDIT_ITEM:T,DID_LOAD_ITEM:u};if(E){const I=({root:_})=>{_.ref.buttonEditItem&&(_.ref.buttonEditItem.opacity=1)};w.DID_IMAGE_PREVIEW_SHOW=I}g.registerWriter(a(w))}),{options:{allowImageEdit:[!0,o.BOOLEAN],styleImageEditButtonEditItemPosition:["bottom center",o.STRING],imageEditInstantEdit:[!1,o.BOOLEAN],imageEditAllowEdit:[!0,o.BOOLEAN],imageEditIconEdit:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M8.5 17h1.586l7-7L15.5 8.414l-7 7V17zm-1.707-2.707l8-8a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1 0 1.414l-8 8A1 1 0 0 1 10.5 19h-3a1 1 0 0 1-1-1v-3a1 1 0 0 1 .293-.707z" fill="currentColor" fill-rule="nonzero"/></svg>',o.STRING],imageEditEditor:[null,o.OBJECT]}}},wi=typeof window<"u"&&typeof window.document<"u";wi&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:pi}));export{un as a,re as b,ee as c,ui as d,Kt as e,Qt as f,wn as g,ie as h,pi as p};
