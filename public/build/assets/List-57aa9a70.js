import{r as s,i as ee,u as ae,N as te,O as le,o as se,j as m,k as i,C as ne,D as E,b as v,l as o,G as N,A as F,E as R,P as oe,Q as re,y as de,x as ie,e as l,H as ue,K as u,z as V,m as T,I as g,c as K,d as ce,t as _,S as ve,ae as pe,ar as me,F as ye,U as fe,W as ge}from"./app-d45ea034.js";import{_ as _e}from"./ApppageHeader-8e0f3b7f.js";import{d as we,e as xe}from"./encrypt-fde381ec.js";import{_ as he}from"./AppSnackBar-b1e4c329.js";import{_ as be}from"./DialogForm-96253f0f.js";import{u as ke}from"./vendors-c76833e7.js";import"./index.esm-a4b6eac8.js";import"./Studio-f4c83174.js";const Ce=l("div",{class:"mt-2 mr-2"},"Show",-1),Ve={class:"v-col-12"},Se={class:"text-right text-capitalize"},De={class:"d-flex align-center justify-end"},je={__name:"List",setup(Ae){const w=s({status:!1,type:"primary",text:null}),n=ee(),M=ae(),S=te(),d=s({loading:!1,data:[]}),D=s(0),I=s(0),y=s(""),L=s([10,20,50,100]),A=s(10),U=()=>{p()},$=()=>{localStorage.setItem("warranty-search",xe(y.value)),p()},G=()=>{y.value="",localStorage.setItem("warranty-search",""),p()},c=s(S.params&&S.params.page?S.params.page:1),H=e=>{w.value={status:!0,type:"success",text:e}},k=s([]),z=s(""),B=s(0),f=e=>{d.value.loading=!0,k.value[0]=e,B.value%2?k.value[1]="DESC":k.value[1]="ASC",B.value++,z.value=JSON.stringify(k.value),p()},p=async()=>{d.value.loading=!0,await E(n.token).get("/api/warranties/all?page="+c.value+"&show="+A.value+"&search="+y.value+"&sort="+z.value).then(e=>{D.value=e.data.last_page?e.data.last_page:e.data.length,c.value=e.data.current_page?e.data.current_page:c.value,I.value=e.data.total?e.data.total:e.data.length,d.value.data=e.data.data?e.data.data:e.data,d.value.loading=!1}).catch(e=>{d.value.loading=!1,console.log(e)})};le(c,(e,a)=>{c.value&&e!=a&&(M.push({name:"PaginatedWarranties",params:{page:c.value}}).catch(r=>{}),p(c.value))});const J=e=>{x.value={},b.value=e},Q=async e=>{b.value=!1,e.profile_id=n.user.profile.id,await E(n.token).post("/api/warranties/store-update/data",e).then(a=>{w.value={status:!0,type:"success",text:a.data.message},p()}).catch(a=>{d.value.loading=!1,console.log(a)})};s([]);const C=ke();C.list.length==0&&(C.getVendors(n.token),console.log("vendorStore.list 11",C.list));const x=s({}),X=s([{name:"warranty_title",label:"Warranty Title",required:!0,type:"text"},{name:"warranty_start_date",label:"Warranty Start Date",required:!0,type:"date"},{name:"warranty_end_date",label:"Warranty Start Date",required:!0,type:"date"},{name:"vendor_id",label:"Vendor",required:!0,type:"select",data:C.list},{name:"amc_start_date",label:"AMC Start Date",required:!1,type:"date"},{name:"amc_end_date",label:"AMC End Date",required:!1,type:"date"}]),Y=e=>{x.value=Object.assign({},e),x.value.type="warranties",b.value=!0},h=s(!1),O=async(e,a)=>{w.value={status:!0,type:"info",text:"Please wait..."},h.value=!0;let r={id:e,status:a,profile_id:n.user.profile.id};await E(n.token).post("/api/warranties/status-change/data",r).then(t=>{setTimeout(()=>{w.value={status:!0,type:"success",text:t.data.message},p(),h.value=!1},600)}).catch(t=>{d.value.loading=!1,console.log(t)})},b=s(!1),Z=()=>{x.value="",b.value=!0};return se(()=>{let e=localStorage.getItem("warranty-search");e&&(y.value=we(e)),p()}),(e,a)=>(v(),m(ne,null,{default:i(()=>[o(_e,{title:"Warranty List"}),o(R,{class:"mb-3"},{default:i(()=>[o(N,{class:"v-col-12 mt-1 col-sm-12 py-0"},{default:i(()=>[o(F,{class:"px-5"},{default:i(()=>[o(R,null,{default:i(()=>[o(N,{class:"v-col-6 v-col-md-2 v-col-sm-6 d-flex my-2"},{default:i(()=>[Ce,o(oe,{items:L.value,modelValue:A.value,"onUpdate:modelValue":[a[0]||(a[0]=r=>A.value=r),U],variant:"outlined",density:"compact","hide-details":"",label:"Entry"},null,8,["items","modelValue"])]),_:1}),o(re),o(N,{class:"v-col-6 v-col-md-3 v-col-sm-6 my-2"},{default:i(()=>[o(de,{modelValue:y.value,"onUpdate:modelValue":a[1]||(a[1]=r=>y.value=r),variant:"outlined",density:"compact",clearable:"",label:"Search",type:"text","hide-details":"","onClick:appendOuter":$,onKeydown:ie($,["enter"]),"onClick:clear":a[2]||(a[2]=r=>G("search"))},null,8,["modelValue","onKeydown"])]),_:1})]),_:1})]),_:1})]),_:1}),l("div",Ve,[o(F,{loading:d.value.loading},{default:i(()=>[o(ue,null,{default:i(()=>{var r;return[l("thead",null,[l("tr",null,[l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[3]||(a[3]=t=>f("warranty_title"))}," Warranty Title "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[4]||(a[4]=t=>f("vendor_id"))}," Vendor "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[5]||(a[5]=t=>f("warranty_start_date"))}," Start Date "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[6]||(a[6]=t=>f("warranty_end_date"))}," End Date "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[7]||(a[7]=t=>f("amc_start_date"))}," AMC Start Date "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[8]||(a[8]=t=>f("amc_end_date"))}," AMC End Date "),l("th",Se,[u(n).user.role=="superadmin"||(r=u(n).capabilities)!=null&&r.includes("add")?(v(),m(V,{key:0,size:"small",color:"primary",onClick:Z},{default:i(()=>[T("Add New")]),_:1})):g("",!0)])])]),l("tbody",null,[(v(!0),K(ye,null,ce(d.value.data,t=>{var P,W,j,q;return v(),K("tr",{key:t.id},[l("td",null,_(t.warranty_title),1),l("td",null,_((P=t.vendor)==null?void 0:P.title),1),l("td",null,_(t.warranty_start_date),1),l("td",null,_(t.warranty_end_date),1),l("td",null,_(t.amc_start_date),1),l("td",null,_(t.amc_end_date),1),l("td",null,[l("div",De,[u(n).user.role=="superadmin"||(W=u(n).capabilities)!=null&&W.includes("edit")?(v(),m(V,{key:0,loading:h.value,onClick:()=>Y(t),icon:u(ve),title:"Edit",density:"compact",class:"mx-2"},null,8,["loading","onClick","icon"])):g("",!0),t.status=="active"&&(u(n).user.role=="superadmin"||(j=u(n).capabilities)!=null&&j.includes("delete"))?(v(),m(V,{key:1,density:"compact",loading:h.value,icon:u(pe),onClick:()=>O(t.id,"disabled"),title:"Disable",class:"mx-2 text-error"},null,8,["loading","icon","onClick"])):g("",!0),t.status=="disabled"&&(u(n).user.role=="superadmin"||(q=u(n).capabilities)!=null&&q.includes("delete"))?(v(),m(V,{key:2,loading:h.value,density:"compact",onClick:()=>O(t.id,"active"),icon:u(me),title:"Enable",class:"mx-2 text-success"},null,8,["loading","onClick","icon"])):g("",!0)])])])}),128))])]}),_:1}),d.value.data.length==0?(v(),m(fe,{key:0,class:"pa-3 text-center w-100"},{default:i(()=>[T("No records found")]),_:1})):g("",!0)]),_:1},8,["loading"]),D.value>1?(v(),m(ge,{key:0,modelValue:c.value,"onUpdate:modelValue":a[9]||(a[9]=r=>c.value=r),class:"my-4",length:D.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:d.value.loading},null,8,["modelValue","length","disabled"])):g("",!0)])]),_:1}),o(be,{"free-form":X.value,"add-new-dialog":b.value,title:"Warranty","data-object":x.value,onCancelled:J,onSave:Q,onFileSave:H},null,8,["free-form","add-new-dialog","data-object"]),o(he,{options:w.value},null,8,["options"])]),_:1}))}};export{je as default};
