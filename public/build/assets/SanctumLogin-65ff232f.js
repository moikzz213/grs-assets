import{u as L,r,a as S,c as B,w as l,o as E,b as c,d as t,t as h,V as N,e as p,f as P,g as T,h as A,i as v,j as w,k as G,l as I}from"./app-512a4a81.js";import{G as K,W as U}from"./WhiteLogo-b3f76fdc.js";import"./_plugin-vue_export-helper-c27b6911.js";const F={class:"mx-auto px-3 text-center",style:{"z-index":"1","max-width":"320px",width:"100%","margin-top":"100px"}},R={class:"text-subtitle-1 text-white"},W={class:"text-error mt-2 text-center"},J={__name:"SanctumLogin",setup(j){const m=L(),x=r("Grandiose Assets"),_=r("grs-asset-wvukt"),f=S();f.authIsLoggedIn==!0&&m.push({path:"/dashboard"});const u=r(!1),s=r({login:"",password:"",url:_.value}),i=r(!1),d=r(""),g=async()=>{u.value=!0,y().then(e=>{if(!e)return;let a="/dashboard",n=e.data.user.username,k=e.data.token;localStorage.removeItem("authUser"),axios.get("/api/fetch/log-profile/"+n+"/"+k).then(o=>{if(!o.data.id){i.value=!0,d.value=o.data,u.value=!1;return}let b=o.data.access.map(C=>C);e.data.access=b,e.data.user.role=o.data.role,e.data.user.profile=o.data,f.setCredentials(e.data).then(()=>{window.location=a})}).catch(o=>{console.log("errrr 1",o)})}).catch(e=>{i.value=!0,d.value=e!=null&&e.message?e.message:e.response.data.message,u.value=!1})},V=()=>{m.push({path:"reset-password"})},y=async()=>{d.value="";let e={username:s.value.login,password:s.value.password,url:s.value.url};const a=await I.post("/api/sanctumlogin",e);return a.data.status==!1?(i.value=!0,d.value=a.data.message,u.value=!1,!1):a};return(e,a)=>(E(),B(K,null,{default:l(()=>[c("div",F,[t(U,{width:"100%"}),c("div",R,h(x.value),1)]),t(G,{class:"mt-8 pa-3 rounded-lg elevation-3",width:"90%","max-width":"450"},{default:l(()=>[t(N,{class:"px-5 pb-0 primary--text"},{default:l(()=>[p("Login")]),_:1}),t(P,{class:"py-4"},{default:l(()=>[t(T,{autocomplete:"off",ref:"form",onKeydown:A(g,["enter"])},{default:l(()=>[t(v,{modelValue:s.value.login,"onUpdate:modelValue":a[0]||(a[0]=n=>s.value.login=n),variant:"outlined",required:"",class:"border-radius",autocomplete:"off",label:"Enter Employee Code"},null,8,["modelValue"]),t(v,{modelValue:s.value.password,"onUpdate:modelValue":a[1]||(a[1]=n=>s.value.password=n),variant:"outlined",required:"",autocomplete:"off",label:"Enter Password",type:"password"},null,8,["modelValue"]),t(w,{onClick:g,width:"100%",color:"primary",height:"55",large:"",loading:u.value},{default:l(()=>[p("Login")]),_:1},8,["loading"]),t(w,{variant:"text",class:"mt-3",block:"",onClick:V},{default:l(()=>[p("Reset Password")]),_:1}),c("div",W,h(i.value==!0?d.value:""),1)]),_:1},8,["onKeydown"])]),_:1})]),_:1})]),_:1}))}};export{J as default};
