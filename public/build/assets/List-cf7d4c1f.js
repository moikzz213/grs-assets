import{d as i,e as Q,u as H,I as W,J as X,K as Y,f as v,w as s,v as Z,x as D,o as p,g as o,A as L,b as l,m as f,aq as I,h as y,q as O,i as aa,z as F,L as ea,B as ta,E as u,a9 as la,C as g,c as M,y as sa,t as B,M as oa,N as na,ao as ia,ap as ua,F as da,P as ca,Q as ra,p as pa,a as va}from"./app-8ce6e96b.js";import{_ as ma}from"./AppPageHeader-38b6237f.js";import{_ as fa}from"./AppSnackBar-bc57ffdf.js";import{_ as ga}from"./_plugin-vue_export-helper-c27b6911.js";const _a=h=>(pa("data-v-a8fa1f7e"),h=h(),va(),h),ya={class:"mb-3"},ha=_a(()=>l("div",{class:"mt-2 mr-2"},"Show",-1)),xa={class:"v-col-12"},ba={class:"text-right text-capitalize"},Ca={class:"d-flex align-center justify-end"},ka={__name:"List",setup(h){const V=i({}),d=Q(),w=i(0),U=i(0),j=i([10,20,50,100]),A=i(10),x=H(),b=W(),J=()=>{m()},r=i(b.params&&b.params.page?b.params.page:1),C=i([]),N=i(""),P=i(0),n=i({loading:!1,data:[]}),k=i(b.params.type),S=e=>{n.value.loading=!0,C.value[0]=e,P.value%2?C.value[1]="DESC":C.value[1]="ASC",P.value++,N.value=JSON.stringify(C.value),m()},$=e=>{n.value.loading=!0,n.value.data=[],k.value=e,x.push({path:"/approval-setup/"+e}),m()},m=async()=>{n.value.loading=!0;let e="";k.value=="transfer-asset"?e="transfer":e="request",await D(d.token).get("/api/approval-setups/all/"+e+"?page="+r.value+"&show="+A.value+"&sort="+N.value).then(a=>{w.value=a.data.last_page?a.data.last_page:a.data.length,r.value=a.data.current_page?a.data.current_page:r.value,U.value=a.data.total?a.data.total:a.data.length,n.value.data=a.data.data?a.data.data:a.data,n.value.loading=!1}).catch(a=>{n.value.loading=!1,console.log(a)})};X(r,(e,a)=>{r.value&&e!=a&&(x.push({name:"PaginatedApprovals",params:{page:r.value}}).catch(c=>{}),m(r.value))});const K=()=>{x.push({name:"NewApproval"}).catch(e=>{console.log(e)})},G=e=>{x.push({name:"EditApproval",params:{id:e}}).catch(a=>{console.log(a)})},_=i(!1),E=async(e,a)=>{V.value={status:!0,type:"info",text:"Please wait..."},_.value=!0;let c={id:e,status:a,profile_id:d.user.profile.id};await D(d.token).post("/api/approval-setups/status-change/data",c).then(t=>{setTimeout(()=>{V.value={status:!0,type:"success",text:t.data.message},m(),_.value=!1},600)}).catch(t=>{n.value.loading=!1,console.log(t)})};return Y(()=>{m()}),(e,a)=>(p(),v(Z,null,{default:s(()=>[o(ma,{title:"Global Approval Setup"}),o(F,{class:"mb-3"},{default:s(()=>[o(L,{class:"v-col-12 mt-1 col-sm-12 py-0"},{default:s(()=>[l("div",ya,[o(f,{class:I(`${k.value=="request-asset"?"tab-active":""}  v-col-12 v-col-md-3 mx-2`),onClick:a[0]||(a[0]=c=>$("request-asset"))},{default:s(()=>[y("Request Asset Approvals")]),_:1},8,["class"]),o(f,{class:I(`${k.value=="transfer-asset"?"tab-active":""}   v-col-12 v-col-md-3 mx-2`),onClick:a[1]||(a[1]=c=>$("transfer-asset"))},{default:s(()=>[y("Transfer Asset Approvals")]),_:1},8,["class"])]),o(O,null,{default:s(()=>[o(aa,null,{default:s(()=>[o(F,{class:"mb-3"},{default:s(()=>[o(L,{class:"v-col-6 v-col-md-2 v-col-sm-12 d-flex mt-2 mb-0 pb-0"},{default:s(()=>[ha,o(ea,{items:j.value,modelValue:A.value,"onUpdate:modelValue":[a[2]||(a[2]=c=>A.value=c),J],variant:"outlined",density:"compact","hide-details":"",label:"Entry"},null,8,["items","modelValue"])]),_:1}),l("div",xa,[o(O,{loading:n.value.loading},{default:s(()=>[o(ta,null,{default:s(()=>{var c;return[l("thead",null,[l("tr",null,[l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[3]||(a[3]=t=>S("title"))}," Title "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[4]||(a[4]=t=>S("profile_id"))}," Updated By "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[5]||(a[5]=t=>S("status"))}," Status "),l("th",ba,[u(d).user.role=="superadmin"||(c=u(d).capabilities)!=null&&c.includes("add")?(p(),v(f,{key:0,size:"small",color:"primary","prepend-icon":u(la),onClick:K},{default:s(()=>[y("Add New Matrix")]),_:1},8,["prepend-icon"])):g("",!0)])])]),l("tbody",null,[(p(!0),M(da,null,sa(n.value.data,t=>{var z,R,T,q;return p(),M("tr",{key:t.id},[l("td",null,B(t.title),1),l("td",null,B((z=t.profile)==null?void 0:z.display_name),1),l("td",null,[o(oa,{class:"text-uppercase",size:"small",color:`${t.status=="active"?"success":"error"}`},{default:s(()=>[y(B(t.status),1)]),_:2},1032,["color"])]),l("td",null,[l("div",Ca,[u(d).user.role=="superadmin"||(R=u(d).capabilities)!=null&&R.includes("edit")?(p(),v(f,{key:0,loading:_.value,onClick:()=>G(t.id),icon:u(na),title:"Edit",density:"compact",class:"mx-2"},null,8,["loading","onClick","icon"])):g("",!0),t.status=="active"&&(u(d).user.role=="superadmin"||(T=u(d).capabilities)!=null&&T.includes("delete"))?(p(),v(f,{key:1,density:"compact",loading:_.value,icon:u(ia),onClick:()=>E(t.id,"disabled"),title:"Disable",class:"mx-2 text-error"},null,8,["loading","icon","onClick"])):g("",!0),t.status=="disabled"&&(u(d).user.role=="superadmin"||(q=u(d).capabilities)!=null&&q.includes("delete"))?(p(),v(f,{key:2,loading:_.value,density:"compact",onClick:()=>E(t.id,"active"),icon:u(ua),title:"Enable",class:"mx-2 text-success"},null,8,["loading","onClick","icon"])):g("",!0)])])])}),128))])]}),_:1}),n.value.data.length==0?(p(),v(ca,{key:0,class:"pa-3 text-center w-100"},{default:s(()=>[y("No records found")]),_:1})):g("",!0)]),_:1},8,["loading"]),w.value>1?(p(),v(ra,{key:0,modelValue:r.value,"onUpdate:modelValue":a[6]||(a[6]=c=>r.value=c),class:"my-4",length:w.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:n.value.loading},null,8,["modelValue","length","disabled"])):g("",!0)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o(fa,{options:V.value},null,8,["options"])]),_:1}))}},Ba=ga(ka,[["__scopeId","data-v-a8fa1f7e"]]);export{Ba as default};
