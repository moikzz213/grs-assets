import{r as s,a as le,u as ae,I as se,J as oe,K as ne,c as k,w as p,m as ie,n as z,o as g,d as o,b as a,k as re,V as ue,i as de,h as ce,s as M,L as q,x as pe,e as x,p as O,q as me,ag as ve,E as v,t as u,M as fe,D as T,N as ge,O as ye,y as N,F as he,P as _e,Q as xe}from"./app-82d8ec59.js";import{_ as Ce}from"./ApppageHeader-1ef844bb.js";import{d as C,e as V}from"./encrypt-c3c952d5.js";import{_ as Ve}from"./AppSnackBar-adae03ec.js";import{u as E}from"./formatDate-b9aad8c5.js";const be={class:"v-col-12"},Se=a("div",{class:"mr-auto"},"Asset Requests",-1),ke={class:"v-col-12 v-col-md"},qe={class:"v-col-12 v-col-md"},we={class:"v-col-12 v-col-md"},$e={class:"v-col-12 v-col-md"},Ie=a("th",{class:"text-left text-capitalize"},"SN No.",-1),De=a("br",null,null,-1),ze=a("small",null,"PENDING",-1),Ne=a("br",null,null,-1),Re=a("small",null,"(DD/MM/YY)",-1),Ae=a("br",null,null,-1),je=a("small",null,"(DD/MM/YY)",-1),Le=a("th",{class:"text-right text-capitalize"},null,-1),Pe={class:"d-flex align-center justify-end"},Ee={__name:"List",setup(Be){const K=s({status:!1,type:"primary",text:null}),d=le(),R=ae(),w=se(),r=s({loading:!1,data:[]}),$=s(0),Y=s(0),f=s(""),J=s([10,20,50,100]),y=s(10),n=s({}),G=()=>{localStorage.setItem("request-filter-row",V(y.value)),m()},I=l=>{D.value="",i.value==1?(l=="company"?localStorage.setItem("request-filter-company",V(n.value.company_id)):l=="location"?localStorage.setItem("request-filter-location",V(n.value.location_id)):l=="status"&&localStorage.setItem("request-filter-status",V(n.value.status)),m()):i.value=1},A=()=>{localStorage.setItem("request-asset-search",V(f.value)),m()},b=l=>{l=="search"?(f.value="",localStorage.setItem("request-asset-search",""),m()):l=="company"?localStorage.setItem("request-filter-company",""):l=="location"?localStorage.setItem("request-filter-location",""):l=="status"&&localStorage.setItem("request-filter-status","")},i=s(w.params&&w.params.page?w.params.page:1),S=s([]),D=s(""),j=s(0),c=l=>{r.value.loading=!0,S.value[0]=l,j.value%2?S.value[1]="DESC":S.value[1]="ASC",j.value++,D.value=JSON.stringify(S.value),m()},L=s([]),Q=async()=>{await z(d.token).get("/api/fetch/companies").then(l=>{L.value=l.data}).catch(l=>{})},P=s([]),H=async()=>{await z(d.token).get("/api/fetch/locations/non-paginated/data").then(l=>{P.value=l.data}).catch(l=>{})},W=s([{id:"pending",title:"Pending"},{id:"awaiting-approval",title:"Awaiting Approval"},{id:"reject",title:"Rejected"},{id:"cancelled",title:"Cancelled"},{id:"complete",title:"Completed"}]),X=l=>l=="reject"?"Rejected":l=="complete"?"Completed":l,m=async()=>{r.value.loading=!0,await z(d.token).get("/api/fetch/request-assets/by-requestor/request?userid="+d.user.profile.id+"&role="+d.user.profile.role+"&page="+i.value+"&show="+y.value+"&search="+f.value+"&sort="+D.value+"&filter="+JSON.stringify(n.value)).then(l=>{$.value=l.data.last_page?l.data.last_page:l.data.length,i.value=l.data.current_page?l.data.current_page:i.value,Y.value=l.data.total?l.data.total:l.data.length,r.value.data=l.data.data?l.data.data:l.data,r.value.loading=!1}).catch(l=>{r.value.loading=!1})};oe(i,(l,e)=>{i.value&&l!=e&&(R.push({name:"PaginatedRequestAsset",params:{page:i.value}}).catch(t=>{}),m(i.value))});const Z=l=>{R.push({name:"EditRequestAsset",params:{id:l}}).catch(e=>{console.log(e)})},ee=l=>{console.log("delete",l)},te=(l,e=6)=>{let t="00000"+l;return t.substring(t.length-e)};return ne(()=>{let l=localStorage.getItem("request-asset-search"),e=localStorage.getItem("request-filter-company"),t=localStorage.getItem("request-filter-location"),h=localStorage.getItem("request-filter-status"),_=localStorage.getItem("request-filter-row");l&&(f.value=C(l)),e&&(n.value.company_id=C(e)),t&&(n.value.location_id=C(t)),h&&(n.value.status=C(h)),_&&(y.value=C(_)),m().then(()=>{Q().then(()=>{H()})})}),(l,e)=>(g(),k(ie,null,{default:p(()=>[o(Ce,{title:"Asset request page"}),o(M,{class:"mb-3"},{default:p(()=>[a("div",be,[o(re,{loading:r.value.loading},{default:p(()=>[o(ue,{class:"d-flex align-center mb-3 pa-3"},{default:p(()=>[Se,o(de,{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=t=>f.value=t),variant:"outlined",density:"compact",clearable:"",label:"Search (ex. SN-5000035 )",type:"text","hide-details":"",style:{"max-width":"300px"},"onClick:appendOuter":A,onKeydown:ce(A,["enter"]),"onClick:clear":e[1]||(e[1]=t=>b("search"))},null,8,["modelValue","onKeydown"])]),_:1}),o(M,{class:"px-3"},{default:p(()=>[a("div",ke,[o(q,{items:L.value,modelValue:n.value.company_id,"onUpdate:modelValue":[e[2]||(e[2]=t=>n.value.company_id=t),e[3]||(e[3]=t=>I("company"))],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Company","onClick:clear":e[4]||(e[4]=t=>b("company"))},null,8,["items","modelValue"])]),a("div",qe,[o(q,{items:P.value,modelValue:n.value.location_id,"onUpdate:modelValue":[e[5]||(e[5]=t=>n.value.location_id=t),e[6]||(e[6]=t=>I("location"))],variant:"outlined",density:"compact","hide-details":"",label:"Location","item-value":"id",clearable:"","item-title":"title","onClick:clear":e[7]||(e[7]=t=>b("location"))},null,8,["items","modelValue"])]),a("div",we,[o(q,{items:W.value,modelValue:n.value.status,"onUpdate:modelValue":[e[8]||(e[8]=t=>n.value.status=t),e[9]||(e[9]=t=>I("status"))],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Status","onClick:clear":e[10]||(e[10]=t=>b("status"))},null,8,["items","modelValue"])]),a("div",$e,[o(q,{items:J.value,modelValue:y.value,"onUpdate:modelValue":[e[11]||(e[11]=t=>y.value=t),G],variant:"outlined",density:"compact","hide-details":"",label:"Show"},null,8,["items","modelValue"])])]),_:1}),o(pe,null,{default:p(()=>[a("thead",null,[a("tr",null,[Ie,a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[12]||(e[12]=t=>c("company_id"))}," Company "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[13]||(e[13]=t=>c("transferred_to"))}," Location "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[14]||(e[14]=t=>c("subject"))}," Subject "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[15]||(e[15]=t=>c("profile_id"))}," Requestor "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[16]||(e[16]=t=>c("reminder_profile_id"))},[x(" Approval"),De,ze]),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[17]||(e[17]=t=>c("status"))}," Status "),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[18]||(e[18]=t=>c("created_at"))},[x(" D.Requested"),Ne,Re]),a("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[19]||(e[19]=t=>c("date_closed"))},[x(" D.Closed"),Ae,je]),Le])]),a("tbody",null,[(g(!0),O(he,null,me(r.value.data,t=>{var h,_,B,U,F;return g(),O("tr",{key:t.id,class:ve(`${v(d).user.profile.id==t.reminder_profile_id?"bg-blue-lighten-5":""} `)},[a("td",null,"SN-5"+u(te(t.id)),1),a("td",null,u((h=t.company)==null?void 0:h.title),1),a("td",null,u((_=t.transfer_to)==null?void 0:_.title),1),a("td",null,u(t.subject),1),a("td",null,u((B=t.profile)==null?void 0:B.display_name),1),a("td",null,u((U=t.reminder_profile)==null?void 0:U.display_name),1),a("td",null,[o(fe,{class:"text-uppercase",size:"small",color:`${t.status.toLowerCase()=="complete"?"success":"error"}`},{default:p(()=>[x(u(X(t.status)),1)]),_:2},1032,["color"])]),a("td",null,u(v(E)(t.created_at)),1),a("td",null,u(t.date_closed&&t.date_closed!="0000-00-00"?v(E)(t.date_closed):""),1),a("td",null,[a("div",Pe,[o(T,{size:"small",onClick:()=>Z(t.id),icon:v(ge),class:"mx-1"},null,8,["onClick","icon"]),v(d).user.role=="superadmin"||(F=v(d).capabilities)!=null&&F.includes("delete")?(g(),k(T,{key:0,size:"small",onClick:()=>ee(t.id),icon:v(ye),class:"mx-1"},null,8,["onClick","icon"])):N("",!0)])])],2)}),128))])]),_:1}),r.value.data.length==0?(g(),k(_e,{key:0,class:"pa-3 text-center w-100"},{default:p(()=>[x("No records found")]),_:1})):N("",!0)]),_:1},8,["loading"]),$.value>1?(g(),k(xe,{key:0,modelValue:i.value,"onUpdate:modelValue":e[20]||(e[20]=t=>i.value=t),class:"my-4",length:$.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:r.value.loading},null,8,["modelValue","length","disabled"])):N("",!0)])]),_:1}),o(Ve,{options:K.value},null,8,["options"])]),_:1}))}};export{Ee as default};
