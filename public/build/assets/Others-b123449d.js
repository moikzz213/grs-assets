import{r as g,O as K,X as ae,b as i,j as r,k as a,l,z as b,a4 as se,m as U,t as ee,a6 as oe,c as C,F as A,d as L,a7 as ie,a8 as ne,J as O,K as t,a9 as ue,aa as de,i as le,V as z,e as c,ab as N,I as y,M as P,q as R,E as x,y as I,A as B,C as ce,D as te,G as q,ac as G,ad as J,P as X,ae as H,af as Q,T as W}from"./app-d45ea034.js";import{_ as re}from"./ApppageHeader-8e0f3b7f.js";import{_ as ve}from"./AppSnackBar-b1e4c329.js";import{u as pe}from"./status-775dfb33.js";const _e={__name:"AppStatusDropDown",props:{loading:{type:Boolean,default:!1},list:{type:Array,default:[]},currentState:{type:Object,default:null}},emits:["update"],setup(E,{emit:f}){const d=E,v=g([]),s=g("");v.value=d.list,K(()=>d.list,p=>{v.value=[...v.value,...p.list]}),s.value=d.currentState.status,K(()=>d.currentState,p=>{s.value=p,console.log("props.currentState",s.value)});const w=g(!1);K(()=>d.loading,p=>{w.value=p});const S=ae(()=>v.value.filter(p=>p.title==s.value)[0]),V=p=>{f("update",{state:S.value.title,model_id:d.currentState.id})};return(p,_)=>(i(),r(de,null,{activator:a(({props:k})=>[l(b,se({loading:w.value,block:"",color:S.value.color},k),{default:a(()=>[U(ee(S.value.title),1)]),_:2},1040,["loading","color"])]),default:a(()=>[l(oe,null,{default:a(()=>[(i(!0),C(A,null,L(v.value,(k,$)=>(i(),r(ie,{key:$,value:$,onClick:()=>V(k)},{default:a(()=>[l(ne,{class:"text-capitalize"},{default:a(()=>[l(O,{icon:t(ue),color:k.color},null,8,["icon","color"]),U(" "+ee(k.title),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1}))}},fe={class:"v-col-12 v-col-md-12"},me={class:"d-flex align-center"},ye=c("div",null,"Urgency List",-1),he={class:"v-col"},ge={class:"v-col"},be={class:"v-col-2 d-flex align-center justify-center"},ke={__name:"Urgencies",setup(E){const f=le(),d=pe();d.urgencies.length<1&&d.getStatuses(f.token);const v=g([]),s=g(!1),w=g([{title:"active",color:"success"},{title:"disabled",color:"error"}]),S=V=>{v.value.push(V.model_id);let p={id:V.model_id,type:"urgency",status:V.state};console.log("appStatusDropDownRes data",p),d.updateStatus(p,f.token).then(_=>{v.value=[],console.log("statusStore.updateStatus",_)}).catch(_=>{v.value=[],console.log("statusStore.updateStatus err: ",_)})};return(V,p)=>(i(),C("div",fe,[l(B,null,{default:a(()=>[l(z,null,{default:a(()=>{var _,k;return[c("div",me,[t(f).user.role=="superadmin"||(_=t(f).capabilities)!=null&&_.includes("add")?(i(),r(b,{key:0,icon:t(N),onClick:p[0]||(p[0]=$=>V.AddNewStatus()),size:"x-small",color:"white",class:"mr-3"},null,8,["icon"])):y("",!0),ye,(t(f).user.role=="superadmin"||(k=t(f).capabilities)!=null&&k.includes("edit"))&&t(d).urgencies.length>0?(i(),r(b,{key:1,loading:s.value,onClick:p[1]||(p[1]=$=>V.savePage("status")),color:"primary",class:"ml-auto"},{default:a(()=>[U("Save")]),_:1},8,["loading"])):y("",!0)])]}),_:1}),l(P),l(R,null,{default:a(()=>[(i(!0),C(A,null,L(t(d).urgencies,(_,k)=>(i(),r(x,{key:_.id},{default:a(()=>[c("div",he,[l(I,{"hide-details":"auto",modelValue:_.title,"onUpdate:modelValue":$=>_.title=$,label:"Urgency Title",variant:"outlined",density:"compact",disabled:_.id<10},null,8,["modelValue","onUpdate:modelValue","disabled"])]),c("div",ge,[l(I,{"hide-details":"auto",modelValue:_.interval,"onUpdate:modelValue":$=>_.interval=$,label:"Notification Interval (in days)",variant:"outlined",density:"compact",disabled:_.id<10},null,8,["modelValue","onUpdate:modelValue","disabled"])]),c("div",be,[l(_e,{onUpdate:S,list:w.value,"current-state":_,loading:v.value.includes(_.id)==!0},null,8,["list","current-state","loading"])])]),_:2},1024))),128))]),_:1})]),_:1})]))}};const Ve={class:"d-flex align-center"},$e=c("div",null,"Status List",-1),we=c("div",{class:"v-col-12 py-0"},[c("small",null,"Default value cannot be edited")],-1),Ce={class:"v-col-5 d-flex"},Se={class:"v-col-5"},xe={key:0,class:"v-col-2 my-auto"},De={class:"d-flex align-center"},Ue=c("div",null,"Condition List",-1),Te={class:"v-col-5 d-flex"},Ae={class:"v-col-5"},Le={class:"v-col-2 my-auto"},Ie={class:"d-flex align-center"},Oe=c("div",null,"Incident Type List",-1),ze=c("div",{class:"v-col-12 py-0"},[c("small",null,"Default value cannot be edited")],-1),Ne={class:"v-col-5 d-flex"},Pe={class:"v-col-5"},Re={key:0,class:"v-col-2 my-auto"},Me={__name:"Others",setup(E){const f=g([]),d=g([]),v=g([]),s=le(),w=g(!1),S=g([{id:"asset",value:"Asset"},{id:"maintenance",value:"Maintenance"},{id:"incident",value:"Incident"}]),V=g([{id:"condition-type",value:"Asset"}]),p=g([{id:"incident-type",value:"Incident"}]),_=()=>{f.value.push({title:null,type:null})},k=()=>{d.value.push({title:null,type:"condition-type"})},$=()=>{v.value.push({title:null,type:"incident-type"})},D=g({loading:!0}),T=g({status:!1,type:"info",text:null}),Y=async()=>{f.value=[],d.value=[],v.value=[],await te(s.token).get("/api/fetch-global/setup-status").then(m=>{m.data.length>0&&m.data.map(n=>{n.type=="condition-type"?d.value.push(n):n.type=="incident-type"?v.value.push(n):f.value.push(n)}),D.value.loading=!1}).catch(m=>{D.value.loading=!1})};Y();const F=async(m,n,e)=>{if(n.id){T.value={status:!0,type:"info",text:"Please wait..."};let o={type:"status",item:n,profile_id:s.user.profile.id};Z(o)}else if(e=="status"){let o=f.value;o.splice(m,1),f.value=[...o]}else if(e=="condition"){let o=d.value;o.splice(m,1),d.value=[...o]}else{let o=v.value;o.splice(m,1),v.value=[...o]}},j=m=>{if(T.value={status:!0,type:"info",text:"Please wait..."},m=="status"){if(f.value.length==0)return;M(f.value)}else if(m=="condition"){if(d.value.length==0)return;M(d.value)}else if(m=="incident"){if(v.value.length==0)return;M(v.value)}},M=m=>{let n=[],e=[];if(m.map((u,h)=>{u.title&&u.type&&(delete u.profile_id,u.profile_id=s.user.profile.id,u.id?(delete u.created_at,delete u.updated_at,n.push(u)):e.push(u))}),e.length==0&&n.length==0){T.value={status:!0,type:"error",text:"Kindly fill-up the fields."};return}let o={type:"store-update",new:e,update:n,profile_id:s.user.profile.id};Z(o)},Z=m=>{te(s.token).post("/api/store-update/setup-status",m).then(n=>{Y().then(()=>{T.value={status:!0,type:"success",text:n.data.message}})}).catch(n=>{D.value.loading=!1})};return(m,n)=>(i(),r(ce,null,{default:a(()=>[l(re,{title:"Others - Status Setup"}),l(x,{class:"mb-3"},{default:a(()=>[l(ke),l(q,{class:"v-col-12 v-col-md-6 mt-1 col-sm-12"},{default:a(()=>[l(B,{loading:D.value.loading},{default:a(()=>[l(z,null,{default:a(()=>{var e,o;return[c("div",Ve,[t(s).user.role=="superadmin"||(e=t(s).capabilities)!=null&&e.includes("add")?(i(),r(b,{key:0,icon:t(N),onClick:n[0]||(n[0]=u=>_()),size:"x-small",color:"white",class:"mr-3"},null,8,["icon"])):y("",!0),$e,(t(s).user.role=="superadmin"||(o=t(s).capabilities)!=null&&o.includes("edit"))&&f.value.length>0?(i(),r(b,{key:1,loading:w.value,onClick:n[1]||(n[1]=u=>j("status")),color:"primary",class:"ml-auto"},{default:a(()=>[U("Save")]),_:1},8,["loading"])):y("",!0)])]}),_:1}),l(P),l(R,null,{default:a(()=>[l(x,{class:"mb-2"},{default:a(()=>[we]),_:1}),(i(!0),C(A,null,L(f.value,(e,o)=>(i(),r(x,{key:o,class:"parent-row-show"},{default:a(()=>{var u;return[c("div",Ce,[e.id?(i(),r(O,{key:0,title:`${e.status=="active"?"Active":"Disabled"}`,icon:`${e.status=="active"?t(G):t(J)}`,color:`${e.status=="active"?"success":"error"}`,class:"my-auto mr-2"},null,8,["title","icon","color"])):y("",!0),l(X,{"hide-details":"auto",label:"Type",variant:"outlined",modelValue:e.type,"onUpdate:modelValue":h=>e.type=h,items:S.value,"item-title":"value","item-value":"id",density:"compact",disabled:e.id<10},null,8,["modelValue","onUpdate:modelValue","items","disabled"])]),c("div",Se,[l(I,{"hide-details":"auto",modelValue:e.title,"onUpdate:modelValue":h=>e.title=h,label:"Status Title",variant:"outlined",density:"compact",disabled:e.id<10},null,8,["modelValue","onUpdate:modelValue","disabled"])]),e.id>9||!e.id?(i(),C("div",xe,[t(s).user.role=="superadmin"||(u=t(s).capabilities)!=null&&u.includes("delete")?(i(),r(b,{key:0,title:`${e.id?e.status=="active"?"Click to disable":"Click to enable":"Remove row"}`,icon:`${e.id?e.status=="active"?t(H):t(Q):t(W)}`,onClick:h=>F(o,e,"status"),size:"x-small",color:`${e&&e.status=="disabled"?"success":"error"}`,class:"mx-1 show-hover"},null,8,["title","icon","onClick","color"])):y("",!0)])):y("",!0)]}),_:2},1024))),128))]),_:1})]),_:1},8,["loading"])]),_:1}),l(q,{class:"v-col-12 v-col-md-6 mt-1 col-sm-12"},{default:a(()=>[l(B,{loading:D.value.loading},{default:a(()=>[l(z,null,{default:a(()=>{var e,o;return[c("div",De,[t(s).user.role=="superadmin"||(e=t(s).capabilities)!=null&&e.includes("add")?(i(),r(b,{key:0,icon:t(N),onClick:n[2]||(n[2]=u=>k()),size:"x-small",color:"white",class:"mr-3"},null,8,["icon"])):y("",!0),Ue,(t(s).user.role=="superadmin"||(o=t(s).capabilities)!=null&&o.includes("edit"))&&d.value.length>0?(i(),r(b,{key:1,loading:w.value,onClick:n[3]||(n[3]=u=>j("condition")),color:"primary",class:"ml-auto"},{default:a(()=>[U("Save")]),_:1},8,["loading"])):y("",!0)])]}),_:1}),l(P),l(R,null,{default:a(()=>[(i(!0),C(A,null,L(d.value,(e,o)=>(i(),r(x,{key:o,class:"parent-row-show"},{default:a(()=>{var u;return[c("div",Te,[e.id?(i(),r(O,{key:0,title:`${e.status=="active"?"Active":"Disabled"}`,icon:`${e.status=="active"?t(G):t(J)}`,color:`${e.status=="active"?"success":"error"}`,class:"my-auto mr-2"},null,8,["title","icon","color"])):y("",!0),l(X,{"hide-details":"auto",label:"Type",variant:"outlined",modelValue:e.type,"onUpdate:modelValue":h=>e.type=h,items:V.value,"item-title":"value","item-value":"id",density:"compact"},null,8,["modelValue","onUpdate:modelValue","items"])]),c("div",Ae,[l(I,{"hide-details":"auto",modelValue:e.title,"onUpdate:modelValue":h=>e.title=h,label:"Condition Title",variant:"outlined",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),c("div",Le,[t(s).user.role=="superadmin"||(u=t(s).capabilities)!=null&&u.includes("delete")?(i(),r(b,{key:0,title:`${e.id?e.status=="active"?"Click to disable":"Click to enable":"Remove row"}`,icon:`${e.id?e.status=="active"?t(H):t(Q):t(W)}`,onClick:h=>F(o,e,"condition"),size:"x-small",color:`${e&&e.status=="disabled"?"success":"error"}`,class:"mx-1 show-hover"},null,8,["title","icon","onClick","color"])):y("",!0)])]}),_:2},1024))),128))]),_:1})]),_:1},8,["loading"])]),_:1}),l(q,{class:"v-col-12 v-col-md-6 mt-1 col-sm-12"},{default:a(()=>[l(B,{loading:D.value.loading},{default:a(()=>[l(z,null,{default:a(()=>{var e,o;return[c("div",Ie,[t(s).user.role=="superadmin"||(e=t(s).capabilities)!=null&&e.includes("add")?(i(),r(b,{key:0,icon:t(N),onClick:n[4]||(n[4]=u=>$()),size:"x-small",color:"white",class:"mr-3"},null,8,["icon"])):y("",!0),Oe,(t(s).user.role=="superadmin"||(o=t(s).capabilities)!=null&&o.includes("edit"))&&v.value.length>0?(i(),r(b,{key:1,loading:w.value,onClick:n[5]||(n[5]=u=>j("incident")),color:"primary",class:"ml-auto"},{default:a(()=>[U("Save")]),_:1},8,["loading"])):y("",!0)])]}),_:1}),l(P),l(R,null,{default:a(()=>[l(x,{class:"mb-2"},{default:a(()=>[ze]),_:1}),(i(!0),C(A,null,L(v.value,(e,o)=>(i(),r(x,{key:o,class:"parent-row-show"},{default:a(()=>{var u;return[c("div",Ne,[e.id?(i(),r(O,{key:0,title:`${e.status=="active"?"Active":"Disabled"}`,icon:`${e.status=="active"?t(G):t(J)}`,color:`${e.status=="active"?"success":"error"}`,class:"my-auto mr-2"},null,8,["title","icon","color"])):y("",!0),l(X,{"hide-details":"auto",label:"Type",variant:"outlined",modelValue:e.type,"onUpdate:modelValue":h=>e.type=h,items:p.value,"item-title":"value","item-value":"id",density:"compact",disabled:e.id<10},null,8,["modelValue","onUpdate:modelValue","items","disabled"])]),c("div",Pe,[l(I,{"hide-details":"auto",modelValue:e.title,"onUpdate:modelValue":h=>e.title=h,label:"Incident Title",variant:"outlined",density:"compact",disabled:e.id<10},null,8,["modelValue","onUpdate:modelValue","disabled"])]),e.id>9||!e.id?(i(),C("div",Re,[t(s).user.role=="superadmin"||(u=t(s).capabilities)!=null&&u.includes("delete")?(i(),r(b,{key:0,title:`${e.id?e.status=="active"?"Click to disable":"Click to enable":"Remove row"}`,icon:`${e.id?e.status=="active"?t(H):t(Q):t(W)}`,onClick:h=>F(o,e,"incident"),size:"x-small",color:`${e&&e.status=="disabled"?"success":"error"}`,class:"mx-1 show-hover"},null,8,["title","icon","onClick","color"])):y("",!0)])):y("",!0)]}),_:2},1024))),128))]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1}),l(ve,{options:T.value},null,8,["options"])]),_:1}))}};export{Me as default};
