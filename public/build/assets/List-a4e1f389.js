import{r as l,a as Z,u as ee,I as ae,J as te,T as le,K as se,c as f,w as o,m as ne,n as W,o as c,d as n,v as D,k as F,s as R,L as oe,a3 as re,i as de,h as ie,b as t,x as ue,E as p,j as A,e as T,y as x,p as K,q as ce,t as g,N as ve,aw as pe,F as me,P as ye,Q as fe}from"./app-31325b10.js";import{_ as ge}from"./ApppageHeader-290e8d63.js";import{d as _e,e as we}from"./encrypt-a327cda8.js";import{_ as xe}from"./AppSnackBar-8f62288a.js";import{_ as he}from"./DialogForm-28277d18.js";import{u as Ve}from"./vendors-61e0cfb2.js";import"./index.esm-e05ef10a.js";import"./Studio-4f9b012b.js";const Ce=t("div",{class:"mt-2 mr-2"},"Show",-1),ke={class:"v-col-12"},be={class:"text-right text-capitalize"},Se={class:"d-flex align-center justify-end"},qe={__name:"List",setup(De){const V=l({status:!1,type:"primary",text:null}),i=Z(),L=ee(),C=ae(),r=l({loading:!1,data:[]}),k=l(0),M=l(0),m=l(""),I=l([10,20,50,100]),b=l(10),U=()=>{v()},E=()=>{localStorage.setItem("warranty-search",we(m.value)),v()},J=()=>{m.value="",localStorage.setItem("warranty-search",""),v()},u=l(C.params&&C.params.page?C.params.page:1),Q=e=>{V.value={status:!0,type:"success",text:e}},h=l([]),N=l(""),$=l(0),y=e=>{r.value.loading=!0,h.value[0]=e,$.value%2?h.value[1]="DESC":h.value[1]="ASC",$.value++,N.value=JSON.stringify(h.value),v()},v=async()=>{r.value.loading=!0,await W(i.token).get("/api/warranties/all?page="+u.value+"&show="+b.value+"&search="+m.value+"&sort="+N.value).then(e=>{k.value=e.data.last_page?e.data.last_page:e.data.length,u.value=e.data.current_page?e.data.current_page:u.value,M.value=e.data.total?e.data.total:e.data.length,r.value.data=e.data.data?e.data.data:e.data,r.value.loading=!1}).catch(e=>{r.value.loading=!1,console.log(e)})};te(u,(e,a)=>{u.value&&e!=a&&(L.push({name:"PaginatedWarranties",params:{page:u.value}}).catch(d=>{}),v(u.value))});const G=e=>{_.value={},w.value=e},H=async e=>{w.value=!1,e.profile_id=i.user.profile.id,await W(i.token).post("/api/warranties/store-update/data",e).then(a=>{V.value={status:!0,type:"success",text:a.data.message},v()}).catch(a=>{r.value.loading=!1,console.log(a)})};l([]);const S=Ve();S.list.length==0&&S.getVendors(i.token);const _=l({}),X=le(()=>[{name:"warranty_title",label:"Warranty Title",required:!0,type:"text"},{name:"warranty_start_date",label:"Warranty Start Date",required:!0,type:"date"},{name:"warranty_end_date",label:"Warranty End Date",required:!0,type:"date"},{name:"vendor_id",label:"Vendor",required:!0,type:"select",data:S.list},{name:"amc_start_date",label:"AMC Start Date",required:!1,type:"date"},{name:"amc_end_date",label:"AMC End Date",required:!1,type:"date"}]),B=l(!1),z=(e,a)=>{B.value=a==="view",_.value=Object.assign({},e),_.value.type="warranties",w.value=!0},P=l(!1),w=l(!1),Y=()=>{_.value="",w.value=!0};return se(()=>{let e=localStorage.getItem("warranty-search");e&&(m.value=_e(e)),v()}),(e,a)=>(c(),f(ne,null,{default:o(()=>[n(ge,{title:"Warranty List"}),n(R,{class:"mb-3"},{default:o(()=>[n(D,{class:"v-col-12 mt-1 col-sm-12 py-0"},{default:o(()=>[n(F,{class:"px-5"},{default:o(()=>[n(R,null,{default:o(()=>[n(D,{class:"v-col-6 v-col-md-2 v-col-sm-6 d-flex my-2"},{default:o(()=>[Ce,n(oe,{items:I.value,modelValue:b.value,"onUpdate:modelValue":[a[0]||(a[0]=d=>b.value=d),U],variant:"outlined",density:"compact","hide-details":"",label:"Entry"},null,8,["items","modelValue"])]),_:1}),n(re),n(D,{class:"v-col-6 v-col-md-3 v-col-sm-6 my-2"},{default:o(()=>[n(de,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=d=>m.value=d),variant:"outlined",density:"compact",clearable:"",label:"Search",type:"text","hide-details":"","onClick:appendOuter":E,onKeydown:ie(E,["enter"]),"onClick:clear":a[2]||(a[2]=d=>J("search"))},null,8,["modelValue","onKeydown"])]),_:1})]),_:1})]),_:1})]),_:1}),t("div",ke,[n(F,{loading:r.value.loading},{default:o(()=>[n(ue,null,{default:o(()=>{var d;return[t("thead",null,[t("tr",null,[t("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[3]||(a[3]=s=>y("warranty_title"))}," Warranty Title "),t("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[4]||(a[4]=s=>y("vendor_id"))}," Vendor "),t("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[5]||(a[5]=s=>y("warranty_start_date"))}," Start Date "),t("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[6]||(a[6]=s=>y("warranty_end_date"))}," End Date "),t("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[7]||(a[7]=s=>y("amc_start_date"))}," AMC Start Date "),t("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[8]||(a[8]=s=>y("amc_end_date"))}," AMC End Date "),t("th",be,[p(i).user.role=="superadmin"||(d=p(i).capabilities)!=null&&d.includes("add")?(c(),f(A,{key:0,size:"small",color:"primary",onClick:Y},{default:o(()=>[T("Add New")]),_:1})):x("",!0)])])]),t("tbody",null,[(c(!0),K(me,null,ce(r.value.data,s=>{var j,q,O;return c(),K("tr",{key:s.id},[t("td",null,g(s.warranty_title),1),t("td",null,g((j=s.vendor)==null?void 0:j.title),1),t("td",null,g(s.warranty_start_date),1),t("td",null,g(s.warranty_end_date),1),t("td",null,g(s.amc_start_date),1),t("td",null,g(s.amc_end_date),1),t("td",null,[t("div",Se,[p(i).user.role=="superadmin"||(q=p(i).capabilities)!=null&&q.includes("edit")?(c(),f(A,{key:0,loading:P.value,onClick:()=>z(s,"edit"),icon:p(ve),title:"Edit",density:"compact",class:"mx-2"},null,8,["loading","onClick","icon"])):x("",!0),(O=p(i).capabilities)!=null&&O.includes("edit")?x("",!0):(c(),f(A,{key:1,loading:P.value,density:"compact",onClick:()=>z(s,"view"),icon:p(pe),title:"View",class:"mx-2 text-success"},null,8,["loading","onClick","icon"]))])])])}),128))])]}),_:1}),r.value.data.length==0?(c(),f(ye,{key:0,class:"pa-3 text-center w-100"},{default:o(()=>[T("No records found")]),_:1})):x("",!0)]),_:1},8,["loading"]),k.value>1?(c(),f(fe,{key:0,modelValue:u.value,"onUpdate:modelValue":a[9]||(a[9]=d=>u.value=d),class:"my-4",length:k.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:r.value.loading},null,8,["modelValue","length","disabled"])):x("",!0)])]),_:1}),n(he,{"free-form":X.value,"add-new-dialog":w.value,title:"Warranty","data-object":_.value,onCancelled:G,onSave:H,"is-view":B.value,onFileSave:Q},null,8,["free-form","add-new-dialog","data-object","is-view"]),n(xe,{options:V.value},null,8,["options"])]),_:1}))}};export{qe as default};
