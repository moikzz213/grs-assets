import{r as o,d as se,u as oe,G as ne,H as re,I as ie,e as $,w as m,q as ue,s as z,o as g,f as n,b as l,m as de,V as ce,k as me,j as fe,x as O,J as b,z as pe,g as k,c as E,v as ve,ad as ge,A as p,t as u,K as ye,C as Y,L as xe,l as he,af as Ce,B as R,F as Se,M as Ve,N as _e}from"./app-188d3cc9.js";import{_ as be}from"./AppPageHeader-5f706d9c.js";import{d as y,e as x}from"./encrypt-36df0bd2.js";import{_ as ke}from"./AppSnackBar-8afa082f.js";import{u as J}from"./formatDate-559e9d83.js";const we={class:"v-col-12"},Ie=l("div",{class:"mr-auto"},"Asset Transfers",-1),$e={class:"v-col-12 v-col-md"},ze={class:"v-col-12 v-col-md"},De={class:"v-col-12 v-col-md"},Ne={class:"v-col-12 v-col-md-2"},Le={class:"v-col-12 v-col-md-2"},Ae=l("th",{class:"text-left text-capitalize"},"SN No.",-1),Te=l("br",null,null,-1),je=l("small",null,"PENDING",-1),Re=l("br",null,null,-1),Be=l("small",null,"(DD/MM/YY)",-1),Pe=l("br",null,null,-1),Fe=l("small",null,"(DD/MM/YY)",-1),Ue=l("th",{class:"text-right text-capitalize last-child-action"},null,-1),Me={class:"last-child-action"},qe={class:"d-flex align-center justify-end"},He={__name:"List",setup(Ke){const D=o({status:!1,type:"primary",text:null}),d=se(),B=oe(),N=ne(),i=o({loading:!1,data:[]}),L=o(0),G=o(0),v=o(""),H=o([10,20,50,100]),h=o(10),s=o({}),Q=()=>{localStorage.setItem("transfer-filter-row",x(h.value)),f()},w=a=>{A.value="",r.value==1?(a=="company"?localStorage.setItem("transfer-filter-company",x(s.value.company_id)):a=="location"?localStorage.setItem("transfer-filter-location",x(s.value.location_id)):a=="from"?localStorage.setItem("transfer-filter-from",x(s.value.from)):a=="status"&&localStorage.setItem("transfer-filter-status",x(s.value.status)),f()):r.value=1},P=()=>{localStorage.setItem("transfer-asset-search",x(v.value)),f()},C=a=>{a=="search"?(v.value="",localStorage.setItem("transfer-asset-search",""),f()):a=="company"?localStorage.setItem("transfer-filter-company",""):a=="location"?localStorage.setItem("transfer-filter-location",""):a=="from"?localStorage.setItem("transfer-filter-from",""):a=="status"&&localStorage.setItem("transfer-filter-status","")},r=o(N.params&&N.params.page?N.params.page:1),I=o([]),A=o(""),F=o(0),c=a=>{i.value.loading=!0,I.value[0]=a,F.value%2?I.value[1]="DESC":I.value[1]="ASC",F.value++,A.value=JSON.stringify(I.value),f()},U=o([]),W=async()=>{await z(d.token).get("/api/fetch/companies").then(a=>{U.value=a.data}).catch(a=>{})},T=o([]),X=async()=>{await z(d.token).get("/api/fetch/locations/non-paginated/data").then(a=>{T.value=a.data}).catch(a=>{})},Z=o([{id:"pending",title:"Pending"},{id:"awaiting-approval",title:"Awaiting Approval"},{id:"reject",title:"Rejected"},{id:"cancelled",title:"Cancelled"},{id:"complete",title:"Completed"}]),ee=a=>a=="reject"?"Rejected":a=="complete"?"Completed":a,f=async()=>{i.value.loading=!0,await z(d.token).get("/api/fetch/request-assets/by-requestor/transfer?userid="+d.user.profile.id+"&role="+d.user.profile.role+"&page="+r.value+"&show="+h.value+"&search="+v.value+"&sort="+A.value+"&filter="+JSON.stringify(s.value)).then(a=>{L.value=a.data.last_page?a.data.last_page:a.data.length,r.value=a.data.current_page?a.data.current_page:r.value,G.value=a.data.total?a.data.total:a.data.length,i.value.data=a.data.data?a.data.data:a.data,i.value.loading=!1}).catch(a=>{i.value.loading=!1,localStorage.setItem("transfer-filter-company",null),localStorage.setItem("transfer-filter-location",null),localStorage.setItem("transfer-filter-from",null),localStorage.setItem("transfer-filter-status",null),localStorage.setItem("transfer-filter-row",10)})};re(r,(a,e)=>{r.value&&a!=e&&(B.push({name:"PaginatedTransferAsset",params:{page:r.value}}).catch(t=>{}),f(r.value))});const te=a=>{B.push({name:"EditTransferAsset",params:{id:a}}).catch(e=>{console.log(e)})},j=o(!1),ae=async a=>{D.value={status:!0,type:"info",text:"Removing data...Please wait."},j.value=!0,await z(d.token).put("/api/remove/asset/"+a).then(e=>{f().then(()=>{j.value=!1,D.value={status:!0,type:"success",text:"Data has been deleted."}})}).catch(e=>{i.value.loading=!1})},le=(a,e=6)=>{let t="00000"+a;return t.substring(t.length-e)};return ie(()=>{let a=localStorage.getItem("transfer-asset-search"),e=localStorage.getItem("transfer-filter-company"),t=localStorage.getItem("transfer-filter-location"),S=localStorage.getItem("transfer-filter-from"),V=localStorage.getItem("transfer-filter-status"),_=localStorage.getItem("transfer-filter-row");a&&(v.value=y(a)),e&&(s.value.company_id=y(e)),t&&(s.value.location_id=y(t)),S&&(s.value.from=y(S)),V&&(s.value.status=y(V)),_&&(h.value=y(_)),f().then(()=>{W().then(()=>{X()})})}),(a,e)=>(g(),$(ue,null,{default:m(()=>[n(be,{title:"Asset Transfer page"}),n(O,{class:"mb-3"},{default:m(()=>[l("div",we,[n(de,{loading:i.value.loading},{default:m(()=>[n(ce,{class:"d-flex align-center mb-3 pa-3"},{default:m(()=>[Ie,n(me,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=t=>v.value=t),variant:"outlined",density:"compact",clearable:"",label:"Search (ex. SN-3000035 )",type:"text","hide-details":"",style:{"max-width":"300px"},"onClick:appendOuter":P,onKeydown:fe(P,["enter"]),"onClick:clear":e[1]||(e[1]=t=>C("search"))},null,8,["modelValue","onKeydown"])]),_:1}),n(O,{class:"px-3"},{default:m(()=>[l("div",$e,[n(b,{items:U.value,modelValue:s.value.company_id,"onUpdate:modelValue":[e[2]||(e[2]=t=>s.value.company_id=t),e[3]||(e[3]=t=>w("company"))],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Company","onClick:clear":e[4]||(e[4]=t=>C("company"))},null,8,["items","modelValue"])]),l("div",ze,[n(b,{items:T.value,modelValue:s.value.from,"onUpdate:modelValue":[e[5]||(e[5]=t=>s.value.from=t),e[6]||(e[6]=t=>w("from"))],variant:"outlined",density:"compact","hide-details":"",label:"Location From","item-value":"id",clearable:"","item-title":"title","onClick:clear":e[7]||(e[7]=t=>C("from"))},null,8,["items","modelValue"])]),l("div",De,[n(b,{items:T.value,modelValue:s.value.location_id,"onUpdate:modelValue":[e[8]||(e[8]=t=>s.value.location_id=t),e[9]||(e[9]=t=>w("location"))],variant:"outlined",density:"compact","hide-details":"",label:"Location To","item-value":"id",clearable:"","item-title":"title","onClick:clear":e[10]||(e[10]=t=>C("location"))},null,8,["items","modelValue"])]),l("div",Ne,[n(b,{items:Z.value,modelValue:s.value.status,"onUpdate:modelValue":[e[11]||(e[11]=t=>s.value.status=t),e[12]||(e[12]=t=>w("status"))],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"","onClick:clear":e[13]||(e[13]=t=>C("status")),label:"Status"},null,8,["items","modelValue"])]),l("div",Le,[n(b,{items:H.value,modelValue:h.value,"onUpdate:modelValue":[e[14]||(e[14]=t=>h.value=t),Q],variant:"outlined",density:"compact","hide-details":"",label:"Show"},null,8,["items","modelValue"])])]),_:1}),n(pe,null,{default:m(()=>[l("thead",null,[l("tr",null,[Ae,l("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[15]||(e[15]=t=>c("company_id"))}," Company "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[16]||(e[16]=t=>c("transferred_from"))}," From "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[17]||(e[17]=t=>c("transferred_to"))}," To "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[18]||(e[18]=t=>c("subject"))}," Subject "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[19]||(e[19]=t=>c("profile_id"))}," Requestor "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[20]||(e[20]=t=>c("reminder_profile_id"))},[k(" Approval"),Te,je]),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[21]||(e[21]=t=>c("status"))}," Status "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[22]||(e[22]=t=>c("created_at"))},[k(" D.Requested"),Re,Be]),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:e[23]||(e[23]=t=>c("date_closed"))},[k(" D.Closed"),Pe,Fe]),Ue])]),l("tbody",null,[(g(!0),E(Se,null,ve(i.value.data,t=>{var S,V,_,M,q,K;return g(),E("tr",{key:t.id,class:ge(`${p(d).user.profile.id==t.reminder_profile_id?"bg-blue-lighten-5":""} `)},[l("td",null,"SN-3"+u(le(t.id)),1),l("td",null,u((S=t.company)==null?void 0:S.title),1),l("td",null,u((V=t.transfer_from)==null?void 0:V.title),1),l("td",null,u((_=t.transfer_to)==null?void 0:_.title),1),l("td",null,u(t.subject),1),l("td",null,u((M=t.profile)==null?void 0:M.display_name),1),l("td",null,u((q=t.reminder_profile)==null?void 0:q.display_name),1),l("td",null,[n(ye,{class:"text-uppercase",size:"small",color:`${t.status.toLowerCase()=="complete"?"success":t.status.toLowerCase()=="pending"||t.status.toLowerCase()=="awaiting-approval"?"warning":"error"}`},{default:m(()=>[k(u(ee(t.status)),1)]),_:2},1032,["color"])]),l("td",null,u(p(J)(t.created_at)),1),l("td",null,u(t.date_closed&&t.date_closed!="0000-00-00"?p(J)(t.date_closed):""),1),l("td",Me,[l("div",qe,[n(Y,{size:"small",onClick:()=>te(t.id),icon:p(xe),class:"mx-1"},null,8,["onClick","icon"]),p(d).user.role=="superadmin"||(K=p(d).capabilities)!=null&&K.includes("delete")?(g(),$(he,{key:0,size:"small",loading:j.value,text:"",variant:"text",onClick:()=>ae(t.id)},{default:m(()=>[n(Y,{icon:p(Ce),class:"mx-1"},null,8,["icon"])]),_:2},1032,["loading","onClick"])):R("",!0)])])],2)}),128))])]),_:1}),i.value.data.length==0?(g(),$(Ve,{key:0,class:"pa-3 text-center w-100"},{default:m(()=>[k("No records found")]),_:1})):R("",!0)]),_:1},8,["loading"]),L.value>1?(g(),$(_e,{key:0,modelValue:r.value,"onUpdate:modelValue":e[24]||(e[24]=t=>r.value=t),class:"my-4",length:L.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:i.value.loading},null,8,["modelValue","length","disabled"])):R("",!0)])]),_:1}),n(ke,{options:D.value},null,8,["options"])]),_:1}))}};export{He as default};
