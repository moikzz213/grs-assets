import{r as s,a as Y,u as Z,G as ee,H as ae,I as te,c as m,w as u,m as le,n as L,o as p,d as o,v as $,k as q,s as F,J as se,$ as oe,i as ne,h as ie,b as l,x as ue,C as c,j as V,e as B,y as g,p as K,q as de,t as C,K as ce,L as re,aq as pe,ar as ve,F as me,N as fe,O as ge}from"./app-10e00396.js";import{_ as ye}from"./ApppageHeader-a45eee26.js";import{d as xe,e as he}from"./encrypt-cce2fbeb.js";import{_ as ke}from"./AppSnackBar-926749b3.js";import{_ as Ce}from"./DialogForm-9ae3934f.js";import"./index.esm-6b67f3cb.js";import"./Studio-90733613.js";const be=l("div",{class:"mt-2 mr-2"},"Show",-1),_e={class:"v-col-12"},Ve={class:"text-right text-capitalize"},we={class:"d-flex align-center justify-end"},Ae={__name:"List",setup(Se){const b=s({status:!1,type:"primary",text:null}),n=Y(),I=Z(),w=ee(),d=s({loading:!1,data:[]}),S=s(0),T=s(0),f=s(""),U=s([10,20,50,100]),D=s(10),J=()=>{v()},N=()=>{localStorage.setItem("location-search",he(f.value)),v()},G=()=>{f.value="",localStorage.setItem("location-search",""),v()},r=s(w.params&&w.params.page?w.params.page:1),_=s([]),O=s(""),z=s(0),y=e=>{d.value.loading=!0,_.value[0]=e,z.value%2?_.value[1]="DESC":_.value[1]="ASC",z.value++,O.value=JSON.stringify(_.value),v()},v=async()=>{d.value.loading=!0,await L(n.token).get("/api/locations/all?page="+r.value+"&show="+D.value+"&search="+f.value+"&sort="+O.value).then(e=>{S.value=e.data.last_page?e.data.last_page:e.data.length,r.value=e.data.current_page?e.data.current_page:r.value,T.value=e.data.total?e.data.total:e.data.length,d.value.data=e.data.data?e.data.data:e.data,d.value.loading=!1}).catch(e=>{d.value.loading=!1,console.log(e)})};ae(r,(e,a)=>{r.value&&e!=a&&(I.push({name:"PaginatedLocations",params:{page:r.value}}).catch(i=>{}),v(r.value))});const H=e=>{x.value={},k.value=e},M=async e=>{k.value=!1,e.profile_id=n.user.profile.id,await L(n.token).post("/api/locations/store-update/data",e).then(a=>{b.value={status:!0,type:"success",text:a.data.message},v()}).catch(a=>{d.value.loading=!1,console.log(a)})},x=s({}),Q=s([{name:"title",label:"Location",required:!0,type:"text"},{name:"code",label:"Code",required:!0,type:"text"},{name:"area",label:"Area Location",required:!1,type:"text"}]),W=e=>{x.value=Object.assign({},e),x.value.type="location",k.value=!0},h=s(!1),A=async(e,a)=>{b.value={status:!0,type:"info",text:"Please wait..."},h.value=!0;let i={id:e,status:a,profile_id:n.user.profile.id};await L(n.token).post("/api/locations/status-change/data",i).then(t=>{setTimeout(()=>{b.value={status:!0,type:"success",text:t.data.message},v(),h.value=!1},600)}).catch(t=>{d.value.loading=!1,console.log(t)})},k=s(!1),X=()=>{x.value="",k.value=!0};return te(()=>{let e=localStorage.getItem("location-search");e&&(f.value=xe(e)),v()}),(e,a)=>(p(),m(le,null,{default:u(()=>[o(ye,{title:"Location List"}),o(F,{class:"mb-3"},{default:u(()=>[o($,{class:"v-col-12 mt-1 col-sm-12 py-0"},{default:u(()=>[o(q,{class:"px-5"},{default:u(()=>[o(F,null,{default:u(()=>[o($,{class:"v-col-6 v-col-md-2 v-col-sm-6 d-flex my-2"},{default:u(()=>[be,o(se,{items:U.value,modelValue:D.value,"onUpdate:modelValue":[a[0]||(a[0]=i=>D.value=i),J],variant:"outlined",density:"compact","hide-details":"",label:"Entry"},null,8,["items","modelValue"])]),_:1}),o(oe),o($,{class:"v-col-6 v-col-md-3 v-col-sm-6 my-2"},{default:u(()=>[o(ne,{modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=i=>f.value=i),variant:"outlined",density:"compact",clearable:"",label:"Search",type:"text","hide-details":"","onClick:appendOuter":N,onKeydown:ie(N,["enter"]),"onClick:clear":a[2]||(a[2]=i=>G("search"))},null,8,["modelValue","onKeydown"])]),_:1})]),_:1})]),_:1})]),_:1}),l("div",_e,[o(q,{loading:d.value.loading},{default:u(()=>[o(ue,null,{default:u(()=>{var i;return[l("thead",null,[l("tr",null,[l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[3]||(a[3]=t=>y("title"))}," Location "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[4]||(a[4]=t=>y("code"))}," Code "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[5]||(a[5]=t=>y("area"))}," Area "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[6]||(a[6]=t=>y("profile_id"))}," Updated By "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[7]||(a[7]=t=>y("status"))}," Status "),l("th",Ve,[c(n).user.role=="superadmin"||(i=c(n).capabilities)!=null&&i.includes("add")?(p(),m(V,{key:0,size:"small",color:"primary",onClick:X},{default:u(()=>[B("Add New")]),_:1})):g("",!0)])])]),l("tbody",null,[(p(!0),K(me,null,de(d.value.data,t=>{var P,j,E,R;return p(),K("tr",{key:t.id},[l("td",null,C(t.title),1),l("td",null,C(t.code),1),l("td",null,C(t.area),1),l("td",null,C((P=t.profile)==null?void 0:P.display_name),1),l("td",null,[o(ce,{class:"text-uppercase",size:"small",color:`${t.status=="active"?"success":"error"}`},{default:u(()=>[B(C(t.status),1)]),_:2},1032,["color"])]),l("td",null,[l("div",we,[c(n).user.role=="superadmin"||(j=c(n).capabilities)!=null&&j.includes("edit")?(p(),m(V,{key:0,loading:h.value,onClick:()=>W(t),icon:c(re),title:"Edit",density:"compact",class:"mx-2"},null,8,["loading","onClick","icon"])):g("",!0),t.status=="active"&&(c(n).user.role=="superadmin"||(E=c(n).capabilities)!=null&&E.includes("delete"))?(p(),m(V,{key:1,density:"compact",loading:h.value,icon:c(pe),onClick:()=>A(t.id,"disabled"),title:"Disable",class:"mx-2 text-error"},null,8,["loading","icon","onClick"])):g("",!0),t.status=="disabled"&&(c(n).user.role=="superadmin"||(R=c(n).capabilities)!=null&&R.includes("delete"))?(p(),m(V,{key:2,loading:h.value,density:"compact",onClick:()=>A(t.id,"active"),icon:c(ve),title:"Enable",class:"mx-2 text-success"},null,8,["loading","onClick","icon"])):g("",!0)])])])}),128))])]}),_:1}),d.value.data.length==0?(p(),m(fe,{key:0,class:"pa-3 text-center w-100"},{default:u(()=>[B("No records found")]),_:1})):g("",!0)]),_:1},8,["loading"]),S.value>1?(p(),m(ge,{key:0,modelValue:r.value,"onUpdate:modelValue":a[8]||(a[8]=i=>r.value=i),class:"my-4",length:S.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:d.value.loading},null,8,["modelValue","length","disabled"])):g("",!0)])]),_:1}),o(Ce,{"free-form":Q.value,"add-new-dialog":k.value,title:"Location","data-object":x.value,onCancelled:H,onSave:M},null,8,["free-form","add-new-dialog","data-object"]),o(ke,{options:b.value},null,8,["options"])]),_:1}))}};export{Ae as default};
