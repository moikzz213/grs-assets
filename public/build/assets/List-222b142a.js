import{d as s,e as Z,u as ee,I as te,J as ae,K as le,f as y,w as d,v as se,x as S,o as f,g as o,b as l,q as oe,V as ne,l as ie,k as de,z as P,L as _,B as re,h as x,c as U,y as ue,t as r,M as ce,E as g,D as F,N as pe,O as ve,C as D,F as me,P as fe,Q as ge}from"./app-8ce6e96b.js";import{_ as he}from"./AppPageHeader-38b6237f.js";import{d as ye,e as _e}from"./encrypt-4dfa62cc.js";import{_ as xe}from"./AppSnackBar-bc57ffdf.js";import{u as I}from"./formatDate-b9aad8c5.js";const Ve={class:"v-col-12"},Ce=l("div",{class:"mr-auto"},"Asset Transfers",-1),be={class:"v-col-12 v-col-md"},ke={class:"v-col-12 v-col-md"},we={class:"v-col-12 v-col-md"},Se={class:"v-col-12 v-col-md"},De=l("th",{class:"text-left text-capitalize"},"SN No.",-1),ze=l("br",null,null,-1),Ne=l("small",null,"(DD/MM/YY)",-1),$e=l("br",null,null,-1),je=l("small",null,"(DD/MM/YY)",-1),Ae=l("th",{class:"text-right text-capitalize"},null,-1),Le={class:"d-flex align-center justify-end"},Ie={__name:"List",setup(Re){const M=s({status:!1,type:"primary",text:null}),u=Z(),z=ee(),V=te(),i=s({loading:!1,data:[]}),C=s(0),O=s(0),m=s(""),q=s([10,20,50,100]),b=s(10),c=s({}),K=()=>{v()},k=()=>{w.value="",n.value==1?v():n.value=1},N=()=>{localStorage.setItem("transfer-asset-search",_e(m.value)),v()},E=()=>{m.value="",localStorage.setItem("transfer-asset-search",""),v()},n=s(V.params&&V.params.page?V.params.page:1),h=s([]),w=s(""),$=s(0),p=t=>{i.value.loading=!0,h.value[0]=t,$.value%2?h.value[1]="DESC":h.value[1]="ASC",$.value++,w.value=JSON.stringify(h.value),v()},j=s([]),Y=async()=>{await S(u.token).get("/api/fetch/companies").then(t=>{j.value=t.data}).catch(t=>{})},A=s([]),J=async()=>{await S(u.token).get("/api/fetch/locations/non-paginated/data").then(t=>{A.value=t.data}).catch(t=>{})},Q=s([{id:"pending",title:"Pending"},{id:"awaiting-approval",title:"Awaiting Approval"},{id:"reject",title:"Rejected"},{id:"cancelled",title:"Cancelled"},{id:"complete",title:"Completed"}]),G=t=>t=="reject"?"Rejected":t=="complete"?"Completed":t,v=async()=>{i.value.loading=!0,await S(u.token).get("/api/fetch/request-assets/by-requestor/transfer?userid="+u.user.profile.id+"&role="+u.user.profile.role+"&page="+n.value+"&show="+b.value+"&search="+m.value+"&sort="+w.value+"&filter="+JSON.stringify(c.value)).then(t=>{C.value=t.data.last_page?t.data.last_page:t.data.length,n.value=t.data.current_page?t.data.current_page:n.value,O.value=t.data.total?t.data.total:t.data.length,i.value.data=t.data.data?t.data.data:t.data,i.value.loading=!1}).catch(t=>{i.value.loading=!1,console.log(t)})};ae(n,(t,a)=>{n.value&&t!=a&&(z.push({name:"PaginatedTransferAsset",params:{page:n.value}}).catch(e=>{}),v(n.value))});const H=t=>{z.push({name:"EditTransferAsset",params:{id:t}}).catch(a=>{console.log(a)})},W=t=>{console.log("delete",t)},X=(t,a=6)=>{let e="00000"+t;return e.substring(e.length-a)};return le(()=>{let t=localStorage.getItem("transfer-asset-search");t&&(m.value=ye(t)),v().then(()=>{Y().then(()=>{J()})})}),(t,a)=>(f(),y(se,null,{default:d(()=>[o(he,{title:"Asset Transfer page"}),o(P,{class:"mb-3"},{default:d(()=>[l("div",Ve,[o(oe,{loading:i.value.loading},{default:d(()=>[o(ne,{class:"d-flex align-center mb-3 pa-3"},{default:d(()=>[Ce,o(ie,{modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=e=>m.value=e),variant:"outlined",density:"compact",clearable:"",label:"Search (ex. SN-3000035 )",type:"text","hide-details":"",style:{"max-width":"300px"},"onClick:appendOuter":N,onKeydown:de(N,["enter"]),"onClick:clear":a[1]||(a[1]=e=>E("search"))},null,8,["modelValue","onKeydown"])]),_:1}),o(P,{class:"px-3"},{default:d(()=>[l("div",be,[o(_,{items:j.value,modelValue:c.value.company_id,"onUpdate:modelValue":[a[2]||(a[2]=e=>c.value.company_id=e),k],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Company"},null,8,["items","modelValue"])]),l("div",ke,[o(_,{items:A.value,modelValue:c.value.location_id,"onUpdate:modelValue":[a[3]||(a[3]=e=>c.value.location_id=e),k],variant:"outlined",density:"compact","hide-details":"",label:"Location","item-value":"id",clearable:"","item-title":"title"},null,8,["items","modelValue"])]),l("div",we,[o(_,{items:Q.value,modelValue:c.value.status,"onUpdate:modelValue":[a[4]||(a[4]=e=>c.value.status=e),k],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Status"},null,8,["items","modelValue"])]),l("div",Se,[o(_,{items:q.value,modelValue:b.value,"onUpdate:modelValue":[a[5]||(a[5]=e=>b.value=e),K],variant:"outlined",density:"compact","hide-details":"",label:"Show"},null,8,["items","modelValue"])])]),_:1}),o(re,null,{default:d(()=>[l("thead",null,[l("tr",null,[De,l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[6]||(a[6]=e=>p("company_id"))}," Company "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[7]||(a[7]=e=>p("transferred_to"))}," Location "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[8]||(a[8]=e=>p("subject"))}," Subject "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[9]||(a[9]=e=>p("profile_id"))}," Requestor "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[10]||(a[10]=e=>p("status"))}," Status "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[11]||(a[11]=e=>p("created_at"))},[x(" D.Requested"),ze,Ne]),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[12]||(a[12]=e=>p("date_closed"))},[x(" D.Closed"),$e,je]),Ae])]),l("tbody",null,[(f(!0),U(me,null,ue(i.value.data,e=>{var L,R,T,B;return f(),U("tr",{key:e.id},[l("td",null,"SN-3"+r(X(e.id)),1),l("td",null,r((L=e.company)==null?void 0:L.title),1),l("td",null,r((R=e.transfer_to)==null?void 0:R.title),1),l("td",null,r(e.subject),1),l("td",null,r((T=e.profile)==null?void 0:T.display_name),1),l("td",null,[o(ce,{class:"text-uppercase",size:"small",color:`${e.status.toLowerCase()=="complete"?"success":"error"}`},{default:d(()=>[x(r(G(e.status)),1)]),_:2},1032,["color"])]),l("td",null,r(g(I)(e.created_at)),1),l("td",null,r(e.date_closed&&e.date_closed!="0000-00-00"?g(I)(e.date_closed):""),1),l("td",null,[l("div",Le,[o(F,{size:"small",onClick:()=>H(e.id),icon:g(pe),class:"mx-1"},null,8,["onClick","icon"]),g(u).user.role=="superadmin"||(B=g(u).capabilities)!=null&&B.includes("delete")?(f(),y(F,{key:0,size:"small",onClick:()=>W(e.id),icon:g(ve),class:"mx-1"},null,8,["onClick","icon"])):D("",!0)])])])}),128))])]),_:1}),i.value.data.length==0?(f(),y(fe,{key:0,class:"pa-3 text-center w-100"},{default:d(()=>[x("No records found")]),_:1})):D("",!0)]),_:1},8,["loading"]),C.value>1?(f(),y(ge,{key:0,modelValue:n.value,"onUpdate:modelValue":a[13]||(a[13]=e=>n.value=e),class:"my-4",length:C.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:i.value.loading},null,8,["modelValue","length","disabled"])):D("",!0)])]),_:1}),o(xe,{options:M.value},null,8,["options"])]),_:1}))}};export{Ie as default};
