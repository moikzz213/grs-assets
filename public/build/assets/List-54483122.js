import{r as o,i as ae,u as le,L as se,M as oe,o as ne,j as _,k as n,C as ie,K as R,b as f,l as s,N as q,z as ue,m as y,A as z,q as de,D,f as l,O as x,P as re,y as ce,x as pe,Q as me,c as T,d as ve,F as fe,R as ge,I as N,S as ye,t as d,T as he,G as g,E as I,U as _e,W as xe}from"./app-2d02e8bb.js";import{_ as Ve}from"./AppPageHeader-352d3f5b.js";import{d as Ce,e as be}from"./encrypt-610e48c0.js";import{_ as ke}from"./AppSnackBar-9a57ef75.js";import{u as M}from"./formatDate-e2fbee14.js";const Se=l("div",{class:"my-auto"},"Filter",-1),we={class:"v-col-md-2 py-1"},Re={class:"v-col-md-2 py-1"},qe={class:"v-col-md-2 py-1"},ze=l("div",{class:"mt-2 mr-2"},"Show",-1),De={class:"v-col-12"},Ne=l("th",{class:"text-left text-capitalize"},"SN No.",-1),je=l("br",null,null,-1),Ae=l("small",null,"(DD/MM/YY)",-1),$e=l("br",null,null,-1),Le=l("small",null,"(DD/MM/YY)",-1),Be=l("th",{class:"text-right text-capitalize"},null,-1),Pe={class:"d-flex align-center justify-end"},Ee={__name:"List",setup(Ue){const O=o({status:!1,type:"primary",text:null}),r=ae(),V=le(),C=se(),u=o({loading:!1,data:[]}),b=o(0),E=o(0),v=o(""),K=o([10,20,50,100]),k=o(10),c=o({}),Y=()=>{m()},S=()=>{w.value="",i.value==1?m():i.value=1},j=()=>{localStorage.setItem("request-asset-search",be(v.value)),m()},J=()=>{v.value="",localStorage.setItem("request-asset-search",""),m()},i=o(C.params&&C.params.page?C.params.page:1),h=o([]),w=o(""),A=o(0),p=e=>{u.value.loading=!0,h.value[0]=e,A.value%2?h.value[1]="DESC":h.value[1]="ASC",A.value++,w.value=JSON.stringify(h.value),m()},$=o([]),G=async()=>{await R(r.token).get("/api/fetch/companies").then(e=>{$.value=e.data}).catch(e=>{})},L=o([]),Q=async()=>{await R(r.token).get("/api/fetch/locations/non-paginated/data").then(e=>{L.value=e.data}).catch(e=>{})},W=o([{id:"pending",title:"Pending"},{id:"awaiting-approval",title:"Awaiting Approval"},{id:"reject",title:"Rejected"},{id:"cancelled",title:"Cancelled"},{id:"complete",title:"Completed"}]),H=e=>e=="reject"?"Rejected":e=="complete"?"Completed":e,m=async()=>{u.value.loading=!0,await R(r.token).get("/api/fetch/request-assets/by-requestor/request?userid="+r.user.profile.id+"&role="+r.user.profile.role+"&page="+i.value+"&show="+k.value+"&search="+v.value+"&sort="+w.value+"&filter="+JSON.stringify(c.value)).then(e=>{console.log("dataobj.value",u.value),b.value=e.data.last_page?e.data.last_page:e.data.length,i.value=e.data.current_page?e.data.current_page:i.value,E.value=e.data.total?e.data.total:e.data.length,u.value.data=e.data.data?e.data.data:e.data,u.value.loading=!1}).catch(e=>{u.value.loading=!1,console.log(e)})};oe(i,(e,a)=>{i.value&&e!=a&&(V.push({name:"PaginatedRequestAsset",params:{page:i.value}}).catch(t=>{}),m(i.value))});const X=e=>{V.push({name:"EditRequestAsset",params:{id:e}}).catch(a=>{console.log(a)})},Z=e=>{console.log("delete",e)},ee=()=>{V.push({name:"NewRequestAsset"}).catch(e=>{console.log(e)})},te=(e,a=6)=>{let t="00000"+e;return t.substring(t.length-a)};return ne(()=>{let e=localStorage.getItem("request-asset-search");e&&(v.value=Ce(e)),m().then(()=>{G().then(()=>{Q()})})}),(e,a)=>(f(),_(ie,null,{default:n(()=>[s(Ve,{title:"Asset request page"}),s(D,{class:"mb-3"},{default:n(()=>[s(q,{class:"v-col-12 mt-1 col-sm-12 py-0"},{default:n(()=>[s(ue,{size:"small",color:"primary",onClick:ee},{default:n(()=>[y("Request new asset")]),_:1}),s(z,{class:"px-5 mb-1"},{default:n(()=>[s(de,null,{default:n(()=>[s(D,null,{default:n(()=>[Se,l("div",we,[s(x,{items:$.value,modelValue:c.value.company_id,"onUpdate:modelValue":[a[0]||(a[0]=t=>c.value.company_id=t),S],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Company"},null,8,["items","modelValue"])]),l("div",Re,[s(x,{items:L.value,modelValue:c.value.location_id,"onUpdate:modelValue":[a[1]||(a[1]=t=>c.value.location_id=t),S],variant:"outlined",density:"compact","hide-details":"",label:"Location","item-value":"id",clearable:"","item-title":"title"},null,8,["items","modelValue"])]),l("div",qe,[s(x,{items:W.value,modelValue:c.value.status,"onUpdate:modelValue":[a[2]||(a[2]=t=>c.value.status=t),S],variant:"outlined",density:"compact","hide-details":"","item-value":"id","item-title":"title",clearable:"",label:"Status"},null,8,["items","modelValue"])])]),_:1})]),_:1})]),_:1}),s(z,{class:"px-5"},{default:n(()=>[s(D,null,{default:n(()=>[s(q,{class:"v-col-6 v-col-md-2 v-col-sm-6 d-flex my-2"},{default:n(()=>[ze,s(x,{items:K.value,modelValue:k.value,"onUpdate:modelValue":[a[3]||(a[3]=t=>k.value=t),Y],variant:"outlined",density:"compact","hide-details":"",label:"Entry"},null,8,["items","modelValue"])]),_:1}),s(re),s(q,{class:"v-col-6 v-col-md-3 v-col-sm-6 my-2"},{default:n(()=>[s(ce,{modelValue:v.value,"onUpdate:modelValue":a[4]||(a[4]=t=>v.value=t),variant:"outlined",density:"compact",clearable:"",label:"Search (ex. SN-5000035 )",type:"text","hide-details":"","onClick:appendOuter":j,onKeydown:pe(j,["enter"]),"onClick:clear":a[5]||(a[5]=t=>J("search"))},null,8,["modelValue","onKeydown"])]),_:1})]),_:1})]),_:1})]),_:1}),l("div",De,[s(z,{loading:u.value.loading},{default:n(()=>[s(me,null,{default:n(()=>[l("thead",null,[l("tr",null,[Ne,l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[6]||(a[6]=t=>p("company_id"))}," Company "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[7]||(a[7]=t=>p("transferred_to"))}," Location "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[8]||(a[8]=t=>p("subject"))}," Subject "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[9]||(a[9]=t=>p("profile_id"))}," Requestor "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[10]||(a[10]=t=>p("status"))}," Status "),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[11]||(a[11]=t=>p("created_at"))},[y(" D.Requested"),je,Ae]),l("th",{class:"text-left text-capitalize cursor-pointer",onClick:a[12]||(a[12]=t=>p("date_closed"))},[y(" D.Closed"),$e,Le]),Be])]),l("tbody",null,[(f(!0),T(fe,null,ve(u.value.data,t=>{var B,P,U,F;return f(),T("tr",{key:t.id},[l("td",null,"SN-5"+d(te(t.id)),1),l("td",null,d((B=t.company)==null?void 0:B.title),1),l("td",null,d((P=t.transfer_to)==null?void 0:P.title),1),l("td",null,d(t.subject),1),l("td",null,d((U=t.profile)==null?void 0:U.display_name),1),l("td",null,[s(he,{class:"text-uppercase",size:"small",color:`${t.status.toLowerCase()=="complete"?"success":"error"}`},{default:n(()=>[y(d(H(t.status)),1)]),_:2},1032,["color"])]),l("td",null,d(g(M)(t.created_at)),1),l("td",null,d(t.date_closed&&t.date_closed!="0000-00-00"?g(M)(t.date_closed):""),1),l("td",null,[l("div",Pe,[s(I,{size:"small",onClick:()=>X(t.id),icon:g(_e),class:"mx-1"},null,8,["onClick","icon"]),g(r).user.role=="superadmin"||(F=g(r).capabilities)!=null&&F.includes("delete")?(f(),_(I,{key:0,size:"small",onClick:()=>Z(t.id),icon:g(xe),class:"mx-1"},null,8,["onClick","icon"])):N("",!0)])])])}),128))])]),_:1}),u.value.data.length==0?(f(),_(ge,{key:0,class:"pa-3 text-center w-100"},{default:n(()=>[y("No records found")]),_:1})):N("",!0)]),_:1},8,["loading"]),b.value>1?(f(),_(ye,{key:0,modelValue:i.value,"onUpdate:modelValue":a[13]||(a[13]=t=>i.value=t),class:"my-4",length:b.value,"total-visible":8,variant:"elevated","active-color":"primary",density:"comfortable",disabled:u.value.loading},null,8,["modelValue","length","disabled"])):N("",!0)])]),_:1}),s(ke,{options:O.value},null,8,["options"])]),_:1}))}};export{Ee as default};
