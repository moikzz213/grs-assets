import{r as c,H as D,O as A,o as n,c as _,w as o,d as a,j as b,X as R,e as C,t as $,$ as q,p as g,F as O,q as P,a0 as H,a1 as X,C as G,y as h,a2 as J,a3 as K,a4 as Q,a as W,V as Y,b as k,a5 as Z,z as L,E as ee,f as te,s as N,i as U,k as ae,a6 as le,a7 as se,a8 as oe,m as ue}from"./app-db273801.js";import{_ as ne}from"./AppPageHeader-e315ed03.js";import{_ as ie}from"./AppSnackBar-9295a16e.js";import{u as re}from"./status-bce0230f.js";const ce={__name:"AppStatusDropDown",props:{loading:{type:Boolean,default:!1},list:{type:Array,default:[]},currentState:{type:Object,default:null}},emits:["update"],setup(w,{emit:l}){const r=w,s=c([]),d=c("");s.value=r.list,D(()=>r.list,e=>{s.value=[...s.value,...e.list]}),d.value=r.currentState.status,D(()=>r.currentState,e=>{d.value=e.status});const y=c(!1);D(()=>r.loading,e=>{y.value=e});const v=A(()=>s.value.filter(e=>e.title==d.value)[0]),f=e=>{d.value!=e.title&&(d.value=e.title,l("update",{state:v.value.title,model_id:r.currentState.id}))};return(e,i)=>(n(),_(K,null,{activator:o(({props:m})=>[a(b,R({loading:y.value,block:"",color:v.value.color},m),{default:o(()=>[C($(v.value.title),1)]),_:2},1040,["loading","color"])]),default:o(()=>[a(q,null,{default:o(()=>[(n(!0),g(O,null,P(s.value,(m,T)=>(n(),_(H,{key:T,value:T,onClick:()=>f(m)},{default:o(()=>[a(X,{class:"text-capitalize"},{default:o(()=>[a(G,{icon:h(J),color:m.color},null,8,["icon","color"]),C(" "+$(m.title),1)]),_:2},1024)]),_:2},1032,["value","onClick"]))),128))]),_:1})]),_:1}))}},de={class:"v-col-12 v-col-md-8"},pe={class:"d-flex align-center"},ve={class:"text-capitalize"},ye={class:"v-col"},_e={class:"v-col"},fe={key:0,class:"v-col"},me={class:"v-col px-3 d-flex align-center justify-center",style:{width:"100%","max-width":"150px","min-width":"150px"}},he={key:0,style:{position:"absolute",top:"25%",left:"25%"}},Se={__name:"StatusType",props:{type:{type:String,default:""}},setup(w){const l=w,{mobile:r}=Q(),s=W(),d=c({}),y=c(!1),v=c(""),f=c([]),e=re(),i=c(e.statusListByType);e.list.length<1&&e.getStatuses(s.token).then(()=>{e.filterStatusByType(l.type).then(()=>{i.value=e.statusListByType})}),D(()=>l.type,u=>{e.filterStatusByType(l.type).then(()=>{i.value=e.statusListByType})});const m=(u,p)=>{f.value=[u,p],y.value=!0,v.value=i.value[p][u]},T=()=>{f.value[0]=="color"?i.value[f.value[1]].color=v.value:i.value[f.value[1]].bgcolor=v.value,y.value=!1},I=()=>{i.value.push({title:null,type:null,status:"active",type:l.type,notification_interval:l.type=="urgency"?1:null})},j=u=>{i.value=i.value.filter(function(p,t){return t!==u})},x=c(!1),B=c([]),z=c([{title:"active",color:"success"},{title:"disabled",color:"error"}]),E=u=>{B.value.push(u.model_id);let p={id:u.model_id,type:l.type,status:u.state};e.updateStatus(p,s.token).then(t=>{e.getStatuses(s.token).then(()=>{e.filterStatusByType(l.type).then(()=>{i.value=e.statusListByType,B.value=[],d.value={status:!0,type:"success",text:"Status has been saved"}})})}).catch(t=>{B.value=[],d.value={status:!0,type:"error",text:"Error while updating status"}})},F=A(()=>{let u=!0;return i.value.map(p=>{(!p.title||p.title.length==0)&&(u=!1)}),u}),M=()=>{x.value=!0;let u={list:i.value};e.saveStatusList(u,s.token).then(()=>{e.getStatuses(s.token).then(()=>{e.filterStatusByType(l.type).then(()=>{i.value=e.statusListByType,x.value=!1,d.value={status:!0,type:"success",text:"Status list has been saved"}})})}).catch(p=>{x.value=!1,d.value={status:!0,type:"error",text:"Error while saving status list"}})};return(u,p)=>(n(),g("div",de,[a(ae,null,{default:o(()=>[a(Y,null,{default:o(()=>{var t,S;return[k("div",pe,[h(s).user.role=="superadmin"||(t=h(s).capabilities)!=null&&t.includes("add")?(n(),_(b,{key:0,icon:h(Z),onClick:I,size:"x-small",color:"white",class:"mr-3"},null,8,["icon"])):L("",!0),k("div",ve,$(l.type.replace("-"," "))+" List ",1),h(s).user.role=="superadmin"||(S=h(s).capabilities)!=null&&S.includes("edit")?(n(),_(b,{key:1,disabled:!F.value,loading:x.value,onClick:M,color:"primary",class:"ml-auto"},{default:o(()=>[C("Save")]),_:1},8,["disabled","loading"])):L("",!0)])]}),_:1}),a(ee),a(te,null,{default:o(()=>[(n(!0),g(O,null,P(i.value,(t,S)=>(n(),_(N,{key:S},{default:o(()=>[k("div",ye,[a(U,{"hide-details":"auto",modelValue:t.title,"onUpdate:modelValue":V=>t.title=V,label:`${l.type.charAt(0).toUpperCase()+l.type.slice(1)} Title`,variant:"outlined",density:"compact",disabled:t.id<10},null,8,["modelValue","onUpdate:modelValue","label","disabled"])]),k("div",_e,[a(U,{"hide-details":"auto",modelValue:t.color,"onUpdate:modelValue":V=>t.color=V,label:"Color",variant:"outlined",density:"compact",onClick:V=>m("color",S),clearable:""},null,8,["modelValue","onUpdate:modelValue","onClick"])]),l.type=="urgency"?(n(),g("div",fe,[a(U,{"hide-details":"auto",modelValue:t.notification_interval,"onUpdate:modelValue":V=>t.notification_interval=V,label:`${h(r)?"Notif. (days)":"Notification Interval (days)"} `,variant:"outlined",density:"compact",disabled:t.id<10},null,8,["modelValue","onUpdate:modelValue","label","disabled"])])):L("",!0),k("div",me,[t.id?(n(),_(ce,{key:0,onUpdate:E,list:z.value,"current-state":t,loading:B.value.includes(t.id)==!0},null,8,["list","current-state","loading"])):(n(),_(b,{key:1,block:"",color:"error",onClick:()=>j(S)},{default:o(()=>[C(" remove ")]),_:2},1032,["onClick"]))])]),_:2},1024))),128))]),_:1})]),_:1}),y.value?le((n(),g("div",he,[a(oe,{modelValue:v.value,"onUpdate:modelValue":p[0]||(p[0]=t=>v.value=t),elevation:"15","hide-inputs":"","show-swatches":""},null,8,["modelValue"])])),[[se,T]]):L("",!0),a(ie,{options:d.value},null,8,["options"])]))}},Ve={class:"v-col py-0"},we={__name:"Others",setup(w){const l=c(["asset","condition-type","incident-type","incident","maintenance","urgency"]),r=c("");return r.value="asset",(s,d)=>(n(),_(ue,null,{default:o(()=>[a(ne,{title:"Others - Status Setup"}),a(N,{class:"mt-5"},{default:o(()=>[k("div",Ve,[(n(!0),g(O,null,P(l.value,(y,v)=>(n(),_(b,{class:"mr-3 mb-3",key:v,color:`${r.value==y?"primary":"white"}`,onClick:f=>r.value=y},{default:o(()=>[C($(y.replace("-"," ")),1)]),_:2},1032,["color","onClick"]))),128))])]),_:1}),a(N,{class:"mb-3"},{default:o(()=>[a(Se,{type:r.value},null,8,["type"])]),_:1})]),_:1}))}};export{we as default};
